/*
 Copyright (c) 2004-2015 Kolor. All rights reserved.
*/
"undefined"===typeof KolorEyes&&(KolorEyes={});KolorEyes.version="1.6.3.400";KolorEyes.krpanoJS="krpano/krpano.js";KolorEyes.krpanoSWF="krpano/krpano.swf";KolorEyes.videoXML="krpano/video.xml";KolorEyesNamedObject=function(){var c=this;this.out=this.b=function(b,f){if(c.debug){var e;"object"===typeof b?e=b:e="[KolorEyes::"+c.n+"] "+b;console[f||"log"](e)}}};KolorEyesNamedObject.prototype.n="KolorEyes";KolorEyesNamedObject.prototype.debug=!1;
if("undefined"===typeof KolorEyes.env&&"undefined"===typeof KolorEyes.environment){var ma=KolorEyes,V={OS:null,browserMajor:null,browserName:null,browserVersion:null,context:null,isMobile:null,mobileType:null,webGL:null},wa=navigator.appName,jb=navigator.userAgent,kb;if(jb.match(/FB/i))V.browserName="facebook";else{var Vb=jb.match(/(edge)\/?\s*(\.?\d+(\.\d+)*)/i);Vb||(Vb=jb.match(/(opera|chrome|safari|firefox|msie|trident)\/?\s*(\.?\d+(\.\d+)*)/i),"trident"===Vb[1].toLowerCase()&&(Vb[1]="msie",Vb[2]=
jb.match(/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/i)[1]));Vb&&null!=(kb=jb.match(/version\/([\.\d]+)/i))&&(Vb[2]=kb[1]);Vb=Vb?[Vb[1],Vb[2]]:[wa,navigator.appVersion,"-?"];V.browserName=Vb[0].toLowerCase();V.browserVersion=Vb[1];V.browserMajor=parseInt(V.browserVersion)}-1!=navigator.appVersion.indexOf("Win")?V.OS="windows":-1!=navigator.appVersion.indexOf("Mac")?V.OS="macos":-1!=navigator.appVersion.indexOf("X11")?V.OS="unix":-1!=navigator.appVersion.indexOf("Linux")&&(V.OS="linux");V.webGL=!1;if(window.WebGLRenderingContext){var Wb=
document.createElement("canvas"),Xb=Wb.getContext("webgl")||Wb.getContext("experimental-webgl");V.webGL=null!==Xb}V.isMobile=!1;V.mobileType=null;jb.match(/Android/i)?V.mobileType="android":jb.match(/BlackBerry/i)?V.mobileType="blackberry":jb.match(/iPhone|iPad|iPod/i)?V.mobileType="ios":jb.match(/Opera Mini/i)?V.mobileType="opera":jb.match(/IEMobile/i)&&(V.mobileType="windows");V.isMobile=null!==V.mobileType;V.context="browser";ma.env=V;KolorEyes.env=KolorEyes.env;KolorEyes.environment=KolorEyes.env}
window.requestAnimFrame||(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){return window.setTimeout(c,1E3/60)});window.cancelAnimFrame||(window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout);
(function(){window.console||(window.console={});for(var c="log info warn error debug trace dir group groupCollapsed groupEnd time timeEnd profile profileEnd dirxml assert count markTimeline timeStamp clear".split(" "),b=0;b<c.length;b++)window.console[c[b]]||(window.console[c[b]]=function(){})})();Array.prototype.indexOf||(Array.prototype.indexOf=function(c,b){var f=this.length>>>0,e=Number(b)||0,e=0>e?Math.ceil(e):Math.floor(e);for(0>e&&(e+=f);e<f;e++)if(e in this&&this[e]===c)return e;return-1});KolorEyesBoxTextField=function(c,b,f,e){function d(){n.Xa.setSelectionRange(0,n.Xa.value.length)}var g=this,k=c,a=b,m=f,n=null;this.centerBox=this.Df=function(){null!==n&&(n.style.right=(k.p().clientWidth-n.clientWidth)/2+"px",n.style.top=(k.p().clientHeight-n.clientHeight)/2+"px")};this.setValue=this.Kg=function(b){a=b;null!=n&&"undefined"!=typeof n.Xa&&(n.Xa.value=a)};this.setTitle=this.Ga=function(a){m=a;null!=n&&"undefined"!=typeof n.Rc&&(n.Rc.innerHTML=m)};this.kill=this.f=function(){n.parentNode.removeChild(n);
k=g=n=null};n=document.createElement("div");n.className="boxTextField";n.style.width=(e||350)+"px";n.Rc=document.createElement("p");n.Rc.className="boxTitle";n.appendChild(n.Rc);n.Rd=document.createElement("a");n.Rd.className="boxClose";n.Rd.onclick=g.f;n.appendChild(n.Rd);n.Xa=document.createElement("input");n.Xa.type="text";n.Xa.readOnly=!0;n.Xa.onclick=d;n.appendChild(n.Xa);k.p().appendChild(n);g.Kg(a);d();g.Ga(m);g.Df()};(function(){function c(b){return 0>b?0:1<b?1:b}KolorEyesColor={Tj:function(b,f,c){b/=255;f/=255;c/=255;var d=Math.max(b,f,c),g=Math.min(b,f,c),k,a=(d+g)/2;if(d==g)k=g=0;else{var m=d-g,g=.5<a?m/(2-d-g):m/(d+g);switch(d){case b:k=(f-c)/m+(f<c?6:0);break;case f:k=(c-b)/m+2;break;case c:k=(b-f)/m+4}k/=6}return{qd:k,Fd:g,Mj:a}},Lj:function(b,f,c){if(0==f)c=f=b=c;else{var d=.5>c?c*(1+f):c+f-c*f,g=2*c-d;c=KolorEyesColor.te(g,d,b+1/3);f=KolorEyesColor.te(g,d,b);b=KolorEyesColor.te(g,d,b-1/3)}return{V:255*
c,$:255*f,X:255*b}},te:function(b,f,c){0>c&&(c+=1);1<c&&--c;return c<1/6?b+6*(f-b)*c:.5>c?f:c<2/3?b+(f-b)*(2/3-c)*6:b},Ge:function(b,f,c){b/=255;f/=255;c/=255;var d=Math.max(b,f,c),g=Math.min(b,f,c),k,a=d-g;if(d==g)k=0;else{switch(d){case b:k=(f-c)/a+(f<c?6:0);break;case f:k=(c-b)/a+2;break;case c:k=(b-f)/a+4}k/=6}return{qd:k,Fd:0==d?0:a/d,Ue:d}},mi:function(b,c,e){var d,g,k,a=Math.floor(6*b),m=6*b-a;b=e*(1-c);var n=e*(1-m*c);c=e*(1-(1-m)*c);switch(a%6){case 0:d=e;g=c;k=b;break;case 1:d=n;g=e;k=b;
break;case 2:d=b;g=e;k=c;break;case 3:d=b;g=n;k=e;break;case 4:d=c;g=b;k=e;break;case 5:d=e,g=b,k=n}return{V:255*d,$:255*g,X:255*k}},Gj:function(b){b=b.toString(16);return 1==b.length?"0"+b:b},Sj:function(b,c,e){return"#"+componentToHex(b)+componentToHex(c)+componentToHex(e)},ji:function(b){b=b.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(b,c,d,g){return c+c+d+d+g+g});return(b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b))?{V:parseInt(b[1],16),$:parseInt(b[2],16),X:parseInt(b[3],16)}:
null},Jj:function(b){var c=[],e=document.createElement("canvas"),d=e.getContext("2d"),g=b.width,k=b.height;e.width=g;e.height=k;d.drawImage(b,0,0,g,k);b=d.getImageData(0,0,g,k);for(e=0;e<b.data.length;e+=4)if(colorRGB={V:parseInt(b.data[e]),$:parseInt(b.data[e+1]),X:parseInt(b.data[e+2]),Fj:parseInt(b.data[e+3])},colorRGB.V!=colorRGB.$||colorRGB.V!=colorRGB.X){a:{d=colorRGB;for(g=0;g<c.length;g++)if(d.V==c[g].V&&d.$==c[g].$&&d.X==c[g].X){d=g;break a}d=-1}-1===d?(colorRGB.count=1,c.push(colorRGB)):
c[d].count++}return c=KolorEyesUtils.Oe("count",c).reverse()},Rj:function(b,f,e,d,g){var k,a,m,n=document.createElement("canvas"),q=n.getContext("2d"),w=b.width,p=b.height;n.width=w;n.height=p;q.drawImage(b,0,0,w,p);b=q.getImageData(0,0,w,p);f=KolorEyesColor.Ge(f.V,f.$,f.X);w=KolorEyesColor.Ge(e.V,e.$,e.X);for(p=0;p<b.data.length;p+=4){a=parseInt(b.data[p]);m=parseInt(b.data[p+1]);k=parseInt(b.data[p+2]);m=KolorEyesColor.Ge(a,m,k);k=m.qd-f.qd;a=m.Fd-f.Fd;m=m.Ue-f.Ue;if(.5<Math.abs(k)){var v;v=0===
k?0:0<k?1:0>k?-1:void 0;k-=v}Math.abs(k)<=d&&Math.abs(a)<=d&&Math.abs(m)<=d&&(k=(w.qd+k)%1,a=c(w.Fd+a),m=c(w.Ue+m),a=KolorEyesColor.mi(k,a,m),a.V=e.V*(1-g)+a.V*g,a.$=e.$*(1-g)+a.$*g,a.X=e.X*(1-g)+a.X*g,b.data[p]=a.V,b.data[p+1]=a.$,b.data[p+2]=a.X)}q.putImageData(b,0,0);return n.toDataURL("image/png")}}})();KolorEyesContextMenu=function(c){function b(a){if("INPUT"!==a.target.nodeName)return a.preventDefault&&a.preventDefault(),null!==g&&(g.style.display="block"),a=KolorEyesUtils.xa(a),g.style.left=a.x+"px",g.style.top=a.y+"px",!1}function f(a){2!=a.data.button&&null!==g&&(g.style.display="none")}var e=this,d=c,g=null,k=[{title:"About Kolor Eyes",href:"http://www.kolor.com/video",onclick:null}];this.F=function(){d.p().addEventListener("contextmenu",b);d.addEventListener(KolorEyesPlayer.a.Q,f);g=document.createElement("ul");
g.id="contextMenu";g.entries=[];d.p().appendChild(g);e.vg(k)};this.vg=function(a){e.Ah();if("undefined"==typeof a||null===a||0===a.length)e.f();else{for(var b,c,d,f=0,p=a.length;f<p;f++)c=a[f],"separator"===c.title?b=document.createElement("hr"):(b=document.createElement("li"),"undefined"!=typeof c.href&&null!=c.href?(d=document.createElement("a"),d.innerHTML=c.title,d.href=c.href,d.target="_blank",b.appendChild(d)):(b.innerHTML=c.title,"function"==typeof c.onclick&&(b.onclick=c.onclick))),g.entries.push(b);
a=0;for(b=g.entries.length;a<b;a++)g.appendChild(g.entries[a])}};this.Ah=function(){null!==g&&(g.entries=[],g.innerHTML="")};this.f=function(){d.p().removeEventListener("contextmenu",b);d.removeEventListener(KolorEyesPlayer.a.Q,f);d=e=null};e.F()};KolorEyesCore=function(c){function b(){B.b("loadedmetadata - set play and wait for progress event");A.addEventListener("loadeddata",f,!1);A.addEventListener("progress",f,!1);A.play();4==A.readyState&&f()}function f(){A.removeEventListener("progress",f,!1);A.removeEventListener("loadeddata",f,!1);null!==H&&!1!==H.sd()&&(B.b("Change video - onChangeVideoDataReceived"),A.pause(),B.b("progress - pause and wait for paused event"))}function e(){A.removeEventListener("pause",e,!1);var a=parseFloat(F.dataset.speed),
b=parseFloat(A.dataset.speed),c=(F.currentTime+.2)*a/b,a="["+a+"x -> "+b+"x]";B.b("Change video - pause,  set currentTime ("+c.toFixed(3)+") and wait for seeked event");B.b(a+" progress - source time : "+F.currentTime.toFixed(3)+" - dst time: "+c.toFixed(3));A.currentTime=c}function d(){B.b("Change video - seeked");A.removeEventListener("seeked",d,!1);T(A);A.ud.ed=!0;B.w()?A.play():r();D.nc(A,function(){B.Nd(F);F=A;X&&X(!0);A.dataset.hasOwnProperty("volume")&&0!=A.dataset.volume&&n(A,A.dataset.volume);
a()})}function g(){A.removeEventListener("loadstart",g,!1);null!==H&&!1!==H.sd()&&(B.b("Change video - load start"),ca=window.setTimeout(function(){S||null===H||!1===H.sd()||B.dd("Network does not respond. Abort change video operation.")},3E3))}function k(a){var b="unknown";switch(a.target.error.code){case a.target.error.oh:b="media aborted";break;case a.target.error.qh:b="network error";break;case a.target.error.ph:b="media decoding error";break;case a.target.error.rh:b="source not supported"}B.b("On change video - error: "+
b);B.dd(b)}function a(){window.clearTimeout(ca);ca=null;A.removeEventListener("error",k,!1);A.removeEventListener("loadstart",g,!1);A.removeEventListener("loadedmetadata",Y,!1);A.removeEventListener("loadeddata",f,!1);A.removeEventListener("progress",f,!1);A.removeEventListener("pause",e,!1);A.removeEventListener("seeked",d,!1);A=null;S=!1;X=null}function m(a,b){if(a.paused||a.currentTime>a.duration-1)b&&b();else{var c=a.volume/10,d=function(){a.volume=Math.max(0,a.volume-c);0<a.volume?window.setTimeout(d,
50):(a.volume=0,b&&b())};d()}}function n(a,b){function c(){a.volume=Math.min(b,a.volume+d);a.volume<b?window.setTimeout(c,50):a.volume=b}var d=(b-a.volume)/16;c()}function q(a){var b="unknown";switch(a.target.error.code){case a.target.error.oh:b="media aborted";break;case a.target.error.qh:b="network error";break;case a.target.error.ph:b="media decoding error";break;case a.target.error.rh:b="source not supported"}B.b("Video error: "+b);H.dispatchEvent(KolorEyesPlayer.a.sf,b);B.onError(a)}function w(a){a.preventDefault();
aa=!1;B.onEnded(a)}function p(a){a.preventDefault();r();u();B.onSeeked(a)}function v(a){a.preventDefault();B.onVolumeChange(a)}function x(a){a.preventDefault();B.onTimeUpdate(a)}function y(a){a.preventDefault();l();B.onPause(a)}function E(a){a.preventDefault();r();!0!==ga&&u();B.onPlay(a)}function L(a){a.preventDefault();B.onCanPlayThrough(a)}function M(a){a.preventDefault();F.ud.ed=!0;B.b("on Can Play");B.onCanPlay(a)}function J(a){a.preventDefault();B.b("on Duration Change");B.onDurationChange(a)}
function K(a){B.b("on Progress");B.onProgress(a)}function O(a){B.b("on Loaded Data");B.onLoadedData(a)}function N(a){B.b("on LoadedMeta Data");B.onLoadedMetaData(a)}function P(a){B.b("on Load Start");B.onLoadStart(a)}function t(){null!=da&&(window.cancelAnimFrame(da),ga=!1,da=null)}function u(){null===H||null===D?t():(ga=!0,D.yc(),B.onRender({Ij:0}),da=window.requestAnimFrame(u,G))}function r(){B.b("startTextureUpdate");null!=ba&&l();ba=window.setInterval(function(){D.Tg()},1E3/H.gg())}function l(){B.b("stopTextureUpdate");
window.clearInterval(ba);ba=null}function U(){function a(b,c){c=5;var d=Math.abs(b);d>c&&(d=c+.15*(d-c));return(0<b?-1:1)*d}function b(a){a=a||window.event;1!==(a.which||a.button)?c(a):(a.preventDefault(),G.addEventListener("mousemove",d,!1),H.addEventListener(KolorEyesPlayer.a.Q,c),H.addEventListener(KolorEyesPlayer.a.Zc,c),B.Hb(a.pageX-this.offsetLeft,a.pageY-this.offsetTop))}function c(a){B.b("Canvas mouse up");G.removeEventListener("mousemove",d,!1);G.addEventListener("mousedown",b,!1);H.removeEventListener(KolorEyesPlayer.a.Q,
c);H.removeEventListener(KolorEyesPlayer.a.Zc,c);B.Ib(a.pageX-this.offsetLeft,a.pageY-this.offsetTop)}function d(a){a.preventDefault();B.Gb(a.pageX-this.offsetLeft,a.pageY-this.offsetTop)}G.addEventListener("mousedown",b,!1);H.addEventListener(KolorEyesPlayer.a.cc,function(b){if(H.oa()!==KolorEyesPlayer.Z.Ka&&(null===H.pa()||!0!==H.pa().Da())){var c=0;b=b.data;b.deltaY?c=a(b.deltaY,5)/15:b.wheelDelta?(c=b.wheelDelta/120,window.opera&&(c=-c)):b.detail&&(c=a(b.detail,1.5)/5);D.j().ae(5*c)}})}function T(a){var b=
a||F;b.ud={ed:!1};b.addEventListener("loadstart",P,!1);b.addEventListener("loadedmetadata",N,!1);b.addEventListener("loadeddata",O,!1);b.addEventListener("progress",K,!1);b.addEventListener("durationchange",J,!1);b.addEventListener("canplay",M,!1);b.addEventListener("canplaythrough",L,!1);b.addEventListener("play",E,!1);b.addEventListener("pause",y,!1);b.addEventListener("timeupdate",x,!1);b.addEventListener("volumechange",v,!1);b.addEventListener("seeked",p,!1);b.addEventListener("ended",w,!1);b.addEventListener("error",
q,!1);b.style.display="none";a||b.load()}function Y(){A.removeEventListener("loadedmetadata",Y,!1);S=!0;null!==H&&!1!==H.sd()&&(B.b("Change video - loadedmetadata"),m(F,b))}var B=this,H=c,R=!1,D=null,G=H.ea(),F=H.u(),A=null,S=!1,ca=!1,X=null,da=null,ba=null,aa=!1,ga=!1;this.onLoadStart=this.Ci=function(){};this.onLoadedMetaData=this.Ad=function(){};this.onLoadedData=this.Di=function(){};this.onProgress=this.Gi=function(){};this.onDurationChange=this.Ai=function(){};this.onCanPlay=this.yi=function(){};
this.onCanPlayThrough=this.zi=function(){};this.onPlay=this.Fi=function(){};this.onPause=this.Ei=function(){};this.onTimeUpdate=this.Ji=function(){};this.onVolumeChange=this.Ki=function(){};this.onSeeked=this.Ii=function(){};this.onEnded=this.zd=function(){};this.onError=this.Bi=function(){};this.onRender=this.Hi=function(){};this.init=this.F=function(){D=new KolorEyesCoreRenderView(H);D.F();R=!0;U();T()};this.isInitialized=this.pi=function(){return R};this.resize=this.resize=function(){D.resize()};
this.unload=this.Nd=function(a){a=a||F;null!=a&&(a.src="",a.removeEventListener("loadstart",P,!1),a.removeEventListener("loadedmetadata",N,!1),a.removeEventListener("loadeddata",O,!1),a.removeEventListener("progress",K,!1),a.removeEventListener("durationchange",J,!1),a.removeEventListener("canplay",M,!1),a.removeEventListener("canplaythrough",L,!1),a.removeEventListener("play",E,!1),a.removeEventListener("pause",y,!1),a.removeEventListener("timeupdate",x,!1),a.removeEventListener("volumechange",v,
!1),a.removeEventListener("seeked",p,!1),a.removeEventListener("ended",w,!1),a.removeEventListener("error",q,!1),a.ud.ed=!1,a.parentNode&&a.parentNode.removeChild(a))};this.abortChangeVideo=this.dd=function(b){B.b("Abort change video ("+b+")");X(!1,b);a()};this.changeVideo=this.nc=function(b,c,f){if(null!=A)return!1;A=b;X=f;A.volume=0;H.sc().insertBefore(A,F.nextSibling);if(!D.Cf())return A.appendChild(c),T(A),A.ud.ed=!0,A.dataset.hasOwnProperty("volume")&&0!=A.dataset.volume&&(A.volume=A.dataset.volume),
B.Nd(),F=A,f&&window.setTimeout(function(){f(!0)},0),a(),!0;S=!1;A.addEventListener("error",k,!1);A.addEventListener("loadstart",g,!1);A.addEventListener("loadedmetadata",Y,!1);A.addEventListener("pause",e,!1);A.addEventListener("seeked",d,!1);A.appendChild(c);return!0};this.setVideoPlaybackRate=this.kb=function(a){F.playbackRate=a};this.setProjectionCenter=this.Zi=function(){};this.getProjectionCenter=this.Yf=function(){return D.Yf()};this.play=this.play=function(){F.play();aa=!0};this.pause=this.pause=
function(){F.pause();aa=!1};this.togglePause=this.Qg=function(){aa?this.pause():this.play()};this.setProjection=this.H=function(a){D.H(a)};this.setDisplayDevice=this.ta=function(a){D.ta(a)};this.getDisplayDevice=this.oa=function(){return D.oa()};this.getProjection=this.G=function(){return D.j().G()};this.getCanvas=this.ea=function(){return G};this.getVideo=this.u=function(){return F};this.getCamera=this.j=function(){return D.j()};this.moveCameraStart=this.Hb=function(a,b){D.j().Dc(new KolorEyesMath.g(a,
b,0))};this.moveCamera=this.Gb=function(a,b){D.j().de(new KolorEyesMath.g(a,b,0))};this.moveCameraStop=this.Ib=function(a,b){B.b("move camera stop");D.j().Fc(new KolorEyesMath.g(a,b,0))};this.stepCamera=this.Re=function(a,b){var c=a||KolorEyesCore.ca.Ya,d=b||1;c==KolorEyesCore.ca.cd?(B.Hb(0,0),B.Gb(0,400*d),B.Ib()):c==KolorEyesCore.ca.Wb?(B.Hb(0,0),B.Gb(0,-400*d),B.Ib()):c==KolorEyesCore.ca.Ya?(B.Hb(0,0),B.Gb(800*d,0),B.Ib()):c==KolorEyesCore.ca.kc&&(B.Hb(0,0),B.Gb(-800*d,0),B.Ib())};this.rotateCamera=
this.Ti=function(a,b){"undefined"!==typeof a&&"undefined"!==typeof b&&D.j().step(a,b)};this.zoomIn=this.gj=function(){D.j().ae()};this.zoomOut=this.hj=function(){D.j().ue()};this.isPlaying=this.w=function(){return aa};this.isRendering=this.ri=function(){return ga};this.getRenderView=this.Ta=function(){return D};this.getFPS=this.Ih=function(){return 0};this.b("WebGL Core instance created");this.f=function(){l();t();B.Nd();D.f();B=H=F=G=D=null}};KolorEyesCore.prototype=new KolorEyesNamedObject;
KolorEyesCore.prototype.n="Core";KolorEyesCore.prototype.debug=!1;KolorEyesCore.ca={Ya:0,kc:1,cd:2,Wb:3};KolorEyesCoreCamera=function(c){function b(){var a=new KolorEyesMath.g(v.x-p.x,v.y-p.y,0);x.x+=m*a.x;x.y+=m*a.y}function f(){if(1!=k.$f())J=-Math.PI/2,K=Math.PI/2;else{var a=KolorEyesMath.i(y)/2;J=a-Math.PI/2;K=Math.PI-a-Math.PI/2}}function e(a){t=a;a==KolorEyesCoreCamera.Za.Qd?(m=3,n=.8):a==KolorEyesCoreCamera.Za.yf&&(m=.4,n=.85)}var d=this,g=c,k=g.me().Ta(),a=KolorEyesMath.i(4),m=.8,n=.4,q=KolorEyesMath.Matrix4.s(),w=!1,p=new KolorEyesMath.g(0,0,0),v=new KolorEyesMath.g(0,0,0),x=new KolorEyesMath.g(0,
0,0),y=1,E=1,L=Infinity,M=!1,J=-Infinity,K=Infinity,O=0,N=0,P=!1,t="";e(KolorEyesCoreCamera.Za.Qd);this.step=this.step=function(a,b){if(a==KolorEyesCore.ca.Ya||a==KolorEyesCore.ca.kc){var c=a==KolorEyesCore.ca.Ya?-1:1;O+=c*KolorEyesMath.i(b);O=KolorEyesMath.O(O,-Math.PI,Math.PI)}else c=a==KolorEyesCore.ca.Wb?-1:1,N+=c*KolorEyesMath.i(b),N=KolorEyesMath.Oa(N,-Math.PI/2,Math.PI/2),N=Math.min(Math.max(N,J),K);_needsUpdate=!0};this.setMode=this.Yi=function(a){e(a)};this.startDrag=this.Dc=function(a){w=
!0;P=!1;p=KolorEyesMath.g.c(a);v=KolorEyesMath.g.c(a)};this.drag=this.de=function(a){w&&(v=KolorEyesMath.g.c(a),t==KolorEyesCoreCamera.Za.yf&&b())};this.stopDrag=this.Fc=function(){w=!1;P=!0};this.decreaseFov=this.ae=function(a){M||(0>a?this.ue(-a):(a=Math.max(y-a,E),g.A(a)))};this.increaseFov=this.ue=function(a){M||(a=Math.min(y+a,L),g.A(a))};this.update=this.update=function(){if(!0===g.ye()){var c=g.Nf().update(),m=c.Ra(),e=Math.asin(m[6]);O=KolorEyesMath.O(-Math.atan2(-m[2],m[10]),-Math.PI,Math.PI);
N=KolorEyesMath.Oa(e,J,K);N=KolorEyesMath.O(N,-Math.PI,Math.PI);f();g.G()===KolorEyesPlayer.d.na&&(N=0,c=KolorEyesMath.Matrix4.e(O,N,0));q=c}else c=k.re(),0>=c.width||0>=c.height||(P?(m=new KolorEyesMath.g(x.x,x.y),e=m.length(),d.b("[update] spring len: "+e),30<e?(x.x*=n,x.y*=n):(d.b("[update] stop inertia, spring len: "+m.length()),p=KolorEyesMath.g.c(v),x.x=x.y=0,P=!1)):t==KolorEyesCoreCamera.Za.Qd&&(b(),p=v),O+=x.x*a/c.width,O=KolorEyesMath.O(O,-Math.PI,Math.PI),f(),N=N+x.y*a/c.height,N=KolorEyesMath.Oa(N,
J,K),N=KolorEyesMath.O(N,-Math.PI,Math.PI),y=KolorEyesMath.Oa(y,E,L),q=KolorEyesMath.Matrix4.e(O,N,0))};this.getProjection=this.G=function(){return k.G()};this.setProjection=this.H=function(){};this.viewportChanged=this.ah=function(){if(k.G()==KolorEyesPlayer.d.T){var a=k.re();L=360*a.height/a.width;y=Math.min(L,y)}};this.He=function(a){a.hasOwnProperty("min")&&(E=a.min);a.hasOwnProperty("max")&&(L=a.max)};this.getFovMin=this.oc;this.lockZoom=this.Be=function(a){M=a};this.getFovMin=this.oc=function(){return E};
this.getFovMax=this.ld=function(){return L};this.getFov=this.r=function(){return y};this.setFov=this.A=function(a){M||(y=KolorEyesMath.Oa(a,E,L))};this.setSmoothness=this.Jg=function(a){m=KolorEyesMath.Oa(a,.2,10)};this.getYaw=this.C=function(){return O};this.getPitch=this.t=function(){return N};this.setPitch=this.jb=function(a){N=a};this.lookAt=this.ba=function(a,b){O=a;N=b;_needsUpdate=!0};this.setVelocity=this.Gd=function(b){a=KolorEyesMath.i(b)};this.getVelocity=this.pd=function(){return KolorEyesMath.S(a)};
this.getView=this.kg=function(){return q};this.f=function(){d=k=g=null};this.b("WebGL Core Camera instance created")};KolorEyesCoreCamera.prototype=new KolorEyesNamedObject;KolorEyesCoreCamera.prototype.n="CoreCamera";KolorEyesCoreCamera.prototype.debug=!1;KolorEyesCoreCamera.Za={};KolorEyesCoreCamera.Za.yf="camera.mode.touch";KolorEyesCoreCamera.Za.Qd="camera.mode.drag";KolorEyesCoreCamera.ca={};KolorEyesCoreCamera.ca.Aj="camera.direction.push";KolorEyesCoreCamera.ca.zj="camera.direction.pull";KolorEyesCoreEasing=function(){var c=null,b=null,f=!1;this.animate=this.ga=function(e,d,g,k,a,m){if("function"!==typeof e||"function"!==typeof d)throw new TypeError("Setter or Getter is not a valid callable function");if(0===k)d(g);else{var n=e(),q=1E3*k;b=Date.now();f=!1;var w=function(){var e=Date.now()-b,k=e>=q;f||k?(start=null,m&&m(f),f=!1):c=window.requestAnimFrame(w);e=e/q;switch(a){case KolorEyesCoreEasing.k.lc:e=1+Math.sin(Math.PI/2*(e-1));break;case KolorEyesCoreEasing.k.wb:e=.5*(1+Math.sin(Math.PI/
2*(2*e-1)));break;case KolorEyesCoreEasing.k.mc:e=Math.sin(Math.PI/2*e);break;case KolorEyesCoreEasing.k.gc:e=e*e;break;case KolorEyesCoreEasing.k.hc:e=.5>e?2*e*e:1-2*(e-1)*(e-1);break;case KolorEyesCoreEasing.k.ic:e=1-e;e=1-e*e;break;case KolorEyesCoreEasing.k.Tb:e=e*e*e;break;case KolorEyesCoreEasing.k.Ub:e=.5>e?4*e*e*e:1+4*(e-1)*(e-1)*(e-1);break;case KolorEyesCoreEasing.k.nb:e=1-e,e=1-e*e*e}e=KolorEyesMath.Oa(e,0,1);d(e*(g-n)+n)};c=window.requestAnimFrame(w)}};this.cancel=this.cancel=function(){f||
(this.b("cancel easing"),window.cancelAnimFrame(c),f=!0)}};KolorEyesCoreEasing.prototype=new KolorEyesNamedObject;KolorEyesCoreEasing.prototype.n="CoreEasing";KolorEyesCoreEasing.prototype.debug=!1;KolorEyesCoreEasing.k={};KolorEyesCoreEasing.curve=KolorEyesCoreEasing.k;KolorEyesCoreEasing.k.LINEAR=0;KolorEyesCoreEasing.curve.LINEAR=KolorEyesCoreEasing.k.LINEAR;KolorEyesCoreEasing.k.lc=1;KolorEyesCoreEasing.curve.SINE_IN=KolorEyesCoreEasing.k.lc;KolorEyesCoreEasing.k.wb=2;
KolorEyesCoreEasing.curve.SINE_IN_OUT=KolorEyesCoreEasing.k.wb;KolorEyesCoreEasing.k.mc=3;KolorEyesCoreEasing.curve.SINE_OUT=KolorEyesCoreEasing.k.mc;KolorEyesCoreEasing.k.gc=4;KolorEyesCoreEasing.curve.QUAD_IN=KolorEyesCoreEasing.k.gc;KolorEyesCoreEasing.k.hc=5;KolorEyesCoreEasing.curve.QUAD_IN_OUT=KolorEyesCoreEasing.k.hc;KolorEyesCoreEasing.k.ic=6;KolorEyesCoreEasing.curve.QUAD_OUT=KolorEyesCoreEasing.k.ic;KolorEyesCoreEasing.k.Tb=7;KolorEyesCoreEasing.curve.CUBIC_IN=KolorEyesCoreEasing.k.Tb;
KolorEyesCoreEasing.k.Ub=8;KolorEyesCoreEasing.curve.CUBIC_IN_OUT=KolorEyesCoreEasing.k.Ub;KolorEyesCoreEasing.k.nb=9;KolorEyesCoreEasing.curve.CUBIC_OUT=KolorEyesCoreEasing.k.nb;KolorEyesCoreProjection=function(c){function b(a){var b=[];g==KolorEyesCoreProjection.m.ob?d==KolorEyesCoreProjection.m.va?b=[f(KolorEyesCoreProjection.Ja,NaN,1,NaN,0,NaN),f(KolorEyesCoreProjection.Ja,NaN,NaN,NaN,NaN,180)]:d==KolorEyesCoreProjection.m.Na?b=[f(KolorEyesCoreProjection.Ja,0,NaN,NaN,0,90),f(KolorEyesCoreProjection.W,NaN,1,NaN,NaN,NaN),f(KolorEyesCoreProjection.Ja,NaN,NaN,NaN,NaN,180)]:d==KolorEyesCoreProjection.m.pb&&(b=[f(KolorEyesCoreProjection.Ja,0,NaN,0,0,90),f(KolorEyesCoreProjection.Ja,
NaN,1,NaN,NaN,NaN),f(KolorEyesCoreProjection.W,NaN,NaN,NaN,NaN,180)]):g==KolorEyesCoreProjection.m.va?d==KolorEyesCoreProjection.m.ob?b=[f(KolorEyesCoreProjection.Pd,NaN,NaN,NaN,.5*a.pitch,.5*(a.fov+90,KolorEyesCoreTween.nb)),f(KolorEyesCoreProjection.W,NaN,0,NaN,0,90,KolorEyesCoreTween.wb)]:d==KolorEyesCoreProjection.m.Na?b=[f(KolorEyesCoreProjection.W,0,NaN,NaN,0,90)]:d==KolorEyesCoreProjection.m.pb&&(b=[f(KolorEyesCoreProjection.Ia,NaN,NaN,NaN,NaN,90),f(KolorEyesCoreProjection.W,NaN,NaN,0,NaN,
NaN)]):g==KolorEyesCoreProjection.m.Na?d==KolorEyesCoreProjection.m.ob?b=[f(KolorEyesCoreProjection.Ia,0,NaN,NaN,NaN,NaN),f(KolorEyesCoreProjection.W,1,0,NaN,0,90),f(KolorEyesCoreProjection.W,NaN,NaN,NaN,90,230)]:d==KolorEyesCoreProjection.m.va?b=[f(KolorEyesCoreProjection.Ia,NaN,0,NaN,NaN,NaN),f(KolorEyesCoreProjection.W,1,NaN,NaN,90,230)]:d==KolorEyesCoreProjection.m.pb&&(b=[f(KolorEyesCoreProjection.Ia,NaN,0,NaN,NaN,NaN),f(KolorEyesCoreProjection.Pd,NaN,NaN,.95,NaN,.4*(a.fov+230)),f(KolorEyesCoreProjection.W,
1,NaN,0,90,230)]):g==KolorEyesCoreProjection.m.pb&&(d==KolorEyesCoreProjection.m.va?b=[f(KolorEyesCoreProjection.Ia,NaN,0,NaN,NaN,NaN),f(KolorEyesCoreProjection.W,NaN,NaN,1,NaN,NaN)]:d==KolorEyesCoreProjection.m.Na?b=[f(KolorEyesCoreProjection.Ia,NaN,0,NaN,NaN,NaN),f(KolorEyesCoreProjection.W,0,NaN,1,0,90)]:d==KolorEyesCoreProjection.m.ob&&(b=[f(KolorEyesCoreProjection.Ia,0,NaN,NaN,NaN,NaN),f(KolorEyesCoreProjection.Ja,NaN,NaN,NaN,NaN,170),f(KolorEyesCoreProjection.W,NaN,0,1,a.pitch,90)]));return b}
function f(a,b,c,d,f,e,g){var k={};isNaN(a)||(k.duration=a);isNaN(b)||(k.distance=b);isNaN(c)||(k.flat=c);isNaN(d)||(k.fisheye=d);isNaN(f)||(k.pitch=f);isNaN(e)||(k.fov=e);"undefined"!==typeof g&&(k.curve=g);return k}var e=c.j(),d=null,g=null,k=new KolorEyesCoreTweenSequencer(KolorEyesCoreProjection.ANIMATION_RATE);this.setProjection=this.H=function(a,f){d==a||k.mg()||function(){var n={};n.fov=e.r();n.pitch=KolorEyesMath.wf*e.t();n.flat=c.$f();n.fisheye=c.Jh();n.distance=c.Zf();var q={};q.pitch=n.pitch;
q.fov=n.fov;q.distance=n.distance;q.flat=n.flat;q.fisheye=n.fisheye;g=a;var n=b(n),w;for(w in n){var p=n[w];if(!(p.hasOwnProperty("distance")&&p.distance==q.distance&&p.hasOwnProperty("flat")&&p.flat==q.flat&&p.hasOwnProperty("fisheye")&&p.fisheye==q.fisheye&&p.hasOwnProperty("fov")&&p.fov==q.fov&&p.hasOwnProperty("pitch")&&p.pitch==q.pitch)){var v;(function(a,b,d,f,g,m){v=function(k){a.hasOwnProperty("distance")&&c.Gg((a.distance-b)*k+b);a.hasOwnProperty("flat")&&c.$i((a.flat-d)*k+d);a.hasOwnProperty("fisheye")&&
c.Wi((a.fisheye-f)*k+f);a.hasOwnProperty("fov")&&e.A((a.fov-g)*k+g);a.hasOwnProperty("pitch")&&e.ba(e.C(),KolorEyesMath.We*((a.pitch-m)*k+m))}})(p,q.distance,q.flat,q.fisheye,q.fov,q.pitch);p.hasOwnProperty("distance")&&!isNaN(p.distance)&&(q.distance=p.distance);p.hasOwnProperty("flat")&&!isNaN(p.flat)&&(q.flat=p.flat);p.hasOwnProperty("fisheye")&&!isNaN(p.fisheye)&&(q.fisheye=p.fisheye);p.hasOwnProperty("fov")&&!isNaN(p.fov)&&(q.fov=p.fov);p.hasOwnProperty("pitch")&&!isNaN(p.pitch)&&(q.pitch=p.pitch);
k.add(p.duration,v,null,p.hasOwnProperty("curve")?p.curve:KolorEyesCoreTween.LINEAR)}}e.Be(!1);e.He({min:30,max:300});k.start(function(){d=a;var b,c,g=!1;switch(d){case KolorEyesCoreProjection.m.ob:g=!0;b=c=e.r();break;case KolorEyesCoreProjection.m.pb:g=!0;b=c=e.r();break;case KolorEyesCoreProjection.m.va:b=60;c=110;break;case KolorEyesCoreProjection.m.Na:b=90,c=250}e.Be(g);e.He({min:b,max:c});f&&f()})}()};this.getProjection=this.G=function(){return d};this.getProjectionName=this.di=function(){return["EQUI",
"REAL","HERO","PLANET"][d]}};KolorEyesCoreProjection.c=60;KolorEyesCoreProjection.ANIMATION_RATE=KolorEyesCoreProjection.c;KolorEyesCoreProjection.Ia=0;KolorEyesCoreProjection.ANIM_IMMEDIATE=KolorEyesCoreProjection.Ia;KolorEyesCoreProjection.Pd=.2;KolorEyesCoreProjection.ANIM_SHORT=KolorEyesCoreProjection.Pd;KolorEyesCoreProjection.Ja=.35;KolorEyesCoreProjection.ANIM_MEDIUM=KolorEyesCoreProjection.Ja;KolorEyesCoreProjection.W=.7;KolorEyesCoreProjection.ANIM_LONG=KolorEyesCoreProjection.W;
KolorEyesCoreProjection.m={};KolorEyesCoreProjection.TYPE=KolorEyesCoreProjection.m;KolorEyesCoreProjection.m.ob=0;KolorEyesCoreProjection.TYPE.EQUI=KolorEyesCoreProjection.m.ob;KolorEyesCoreProjection.m.va=1;KolorEyesCoreProjection.TYPE.REAL=KolorEyesCoreProjection.m.va;KolorEyesCoreProjection.m.pb=2;KolorEyesCoreProjection.TYPE.HERO=KolorEyesCoreProjection.m.pb;KolorEyesCoreProjection.m.Na=3;KolorEyesCoreProjection.TYPE.PLANET=KolorEyesCoreProjection.m.Na;KolorEyesCoreProjection.prototype=new KolorEyesNamedObject;
KolorEyesCoreProjection.prototype.n="Core.Projection";KolorEyesCoreProjection.prototype.debug=!1;KolorEyesCoreTween=function(c,b){function f(){m=Date.now();q=window.setInterval(e,1E3/g)}function e(){var b=Date.now();n+=b-m;m=b;k(w(Math.min(1,n/d)));n>=d&&(window.clearInterval(q),m=q=null,a&&a(!0))}var d=1E3*c,g=b||60,k=null,a=null,m=null,n=null,q=null,w=function(a){switch(a||KolorEyesCoreTween.LINEAR){case KolorEyesCoreTween.LINEAR:return function(a){return a};case KolorEyesCoreTween.gc:return function(a){return a*a};case KolorEyesCoreTween.hc:return function(a){return.5>a?2*a*a:1-2*(a-1)*(a-
1)};case KolorEyesCoreTween.ic:return function(a){1-(1-a)*(1-a)};case KolorEyesCoreTween.Tb:return function(a){return a*a*a};case KolorEyesCoreTween.Ub:return function(a){return.5>a?4*a*a*a:1+4*(a-1)*(a-1)*(a-1)};case KolorEyesCoreTween.nb:return function(a){return 1-(1-a)*(1-a)*(1-a)};case KolorEyesCoreTween.lc:return function(a){return 1+Math.sin(Math.PI/2*(a-1))};case KolorEyesCoreTween.wb:return function(a){return.5*(1+Math.sin(Math.PI/2*(2*a-1)))};case KolorEyesCoreTween.mc:return function(a){return Math.sin(Math.PI/
2*a)}}}();this.start=this.start=function(b,c){0==d?(k=b(1),a=c(!0)):(k=b,a=c,f())};this.suspend=this.Ld=function(){q&&(window.clearInterval(q),q=null)};this.resume=this.Cd=function(){f()};this.cancel=this.cancel=function(b){window.clearInterval(q);window.setTimeout(function(){m=q=null;a&&a(!1);b&&b(!1)},0)}};KolorEyesCoreTween.prototype=new KolorEyesNamedObject;KolorEyesCoreTween.prototype.n="Core.Tween";KolorEyesCoreTween.prototype.debug=!1;KolorEyesCoreTween.LINEAR=0;KolorEyesCoreTween.LINEAR=KolorEyesCoreTween.LINEAR;
KolorEyesCoreTween.gc=1;KolorEyesCoreTween.QUAD_IN=KolorEyesCoreTween.gc;KolorEyesCoreTween.hc=2;KolorEyesCoreTween.QUAD_IN_OUT=KolorEyesCoreTween.hc;KolorEyesCoreTween.ic=3;KolorEyesCoreTween.QUAD_OUT=KolorEyesCoreTween.ic;KolorEyesCoreTween.Tb=4;KolorEyesCoreTween.CUBIC_IN=KolorEyesCoreTween.Tb;KolorEyesCoreTween.Ub=5;KolorEyesCoreTween.CUBIC_IN_OUT=KolorEyesCoreTween.Ub;KolorEyesCoreTween.nb=6;KolorEyesCoreTween.CUBIC_OUT=KolorEyesCoreTween.nb;KolorEyesCoreTween.lc=7;
KolorEyesCoreTween.SINE_IN=KolorEyesCoreTween.lc;KolorEyesCoreTween.wb=8;KolorEyesCoreTween.SINE_IN_OUT=KolorEyesCoreTween.wb;KolorEyesCoreTween.mc=9;KolorEyesCoreTween.SINE_OUT=KolorEyesCoreTween.mc;
KolorEyesCoreTweenSequencer=function(c){var b=c||60,f=[],e=null;this.isActive=this.mg=function(){return null!=e};this.add=this.add=function(c,e,k,a){var m={};m.tween=new KolorEyesCoreTween(c,b,a);m.progress=e;m.complete=k;f.push(m);return this};this.start=this.start=function(b){function c(){if(0==f.length)e&&(e(!0),e=null);else{var b=f[0];b.tween.start(b.progress,function(a){f.shift();b.complete&&b.complete();a&&c()})}}e=b;c()};this.clear=this.clear=function(){for(;0<f.length;)f.shift()};this.cancel=
this.cancel=function(b){0==f.length?b&&b():f[0].Sg.cancel(function(){b&&b()})};this.suspend=this.Ld=function(){0!=f.length&&f[0].Sg.Ld()};this.resume=this.Cd=function(){0!=f.length&&f[0].Sg.Cd()}};KolorEyesCoreTweenSequencer.prototype=new KolorEyesNamedObject;KolorEyesCoreTweenSequencer.prototype.n="Core.Animator";KolorEyesCoreTweenSequencer.prototype.debug=!1;KolorEyesCoreStats=function(c){var b=0,f=Infinity,e=0,d=0;this.update=function(c){f=Math.min(f,c);e=Math.max(e,c);d=(d*b+c)/++b};this.toString=function(){return c+" - count: "+b+", average: "+d.toFixed(0)+"ms [min: "+f.toFixed(0)+"ms , max: "+e.toFixed(0)+"ms]"}};KolorEyesCoreStats.prototype=new KolorEyesNamedObject;KolorEyesCoreStats.prototype.n="Core.Stats";KolorEyesCoreStats.prototype.debug=!1;
KolorEyesCoreRenderView=function(c){function b(){null!=m&&a.deleteProgram(m);m=a.createProgram();f("Create shader program");var b=a.createShader(a.VERTEX_SHADER);a.shaderSource(b,"precision highp float;attribute vec3 aVertexPosition;void main(){gl_Position=vec4(aVertexPosition,1);}");a.compileShader(b);if(!a.getShaderParameter(b,a.COMPILE_STATUS))return g.b("Shader compiler log: "+a.getShaderInfoLog(c)),!1;a.attachShader(m,b);f("Attach vertex shader");var c=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(c,
e);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS))return g.b("Shader compiler log: "+a.getShaderInfoLog(c)),!1;a.attachShader(m,c);f("Attach fragment shader");a.linkProgram(m);f("Link program");a.getProgramParameter(m,a.LINK_STATUS)||f("Get program link status",!1);a.useProgram(m);f("Use Program");m.Zg=a.getAttribLocation(m,"aVertexPosition");f("Get attrib location",!1);a.enableVertexAttribArray(m.Zg);f("Enable vertex attrib array",!1);u.bind(a,m);r.bind(a,m);l.bind(a,m);t.bind(a,
m);P.bind(a,m);N.bind(a,m);K.bind(a,m);O.bind(a,m);U.bind(a,m);T.bind(a,m);Y.bind(a,m);B.bind(a,m);H.bind(a,m);R.bind(a,m);D.bind(a,m);G.bind(a,m);F.bind(a,m);A.bind(a,m);S.bind(a,m);return!0}function f(b,c){var d=a.getError(),f="";switch(d){case 1280:f="INVALID_ENUM";break;case 1281:f="INVALID_VALUE";break;case 1282:f="INVALID_OPERATION";break;case 1285:f="OUT_OF_MEMORY";break;case 1286:f="INVALID_FRAMEBUFFER_OPERATION";break;case 0:f="OK"}"undefined"===typeof c&&(c=!1);!d&&c||g.b("GL Check - "+
b+": "+f)}var e="",d=null,g=this,k=c,a=null,m=null,n=null,q=null,w=!0,p=null,v=null,x=null,y=null,E=0,L=0;new KolorEyesCoreStats("Texture GL");new KolorEyesCoreStats("Camera");new KolorEyesCoreStats("Draw GL");var M=KolorEyesPlayer.displayDevice.SCREEN,J=KolorEyesPlayer.d.I,K=new KolorEyesCoreShaderParamFloat("uFisheyeAmount"),O=new KolorEyesCoreShaderParamFloat("uFisheyeFov"),N=new KolorEyesCoreShaderParamFloat("uProjectionInterpolation"),P=new KolorEyesCoreShaderParamFloat("uProjectionDistance"),
t=new KolorEyesCoreShaderParamFloat("uProjScale"),u=new KolorEyesCoreShaderParamSampler2D("uSampler"),r=new KolorEyesCoreShaderParamSampler2D("uSamplerBlend"),l=new KolorEyesCoreShaderParamFloat("uBlendAmount"),U=new KolorEyesCoreShaderParamVec2("uViewportSize"),T=new KolorEyesCoreShaderParamVec2("uViewportSizeMin"),Y=new KolorEyesCoreShaderParamVec2("uViewportSizeRatio"),B=new KolorEyesCoreShaderParamFloat("uCameraYaw"),H=new KolorEyesCoreShaderParamFloat("uCameraPitch"),R=new KolorEyesCoreShaderParamFloat("uFov"),
D=new KolorEyesCoreShaderParamMat4("uMatView"),G=new KolorEyesCoreShaderParamFloat("uScreenWidth"),F=new KolorEyesCoreShaderParamFloat("uScreenOffsetX"),A=new KolorEyesCoreShaderParamVec2("uLensCenter"),S=new KolorEyesCoreShaderParamVec2("uScreenCenter"),ca=KolorEyesMath.Matrix4.c([1.56573,0,0,0,0,1.95716,0,0,0,0,0,-99.9995,-.187772,0,-1,100]),X=KolorEyesMath.Matrix4.c([1.56573,0,0,0,0,1.95716,0,0,0,0,0,-99.9995,.187772,0,-1,100]);this.Gg=function(a){P.set(a)};this.Zf=function(){return P.value};this.$i=
function(a){N.set(a)};this.$f=function(){return N.value};this.Wi=function(a){K.set(a)};this.Jh=function(){return K.value};this.A=function(a){d.He({min:80,max:300});d.A(a);distance=60>a?0:180<a?1:.5*(1+Math.sin(Math.PI/2*((a-60)/120*2-1)));g.Gg(distance);a=Math.PI*a/360;var b=g.Zf();t.set((b+1)*Math.sin(a)/(b-Math.cos(Math.PI-a)))};this.getCamera=this.j=function(){return d};this.getVisible=this.Aa=function(){return!0};this.getContainer=this.p=function(){return k.ie()};this.init=this.F=function(){d=
new KolorEyesCoreCamera(k);var b=k.ea();if(window.WebGLRenderingContext){var c={premultipliedAlpha:!1,alpha:!1,preserveDrawingBuffer:!0};"msie"===KolorEyes.env.browserName&&12>KolorEyes.env.browserMajor&&(c={alpha:!1,preserveDrawingBuffer:!0});a=b.getContext("webgl",c)||b.getContext("experimental-webgl",c)}else a=null;if(!a)return!1;a.viewport(0,0,k.ea().clientWidth,k.ea().clientHeight);g.ta(KolorEyesPlayer.displayDevice.SCREEN);u.set(0);r.set(1);l.set(0);t.set(1);P.set(0);N.set(0);K.set(0);O.set(149.2);
a.clearColor(0,0,0,1);a.disable(a.DEPTH_TEST);a.disable(a.CULL_FACE);a.disable(a.BLEND);a.disable(a.DITHER);a.disable(a.STENCIL_TEST);a.disable(a.SCISSOR_TEST);a.disable(a.POLYGON_OFFSET_FILL);a.disable(a.SAMPLE_ALPHA_TO_COVERAGE);a.disable(a.SAMPLE_COVERAGE);g.A(90);w=!1};this.changeVideo=this.nc=function(b,c){g.b("Change video to "+b.currentSrc);v=a.createTexture();v.Eb=new Image;v.Eb.crossOrigin="anonymous";a.activeTexture(a.TEXTURE1);a.bindTexture(a.TEXTURE_2D,v);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);var d=0;x=function(){d+=.08;1<=d?(x=null,p=v,v=null,l.set(0),c&&c()):(g.b("Blending: "+d.toFixed(2)),a.activeTexture(a.TEXTURE1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b),l.set(d))}};this.resize=this.resize=function(){var b=a.canvas.clientWidth,c=a.canvas.clientHeight;
a.viewport(0,0,b,c);U.set([b,c]);T.set([c,c]);Y.set([b/c,1]);d.ah()};this.getViewportSize=this.re=function(){return{width:a.canvas.clientWidth,height:a.canvas.clientHeight}};this.canDisplayTexture=this.Cf=function(){return null!==p};this.updateTexture=this.Tg=function(){var b=null,b=k.u();b.readyState===b.HAVE_ENOUGH_DATA&&("msie"===KolorEyes.env.browserName&&12>KolorEyes.env.browserMajor&&null===y&&(y=document.createElement("canvas"),y.setAttribute("width",b.videoWidth),y.setAttribute("height",b.videoHeight)),
null!==y&&(y.getContext("2d").drawImage(b,0,0,b.videoWidth,b.videoHeight),b=y),null===p&&(p=a.createTexture(),p.Eb=new Image,p.Eb.crossOrigin="anonymous",a.bindTexture(a.TEXTURE_2D,p),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)),p.Eb.width=b.width,p.Eb.height=b.height,b&&p.Eb?(a.activeTexture(a.TEXTURE0),
a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b),x&&x()):g.b("Render failure: no texture"))};this.render=this.yc=function(){if(E!=a.canvas.clientWidth||L!=a.canvas.clientHeight)E=a.canvas.clientWidth,L=a.canvas.clientHeight,this.resize();d.update(a.canvas.clientWidth,a.canvas.clientHeight);var b=d.kg();a.clear(a.COLOR_BUFFER_BIT);B.set(d.C());H.set(d.t());R.set(d.r());u.o();r.o();l.o();P.o();t.o();N.o();K.o();O.o();U.o();T.o();Y.o();B.o();H.o();R.o();G.o();M==KolorEyesPlayer.displayDevice.HMD?
(D.set(b.Ee(ca).Ra()),D.o(),F.set(0),F.o(),A.set([.287994,.5]),A.o(),S.set([.25,.5]),S.o(),a.drawElements(a.TRIANGLES,n.yd,a.UNSIGNED_SHORT,0),D.set(b.Ee(X).Ra()),D.o(),F.set(.5*a.canvas.clientWidth),F.o(),A.set([.712006,.5]),A.o(),S.set([.75,.5]),S.o(),a.drawElements(a.TRIANGLES,n.yd,a.UNSIGNED_SHORT,2*n.yd)):(D.set(b.Ra()),D.o(),F.o(),a.drawElements(a.TRIANGLES,n.yd,a.UNSIGNED_SHORT,0))};this.getProjection=this.G=function(){return J};this.setProjection=this.H=function(a,b,c){w||(b=1,"undefined"!==
typeof c&&(b=c),M==KolorEyesPlayer.displayDevice.HMD&&a!=KolorEyesCoreProjection.m.va)||(a==KolorEyesCoreProjection.m.va?(k.A(90,b),c=new KolorEyesCoreEasing,c.ga(d.t,d.jb,0,1,KolorEyesCoreEasing.k.LINEAR,null)):a==KolorEyesCoreProjection.m.Na&&(k.A(250,b),c=new KolorEyesCoreEasing,c.ga(d.t,d.jb,Math.PI/2,1,KolorEyesCoreEasing.k.LINEAR,null)),J=a)};this.getDisplayDevice=this.oa=function(){return M};this.setDisplayDevice=this.ta=function(c){if(M!=c||w){M=c;e="precision highp float;\n#define pi 3.141592654\n#define twopi 6.283185308\n#define halfpi 1.570796327\n#define degToRad 0.017453293\n#define radToDeg 57.29577951\n#define sqrt2 1.41421356\n#define q(a) vec2(-1.)\n#define spherePt(a) (vec3(a.x,a.y,-sqrt(1.-dot(a,a)))) \n\n#define oculusK0 1.0\n#define oculusK1 0.07\n#define oculusK2 0.0\n#define oculusScaleFactor vec2(0.194408, 0.311053)\n\n#define oculusScaleFactorIn vec2(4.0, 2.5)\n\n#define oculusScaleCorrector 2.0\n\nuniform sampler2D uSampler, uSamplerBlend;\nuniform mat4 uMatView;\nuniform float uFisheyeFov,uFisheyeAmount,uFov,uCameraYaw,uCameraPitch,uProjScale,uProjectionInterpolation,uProjectionDistance,uBlendAmount,uScreenWidth,uScreenOffsetX;\nuniform int uProjectionType;\nuniform vec2 uViewportSize,uViewportSizeMin,uViewportSizeRatio;\nuniform vec2 uLensCenter,uScreenCenter;\n\nvec3 toCartesian(in vec3 rtp) {  float radius = rtp.x;  return vec3(radius * sin(rtp.y) * sin(rtp.z), radius * cos(rtp.y) * sin(rtp.z), radius * cos(rtp.z));}\n\nvec3 toSpherical(in vec3 pt) {  float t,p,r = length(pt);  t = -atan(pt.x, pt.z); t += twopi * (1.0 - step(0.0, t));  p = acos(pt.y / r); return vec3(r,t,p);}\n\nvec2 mixSphericalCoords(in vec2 a, in vec2 b, in float amount) {   if (b.x < a.x - pi) {    b.x =  b.x + twopi ;  } else if (b.x > a.x + pi) {    b.x =  b.x - twopi ;  } else {    b.x = b.x;  }  return mix(a, b, amount);}\n\n\nvec2 toTexCoords(in vec2 thetaphi) {   thetaphi.x = thetaphi.x + twopi * ((1.0 - step(0.0, thetaphi.x)) - step(twopi, thetaphi.x));  return thetaphi / vec2(twopi, pi);}\n\n\n\n"+
("vec2 proj(in float a, in vec2 fragCoord) {"+(M==KolorEyesPlayer.displayDevice.HMD?"  vec2 screenPt = ((2.0 * fragCoord / uViewportSizeMin) - uViewportSizeRatio);  screenPt *= tan(a/2.0);  screenPt.x /= oculusScaleCorrector;":"  vec2 screenPt = ((2.0 * fragCoord / uViewportSizeMin) - uViewportSizeRatio);")+"  vec2 c = uProjScale * screenPt;  float zs = uProjectionDistance;  float xy2 = dot(c,c);  float zs12 = (zs+1.0)*(zs+1.0);  float delta = 4.0*(zs*zs*xy2*xy2 - (xy2+zs12)*(xy2*zs*zs-zs12));  if (delta < 0.0) {return q();}  float z = (2.0*zs*xy2 - sqrt(delta)) / (2.0 * (zs12 + xy2));  float x = c.x * ((zs-z) / (zs+1.0));  float y = c.y * ((zs-z) / (zs+1.0));  vec3 ptAzimutal = vec3(uMatView * vec4(x, y, z, 1.0));  vec3 ptAzimutalSphere = toSpherical(ptAzimutal);  float rmax = 1.0;  float rn = length(screenPt) / rmax;  float thetaFish = rn * degToRad * uFov / 2.0;  float zFisheye = -rn / tan(thetaFish);  vec3 ptFisheye = vec3(uMatView * vec4(screenPt.x, screenPt.y, zFisheye, 1.0));  vec3 ptFisheyeSphere = toSpherical(ptFisheye);  float dy = max(0.0, (a - pi) / 2.0);  vec2 angpos = vec2(pi + uCameraYaw, halfpi - uCameraPitch - dy);  vec2 ptEqui = (angpos + (a/2.0) * screenPt);  ptEqui.x = mod(ptEqui.x, twopi);  ptEqui.y = pi - ptEqui.y;  vec2 mixedPt = mixSphericalCoords(ptAzimutalSphere.yz, ptFisheyeSphere.yz, uFisheyeAmount);  mixedPt = mixSphericalCoords(mixedPt, ptEqui, uProjectionInterpolation);  return toTexCoords(mixedPt);} \n")+
"\n\n"+(M==KolorEyesPlayer.displayDevice.HMD?"vec2 hmdWarp(vec2 in01) {   vec2 theta = (in01 - uLensCenter) * oculusScaleFactorIn;   float rSq = theta.x * theta.x + theta.y * theta.y;  vec2 rvector = theta * (oculusK0 + oculusK1 * rSq + oculusK2 * rSq * rSq);  return uLensCenter + oculusScaleFactor * rvector; }\nvec2 getDistoCoord() {   return hmdWarp(gl_FragCoord.xy / uViewportSize);}\n":"")+"\n\nvoid main(){\n"+(M==KolorEyesPlayer.displayDevice.HMD?"  vec2 uv;  vec2 fragCoord = getDistoCoord();     fragCoord.x = fragCoord.x * (uViewportSize.x * 2.0) - (step(uViewportSize.x, gl_FragCoord.x) * uViewportSize.x) - 2.0 * uScreenOffsetX ;     fragCoord.y = fragCoord.y * uViewportSize.y;  \t  uv = proj(degToRad * uFov, fragCoord);":
"  vec2 uv = proj(degToRad * uFov, gl_FragCoord.xy);")+"\n  if (uv.x < 0.0) {    gl_FragColor = vec4(0.0, 0.0, -uv.x, 1.0);    return;  }  vec3 color = texture2D(uSampler, uv).rgb;  if (uBlendAmount > 0.0) {\t\tcolor = mix(color, texture2D(uSamplerBlend, uv).rgb, uBlendAmount);  }  color *= (step(0.0, uv.x) * step(0.0, 1.0 - uv.x));  color *= (step(0.0, uv.y) * step(0.0, 1.0 - uv.y));  gl_FragColor = vec4(color, 1.0);}\n\n";if(!b())throw"Error while initializing GL shaders";M==KolorEyesPlayer.displayDevice.HMD?
G.set(.5):(G.set(1),F.set(0));n&&a.deleteBuffer(n);n=a.createBuffer();f("Create position buffer");a.bindBuffer(a.ARRAY_BUFFER,n);f("Bind position buffer");a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,-1,-1,1,-1,0,1,-1,1,1,-1,1,-1,-1,0,-1,-1]),a.STATIC_DRAW);f("Position buffer data");n.si=3;n.yd=6;q&&a.deleteBuffer(q);q=a.createBuffer();f("Create index buffer");a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,q);f("Bind index buffer");a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(M==KolorEyesPlayer.Z.Ka?
[0,1,2,0,2,5,5,2,3,5,3,4]:[0,1,3,0,3,4]),a.STATIC_DRAW);f("Index buffer data");a.vertexAttribPointer(m.Zg,n.si,a.FLOAT,!1,0,0);if(null==n||null==q)throw"Error while initializing GL buffers";this.resize();M==KolorEyesPlayer.displayDevice.HMD&&k.H(KolorEyesPlayer.d.I);k.dispatchEvent(KolorEyesPlayer.a.Tc,M)}};this.f=function(){a.deleteBuffer(n);a.deleteBuffer(q);a=null;P.f();u.f();r.f();l.f();U.f();T.f();Y.f();B.f();H.f();R.f();D.f();G.f();F.f();A.f();S.f();S=A=F=G=D=R=H=B=Y=T=U=l=r=u=P=null;d.f();
g=k=d=null}};KolorEyesCoreRenderView.prototype=new KolorEyesNamedObject;KolorEyesCoreRenderView.prototype.n="CoreRenderView";KolorEyesCoreRenderView.prototype.debug=!1;KolorEyesCoreRenderView.prototype["glsl-compilation"]="be80d6d6c13bff7fe86f8c6f1f277875";KolorEyesCoreRenderView.prototype["glsl-validation"]="bd8d97642459b9f7cd5f4e9744e8f012";KolorEyesCoreShaderParam=function(c){var b=this;this.name=c;this.v=!1;this.value=this.location=null;this.bind=function(f,e){b.Va=f;b.location=f.getUniformLocation(e,c);b.v=!0};this.dump=function(){var c="DUMP "+b.name+" : "+b.value,c=null!==b.location?c+" bound to program":c+" unbound";b.b(c)};this.set=function(){};this.o=function(){};this.f=function(){b=null}};KolorEyesCoreShaderParam.prototype=new KolorEyesNamedObject;KolorEyesCoreShaderParam.prototype.n="Core.ShaderParam";
KolorEyesCoreShaderParam.prototype.debug=!1;KolorEyesCoreShaderParamInt=function(c){KolorEyesCoreShaderParam.apply(this,arguments);var b=this;this.set=function(c){c!==b.value&&(b.value=c,b.v=!0,b.b("set "+b.name+" : "+b.value))};this.o=function(){b.v&&null!=b.location&&(b.v=!1,b.b("commit "+b.name+" : "+b.value),b.Va.uniform1i(b.location,b.value))}};KolorEyesCoreShaderParamInt.prototype=new KolorEyesCoreShaderParam;KolorEyesCoreShaderParamInt.prototype.n="Core.ShaderParam.int";
KolorEyesCoreShaderParamInt.prototype.debug=!1;KolorEyesCoreShaderParamFloat=function(c){KolorEyesCoreShaderParam.apply(this,arguments);var b=this;this.set=function(c){c!==b.value&&(b.value=c,b.v=!0,b.b("set "+b.name+" : "+b.value))};this.o=function(){b.v&&null!=b.location&&(b.v=!1,b.b("commit "+b.name+" : "+b.value),b.Va.uniform1f(b.location,b.value))}};KolorEyesCoreShaderParamFloat.prototype=new KolorEyesCoreShaderParam;KolorEyesCoreShaderParamFloat.prototype.n="Core.ShaderParam.float";
KolorEyesCoreShaderParamFloat.prototype.debug=!1;KolorEyesCoreShaderParamSampler2D=function(c){KolorEyesCoreShaderParam.apply(this,arguments);var b=this;this.set=function(c){c!==b.value&&(b.value=c,b.v=!0,b.b("set "+b.name+" : "+b.value))};this.o=function(){b.v&&null!=b.location&&(b.v=!1,b.b("commit "+b.name+" : "+b.value),b.Va.uniform1i(b.location,b.value))}};KolorEyesCoreShaderParamSampler2D.prototype=new KolorEyesCoreShaderParam;KolorEyesCoreShaderParamSampler2D.prototype.n="Core.ShaderParam.sampler2D";
KolorEyesCoreShaderParamSampler2D.prototype.debug=!1;KolorEyesCoreShaderParamVec2=function(c){KolorEyesCoreShaderParam.apply(this,arguments);var b=this;this.value=[null,null];this.set=function(c){for(var e=!0,d=0;2>d;d++)if(c[d]!==this.value[d]){e=!1;break}e||(b.value=c,b.v=!0,b.b("set "+b.name+" : "+b.value))};this.o=function(){b.v&&null!=b.location&&(b.v=!1,b.b("commit "+b.name+" : "+b.value),b.Va.uniform2fv(b.location,b.value))}};KolorEyesCoreShaderParamVec2.prototype=new KolorEyesCoreShaderParam;
KolorEyesCoreShaderParamVec2.prototype.n="Core.ShaderParam.vec2";KolorEyesCoreShaderParamVec2.prototype.debug=!1;KolorEyesCoreShaderParamVec3=function(c){KolorEyesCoreShaderParam.apply(this,arguments);var b=this;this.value=[null,null,null];this.set=function(c){for(var e=!0,d=0;3>d;d++)if(c[d]!==this.value[d]){e=!1;break}e||(b.value=c,b.v=!0,b.b("set "+b.name+" : "+b.value))};this.o=function(){b.v&&null!=b.location&&(b.v=!1,b.b("commit "+b.name+" : "+b.value),b.Va.uniform3fv(b.location,b.value))}};
KolorEyesCoreShaderParamVec3.prototype=new KolorEyesCoreShaderParam;KolorEyesCoreShaderParamVec3.prototype.n="Core.ShaderParam.vec3";KolorEyesCoreShaderParamVec3.prototype.debug=!1;
KolorEyesCoreShaderParamVec4=function(c){KolorEyesCoreShaderParam.apply(this,arguments);var b=this;this.value=[null,null,null,null];this.set=function(c){for(var e=!0,d=0;4>d;d++)if(c[d]!==this.value[d]){e=!1;break}e||(b.value=c,b.v=!0,b.b("set "+b.name+" : "+b.value))};this.o=function(){b.v&&null!=b.location&&(b.v=!1,b.b("commit "+b.name+" : "+b.value),b.Va.uniform4fv(b.location,b.value))}};KolorEyesCoreShaderParamVec4.prototype=new KolorEyesCoreShaderParam;
KolorEyesCoreShaderParamVec4.prototype.n="Core.ShaderParam.vec4";KolorEyesCoreShaderParamVec4.prototype.debug=!1;
KolorEyesCoreShaderParamMat3=function(c){KolorEyesCoreShaderParam.apply(this,arguments);var b=this;this.value=[null,null,null,null,null,null,null,null,null];this.set=function(c){for(var e=!0,d=0;9>d;d++)if(c[d]!==this.value[d]){e=!1;break}e||(b.value=c,b.v=!0,b.b("set "+b.name+" : "+b.value))};this.o=function(){b.v&&null!=b.location&&(b.v=!1,b.b("commit "+b.name+" : "+b.value),b.Va.uniformMatrix3fv(b.location,!1,b.value))}};KolorEyesCoreShaderParamMat3.prototype=new KolorEyesCoreShaderParam;
KolorEyesCoreShaderParamMat3.prototype.n="Core.ShaderParam.mat3";KolorEyesCoreShaderParamMat3.prototype.debug=!1;
KolorEyesCoreShaderParamMat4=function(c){KolorEyesCoreShaderParam.apply(this,arguments);var b=this;this.value=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];this.set=function(c){for(var e=!0,d=0;16>d;d++)if(c[d]!==this.value[d]){e=!1;break}e||(b.value=c,b.v=!0,b.b("set "+b.name+" : "+b.value))};this.o=function(){b.v&&null!=b.location&&(b.v=!1,b.b("commit "+b.name+" : "+b.value),b.Va.uniformMatrix4fv(b.location,!1,b.value))}};
KolorEyesCoreShaderParamMat4.prototype=new KolorEyesCoreShaderParam;KolorEyesCoreShaderParamMat4.prototype.n="Core.ShaderParam.mat4";KolorEyesCoreShaderParamMat4.prototype.debug=!1;KolorEyesCoreSourceView=function(c){function b(a){e(a)}function f(){k.onmousemove=null}function e(a){a=KolorEyesUtils.xa(a);g.ba(360*a.x/k.clientWidth-180,180*a.y/k.clientHeight-90);k.onmousemove=b;g.addEventListener(KolorEyesPlayer.a.Q,f)}function d(a,b,c){a.beginPath();a.arc(b,c,16,0,2*Math.PI,!1);a.moveTo(b-8,c);a.lineTo(b+8,c);a.moveTo(b,c-8);a.lineTo(b,c+8);a.stroke()}var g=c,k,a=!1;this.init=this.F=function(){k=g.u();k.onmousedown=e};this.render=this.yc=function(){var a=g.G(),b=g.t(),c=(g.C()+
180)*g.u().clientWidth/360,b=(b+90)*g.u().clientHeight/180,e=g.qa().getContext("2d");e.strokeStyle="#ffffff";e.fillStyle="rgba(255, 255, 255, 0.3)";e.clearRect(0,0,g.qa().clientWidth,g.qa().clientHeight);if(a===KolorEyesPlayer.d.T||a===KolorEyesPlayer.d.I){var f=g.ea().clientWidth/g.ea().clientHeight,k=g.r(),x=0;a===KolorEyesPlayer.d.T?x=k*f:a===KolorEyesPlayer.d.I&&(x=KolorEyesMath.S(2*Math.atan(Math.tan(KolorEyesMath.i(k)/2)*f)));var a=x*g.u().clientWidth/360,k=k*g.u().clientHeight/180,f=c-a/2,
y=b-k/2;360>x&&e.strokeRect(f,y,a,k);var E=0;c>g.qa().clientWidth-a/2?E=-(g.qa().clientWidth-f):c<a/2&&(E=g.qa().clientWidth+f);0!==E&&360>x&&e.strokeRect(E,y,a,k)}d(e,c,b);x=0;c>g.qa().clientWidth-16?x=-(g.qa().clientWidth-c):16>c&&(x=g.qa().clientWidth+c);0!==x&&d(e,x,b)};this.getCamera=this.j=function(){return{C:function(){return 0},t:function(){return 0},r:function(){return g.sc().clientHeight/g.sc().clientWidth*360},G:function(){return KolorEyesPlayer.d.T}}};this.getVisible=this.Aa=function(){return a};
this.setVisible=this.Hd=function(b){a=b};this.getContainer=this.p=function(){return g.sc()};this.f=function(){k=g=null}};KolorEyesGesture=function(c){_kolorEyesPlayer=c;_kolorEyesGesture=this;_hammer=null;_enabled=!1;this.enable=this.enable=function(){_enabled=!0;_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.cf)};this.disable=this.disable=function(){_enabled=!1;_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.bf)};this.isEnabled=this.isEnabled=function(){return _enabled};(function(){_hammer=new Hammer.Manager(_kolorEyesPlayer.ea());var b=new Hammer.Tap,c=new Hammer.Tap({event:"doubletap",taps:2}),e=new Hammer.Pinch,
d=new Hammer.Pan;_hammer.add([b,c,e,d]);_hammer.get("doubletap").recognizeWith("tap");_hammer.on("tap",function(b){_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.qb,b)});_hammer.on("doubletap",function(b){_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.Wc,b)});_hammer.on("pinchstart",function(b){_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.ac,b)});_hammer.on("pinchmove",function(b){_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.$b,b)});_hammer.on("pinchend",function(b){_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.Zb,
b)});_hammer.on("panstart",function(b){_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.vh,b)});_hammer.on("panmove",function(b){_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.Td,b)});_hammer.on("panend",function(b){_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.uh,b)})})()};KolorEyesGyro=function(c){THREE.Object3D.call(this);_kolorEyesPlayer=c;_kolorEyesGyro=this;_deviceOrientation=new THREE.DeviceOrientationControls(this);_viewMatrix=null;_enabled=!1;this.update=this.update=function(){_deviceOrientation.update();var b=new THREE.Matrix4;b.makeRotationFromEuler(this.rotation);var c=[];b.flattenToArrayOffset(c,0);return _viewMatrix=KolorEyesMath.Matrix4.c(c)};this.getViewMatrix=this.c=function(){return _viewMatrix};this.enable=this.enable=function(){_deviceOrientation.connect();
_enabled=!0;_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.Yc)};this.disable=this.disable=function(){_deviceOrientation.disconnect();_enabled=!1;_kolorEyesPlayer.dispatchEvent(KolorEyesPlayer.a.Xc)};this.isEnabled=this.isEnabled=function(){return _enabled}};KolorEyesHostingAPI=function(){};KolorEyesHostingAPI.Te="https://eyes.kolor.com/api/public/videos";KolorEyesHostingAPI.urlPublicVideos=KolorEyesHostingAPI.Te;KolorEyesHostingAPI.Ug="https://eyes.kolor.com/api/oauth/videos/{api_key}";KolorEyesHostingAPI.urlPrivateVideos=KolorEyesHostingAPI.Ug;KolorEyesHostingAPI.Wg="https://eyes.kolor.com/api/public/token/{login}/{password}";KolorEyesHostingAPI.urlToken=KolorEyesHostingAPI.Wg;KolorEyesHostingAPI.Xg="https://eyes.kolor.com/api/public/refresh_token/{api_key}/{login}/{password}/{refresh_token}";
KolorEyesHostingAPI.urlTokenRefresh=KolorEyesHostingAPI.Xg;KolorEyesHostingAPI.Yg="https://eyes.kolor.com/api/oauth/user/details/{api_key}";KolorEyesHostingAPI.urlUserInfo=KolorEyesHostingAPI.Yg;KolorEyesHostingAPI.Vg="https://eyes.kolor.com/api/oauth/ready";KolorEyesHostingAPI.urlReady=KolorEyesHostingAPI.Vg;
KolorEyesHostingAPI.ze=function(c,b){var f=KolorEyesHostingAPI.sa();f.open("POST",KolorEyesHostingAPI.Vg,!0);f.responseType="json";f.setRequestHeader("Authorization","Bearer "+c);f.onload=b;f.send()};KolorEyesHostingAPI.isReady=KolorEyesHostingAPI.ze;KolorEyesHostingAPI.ag=function(c,b){var f=KolorEyesHostingAPI.sa();f.open("POST",KolorEyesHostingAPI.Te,!0);f.responseType="json";f.onload=b;"undefined"!==typeof c?f.send(JSON.stringify(c)):f.send()};KolorEyesHostingAPI.getPublicVideos=KolorEyesHostingAPI.ag;
KolorEyesHostingAPI.s=function(c,b,f){var e=KolorEyesHostingAPI.sa();e.open("POST",KolorEyesHostingAPI.Te+"/"+c,!0);e.responseType="json";e.onload=f;"undefined"!=typeof b?e.send(JSON.stringify(b)):e.send()};KolorEyesHostingAPI.getUserVideos=KolorEyesHostingAPI.s;
KolorEyesHostingAPI.h=function(c,b,f,e){var d=KolorEyesHostingAPI.sa();d.responseType="json";var g=KolorEyesHostingAPI.Ug,g=g.replace("{api_key}",c);d.open("POST",g,!0);d.setRequestHeader("Authorization","Bearer "+b);d.onload=e;"undefined"!==typeof f?d.send(JSON.stringify(f)):d.send()};KolorEyesHostingAPI.getPrivateVideos=KolorEyesHostingAPI.h;
KolorEyesHostingAPI.P=function(c,b,f){var e=KolorEyesHostingAPI.sa();e.responseType="json";var d=KolorEyesHostingAPI.Wg,d=d.replace("{login}",c),d=d.replace("{password}",b),g;"function"===typeof f?g=f:g=function(){};e.open("GET",d,!0);e.onload=g;e.send()};KolorEyesHostingAPI.requestToken=KolorEyesHostingAPI.P;
KolorEyesHostingAPI.D=function(c,b,f,e,d){var g=KolorEyesHostingAPI.sa();g.responseType="json";var k=KolorEyesHostingAPI.Xg,k=k.replace("{api_key}",c),k=k.replace("{refresh_token}",b),k=k.replace("{login}",f),k=k.replace("{password}",e),a;"function"===typeof d?a=d:a=function(){};g.open("GET",k,!0);g.onload=a;g.send()};KolorEyesHostingAPI.refreshToken=KolorEyesHostingAPI.D;
KolorEyesHostingAPI.U=function(c,b,f){var e=KolorEyesHostingAPI.sa();e.responseType="json";var d=KolorEyesHostingAPI.Yg,d=d.replace("{api_key}",c),g;"function"===typeof f?g=f:g=function(){};e.open("GET",d,!0);e.setRequestHeader("Authorization","Bearer "+b);e.onload=g;e.send()};KolorEyesHostingAPI.requestUserInfo=KolorEyesHostingAPI.U;KolorEyesHostingAPI.sa=function(){return window.XDomainRequest?new window.XDomainRequest:window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP")};
KolorEyesHostingAPI.getXHR=KolorEyesHostingAPI.sa;KolorEyesHostingAPI.e=function(c){for(var b=[],f,e=0;e<c.presets.length;e++)f=c.presets[e],"m3u8"!==f.extension&&b.push(f);c.extension="mp4";c.mimeType="video/mp4";c.presets=b;return c};KolorEyesHostingAPI.formatDataForPlayer=KolorEyesHostingAPI.e;KolorEyesHostingSuggestUI=function(c){function b(a){q=a.target.response;a=0;for(var b=q.length;a<b;a++)n.Md[a].Xj=q[a],e(a,f)}function f(a,b){n.Md[b].style.backgroundImage="url("+a+")";n.Md[b].onclick=d}function e(a,b){var c=KolorEyesHostingAPI.sa();c.responseType="blob";var d=q[a].thumb_link;c.onload=function(){b(window.URL.createObjectURL(c.response),a)};c.open("GET",d,!0);c.send()}function d(){}function g(){a.show()}function k(){a.Ba()}var a=this,m=c.p(),n,q;this.alignCenter=this.Yd=function(){n.Hc.style.marginTop=
(n.clientHeight-n.Hc.clientHeight)/2+"px"};this.show=this.show=function(){n.style.display="block";a.Yd()};this.hide=this.Ba=function(){n.style.display="none"};(function(){n=document.createElement("div");n.className="playerOverlay";n.Hc=document.createElement("div");n.Hc.className="hostingSuggestContainer";n.appendChild(n.Hc);n.Md=[];for(var a,d=0;4>d;d++)a=document.createElement("div"),a.className="hostingSuggestThumb",n.Hc.appendChild(a),n.Md.push(a);m.appendChild(n);KolorEyesHostingAPI.ag({filter:{start:0,
limit:4,shuffle:1}},b);c.addEventListener(KolorEyesPlayer.a.Ma,g);c.addEventListener(KolorEyesPlayer.a.fa,k)})()};KolorEyesHostingUser=function(){var c=null,b=null,f=null,e="Guest";this.setLoginData=this.Xi=function(b){c=b};this.getLoginData=this.Vh=function(){return c};this.setTokenData=this.bj=function(c){null===b&&(b=[]);"undefined"!=typeof c.access_token&&(b.access_token=c.access_token);"undefined"!=typeof c.expires_in&&(b.expires_in=c.expires_in);"undefined"!=typeof c.token_type&&(b.token_type=c.token_type);"undefined"!=typeof c.scope&&(b.scope=c.scope);"undefined"!=typeof c.refresh_token&&(b.refresh_token=
c.refresh_token);"undefined"!=typeof c.api_key&&(b.api_key=c.api_key)};this.getTokenData=this.gi=function(){return b};this.setUserData=this.setUserData=function(b){f=b;e=b.firstname+" "+b.lastname};this.getUserData=this.getUserData=function(){return f};this.getDisplayName=this.Hh=function(){return e};this.getStorableObject=this.fi=function(){return{login:c.login,pass:c.pass,access_token:b.access_token,token_type:b.token_type,refresh_token:b.refresh_token,api_key:b.api_key}};this.restoreStorableObject=
this.Si=function(d){c={login:d.login,pass:d.pass};b={access_token:d.access_token,token_type:d.token_type,refresh_token:d.refresh_token,api_key:d.api_key}}};KolorEyesHotspot={Xb:function(c,b,f,e,d,g){this.yaw=isNaN(b)||"undefined"===typeof b?0:b;this.pitch=isNaN(f)||"undefined"===typeof f?0:f;this.ts=isNaN(c)||"undefined"===typeof c?0:c;this.visible="undefined"===typeof e?!0:e;this.fov=isNaN(d)||"undefined"===typeof d?90:d;this.projection=g||KolorEyesPlayer.d.I}};KolorEyesHotspot.Xb.e=function(c){for(var b="",f=0,e=c.length;f<e;f++)b+=c[f].Uj();return b};
KolorEyesHotspot.Xb.c=function(c){c=c.split(";");for(var b=[],f=0,e=c.length-1;f<e;f++){var d=c[f].split(",");b.push(new KolorEyesHotspot.Xb(d[0],d[1],d[2],d[3]))}return b};
KolorEyesHotspot.vf=function(c,b){var f=this,e=b||[],d=null,g=0,k=null,a=0,m=0,n=0,q=0;this.getKeyFrameAtTime=this.Qf=function(a){for(var b,c=0,d=e.length;c<d;c++)e[c].ts===a&&(b=e[c]);return b};this.addKeyFrame=this.Af=function(a){var b=this.Qf(a.ts);if("undefined"!==typeof b)for(var d in a)b[d]=a[d];else b=a,e.push(b),e=KolorEyesUtils.Oe("ts",e);!1===c.td()&&c.Sa().q().dispatchEvent(KolorEyesPlayer.a.rb,c);return b};this.removeKeyFrame=this.Ri=function(b){e.splice(b,1);0!==e.length===!1&&(d=g=null,
a=0);this.update(c.Sa().fg());c.Sa().q().dispatchEvent(KolorEyesPlayer.a.rb,c)};this.getKeyFrameList=this.Sf=function(){return e};this.getCurrentKeyFrame=this.jd=function(){var a=null;null!==d&&(a=e[d]);return a};this.getCurrentKeyFrameIndex=this.Fh=function(){return d};this.getNextKeyFrame=this.Xh=function(){var a=null;null!==g&&(a=e[g]);return a};this.getKeyFrameInterval=this.Sh=function(){return{zg:d,next:d}};this.getKeyFrameIntervalAtTime=this.Rf=function(a){for(var b,c=e.length-1,d=!1;0<=c&&
!(d=a>=e[c].ts)&&0!==c;)--c;a=d?c:null;null===a&&0<e.length?b=0:b=a<e.length-1?a+1:null;return{zg:a,next:b}};this.update=this.update=function(b){if(0!==e.length!==!1){var p=f.Rf(b);d=p.zg;g=p.next;null!==d&&"undefined"!==typeof e[d]&&(null===k||"undefined"!==typeof e[k]&&e[d].ts!=e[k].ts)&&(k=d,m=e[d].yaw,n=e[d].pitch,q=e[d].fov,c.Sa().q().dispatchEvent(KolorEyesPlayer.a.jf,c),"function"===typeof c.se&&c.se());null!==d&&(a=null===d||null===g?0:(b-e[d].ts)/(e[g].ts-e[d].ts),null!==g&&e[d].projection===
e[g].projection?(b=e[d].yaw,m=KolorEyesMath.Ae(b,KolorEyesMath.O(e[g].yaw,b-Math.PI,b+Math.PI),a),n=KolorEyesMath.Ae(e[d].pitch,e[g].pitch,a),q=KolorEyesMath.Ae(e[d].fov,e[g].fov,a)):(m=e[d].yaw,n=e[d].pitch,q=e[d].fov))}};this.getScreenPoint=this.cg=function(a,b,d,e,f,g){return c.Sa().mb[d](m,n,a,b,e,f,g)};this.getVisible=this.Aa=function(){return null===d?!1:e[d].visible};this.getYaw=this.C=function(){return m};this.getPitch=this.t=function(){return n};this.getFov=this.r=function(){return q}};
KolorEyesHotspot.Pc=function(c,b){function f(b){p=!0;var d=KolorEyesUtils.xa(b);b=c.q();var e=b.Cb()[w],f=e.j(),g=KolorEyesMath.S(f.C()),m=KolorEyesMath.S(f.t()),k=f.r(),d=c.gb[f.G()](d,e.p().clientWidth,e.p().clientHeight,g,m,k),e=new KolorEyesHotspot.Xb;e.ts=b.Qa();e.yaw=d.Nc;e.pitch=d.pitch;e.visible=!0;a.Af(e)}function e(){c.q().removeEventListener(KolorEyesPlayer.a.Q,e);c.q().Cb()[w].p().onmousemove=null;c.q().nd().Jf();for(var a=m[w],b=0,f=a.childNodes.length;b<f;b++)a.childNodes[b].style.opacity=
1;w=-1;!0===p&&(c.q().dispatchEvent(KolorEyesPlayer.a.rb,d),c.q().dispatchEvent(KolorEyesPlayer.a.gf,d));q=!1}var d=this,g="",k="",a=null,m=[],n,q=!1,w=-1,p=!1,v=!1,x=!1,y=!1,E=-1,L=!1,M=-1;this.init=this.F=function(){g=b.id||"hs-"+(new Date).getTime();k=b.name||"Untitled";M=c.cb().length;var J=[];"undefined"!==typeof b.points&&"undefined"!==typeof b.points[0]&&(J=b.points[0]);a=new KolorEyesHotspot.vf(d,J);n=b.imageURL;for(var J=c.q().Cb(),K,y=0,x=J.length;y<x;y++)K=document.createElement("div"),
K.className="kolorEyesHotspot",K.$g=y,K.id=d.qc()+"_"+y,K.onclick=function(){c.q().dispatchEvent(KolorEyesPlayer.a.ef,d)},K.onmouseover=function(){!0!==q&&(d.Ie(!0),E=this.$g,c.q().dispatchEvent(KolorEyesPlayer.a.mf,d))},K.onmouseout=function(){!0!==q&&(d.Ie(!1),E=-1,c.q().dispatchEvent(KolorEyesPlayer.a.lf,d))},K.onmousedown=function(a){if(!1!==v){a.preventDefault();c.q().dispatchEvent(KolorEyesPlayer.a.of,d);c.q().pause();q=!0;p=!1;w=a.currentTarget.$g;c.q().Cb()[w].p().onmousemove=f;c.q().addEventListener(KolorEyesPlayer.a.Q,
e);c.q().nd().be();a=m[w];for(var b=0,g=a.childNodes.length;b<g;b++)a.childNodes[b].style.opacity=.1}},J[y].p().appendChild(K),m.push(K),"string"===typeof n&&this.ug(y,n);d.zc(c.Mf())};this.loadImage=this.ug=function(a,b){if("string"===typeof b&&"undefined"!==typeof m[a]){var c=new Image;c.onload=function(){var b=this.naturalHeight||this.height,c=d.je(a);c.style.width=(this.naturalWidth||this.width)+"px";c.style.height=b+"px"};c.src=b;m[a].appendChild(c)}};this.getManager=this.Sa=function(){return c};
this.getIndex=this.rc=function(){for(var a=0,b=c.cb().length;a<b;a++)c.cb()[a]===d&&(M=a);return M};this.getId=this.qc=function(){return g};this.getName=this.getName=function(){return k};this.setName=this.Ke=function(a){k=a;if(!0===v){a=0;for(var b=m.length;a<b;a++)m[a].title=k;c.q().dispatchEvent(KolorEyesPlayer.a.rb,d);c.q().dispatchEvent(KolorEyesPlayer.a.Ud,d)}};this.isVisible=this.rg=function(){var b=!1,c=a.jd();c&&(b=c.visible);return b};this.isDragging=this.td=function(){return q};this.getHTMLElement=
this.je=function(a){return m[a||0]};this.getImage=this.Oh=function(a){return this.je(a||0).getElementsByTagName("IMG")[0]};this.getImageURL=this.Ph=function(){return n};this.setEditable=this.zc=function(a){v=a;a="kolorEyesHotspot";!0===v&&(a+=" kolorEyesHotspotEditable");for(var b=0,c=m.length;b<c;b++)m[b].className=a,!0===v&&(m[b].title=k)};this.isEditable=this.we=function(){return v};this.setSelected=this.aj=function(a){if(x!==a){x=a;a="kolorEyesHotspot";a=!0===x?a+" kolorEyesHotspotEditableSelected":
a+" kolorEyesHotspotEditable";for(var b=0,c=m.length;b<c;b++)m[b].className=a}};this.setHovered=this.Ie=function(a){y=a;if(!0===v){a="kolorEyesHotspot kolorEyesHotspotEditable";!0===x&&(a+="Selected");!0===y&&(a+="Hover");for(var b=0,c=m.length;b<c;b++)m[b].className=a}};this.isHovered=this.ni=function(){return y};this.getHoveredIndex=this.Nh=function(){return E};this.setLookAtMe=this.Je=function(a){L=a};this.getCenter=this.Eh=function(a){a=a||0;return new KolorEyesMath.g(parseInt(m[a].style.left,
10)+m[a].clientWidth/2,parseInt(m[a].style.top,10)+m[a].clientHeight/2,0)};this.show=this.show=function(a){if("number"===typeof a&&"undefined"!==typeof m[a])m[a].style.visibility="visible";else{a=0;for(var b=m.length;a<b;a++)m[a].style.visibility="visible"}c.q().dispatchEvent(KolorEyesPlayer.a.pf,d)};this.hide=this.Ba=function(a){if("number"===typeof a&&"undefined"!==typeof m[a])m[a].style.visibility="hidden";else{a=0;for(var b=m.length;a<b;a++)m[a].style.visibility="hidden"}c.q().dispatchEvent(KolorEyesPlayer.a.hf,
d)};this.update=this.update=function(b){if(null!==a)if(a.update(b),!1===d.rg())d.Ba();else{d.show();b=c.q().Cb();for(var e,f,g,k,n,p,w,l,y=0,E=b.length;y<E&&!1!==b[y].Aa();y++)0===y&&!1===q&&!0===L&&c.q().ba(KolorEyesMath.S(a.C()),KolorEyesMath.S(a.t())),e=KolorEyesMath.S(b[y].j().C()),f=KolorEyesMath.S(b[y].j().t()),g=b[y].j().r(),k=b[y].j().G(),n=b[y].p().clientWidth,p=b[y].p().clientHeight,w=this.bg(k,g),l="scale("+w+", "+w+")",m[y].scale=w,m[y].style.webkitTransform=l,m[y].style.MozTransform=
l,m[y].style.msTransform=l,m[y].style.xj=l,m[y].style.transform=l,f=a.cg(n,p,k,e,f,g),null!==f?(e=(f.y-m[y].offsetHeight/2).toFixed(),f=(f.x-m[y].offsetWidth/2).toFixed(),m[y].style.left=String(f)+"px",m[y].style.top=String(e)+"px"):d.Ba(y)}};this.kill=this.f=function(){a=null;for(var b=0,c=m.length;b<c;b++)m[b].parentNode.removeChild(m[b])};this.getScale=this.bg=function(a,b){var c=1;a===KolorEyesPlayer.d.I&&(c=(1/Math.tan(KolorEyesMath.i(b/2))).toFixed(3));return c};this.getPoint=this.ne=function(){return a};
this.getJSON=this.md=function(){_result={};_result.name=k;_result.id=g;_result.type=d.Ab();var b=a.Sf();_result.points=[];_result.points[0]=[];for(var c=0,e=b.length;c<e;c++)_result.points[0][c]={},_result.points[0][c].ts=b[c].ts,_result.points[0][c].yaw=b[c].yaw,_result.points[0][c].pitch=b[c].pitch,_result.points[0][c].visible=b[c].visible;return _result};this.getType=this.Ab=function(){return KolorEyesHotspot.types.Qc}};KolorEyesHotspot.DOMSpot=KolorEyesHotspot.Pc;
KolorEyesHotspot.Pc.prototype=new KolorEyesNamedObject;KolorEyesHotspot.Pc.prototype.n="Hotspot.DOMSpot";KolorEyesHotspot.Pc.prototype.debug=!1;
KolorEyesHotspot.bd=function(c,b){var f=this,e="",d="",g=null,k=!1,a=!1,m=!0,n=-1;this.init=this.F=function(){e=b.id||"hs-"+(new Date).getTime();d=b.name||"Untitled";n=c.cb().length;var a=[];"undefined"!==typeof b.points&&"undefined"!==typeof b.points[0]&&(a=b.points[0]);g=new KolorEyesHotspot.vf(f,a)};this.getManager=this.Sa=function(){return c};this.getIndex=this.rc=function(){for(var a=0,b=c.cb().length;a<b;a++)c.cb()[a]===f&&(n=a);return n};this.getId=this.qc=function(){return e};this.getName=
this.getName=function(){return d};this.setName=this.Ke=function(b){d=b;if(!0===a){b=0;for(var e=_elements.length;b<e;b++)_elements[b].title=d;c.q().dispatchEvent(KolorEyesPlayer.a.rb,f);c.q().dispatchEvent(KolorEyesPlayer.a.Ud,f)}};this.isDragging=this.td=function(){return k};this.startDrag=this.Dc=function(){k=!0};this.stopDrag=this.Fc=function(){k=!1};this.setEditable=this.zc=function(b){a=b};this.isEditable=this.we=function(){return a};this.setLookAtMe=this.Je=function(a){m=a};this.hitKeyFrameHandler=
this.se=function(){var a=g.jd();if(null!==a&&"undefined"!==typeof a){"string"===typeof a.projection&&c.q().H(a.projection,!1);var a=c.q(),b=KolorEyesMath.S(g.C()),d=KolorEyesMath.S(g.t()),e=g.r(),f=c.q().ke();5<=f.xd&&!1===f.wd&&(a.ba(b,d),a.A(e))}};this.update=this.update=function(a){if(null!==g&&(g.update(a),null!==g.jd())){a=c.q();var b=a.ke();if(!1===k&&!0===m&&!0===g.Aa()&&(0===b.Ef||5<=b.xd)&&(0===b.bh||5<=b.De)&&!1===b.wd&&(0===b.Bf||5<=b.Ce)&&!0===a.w()){var b=KolorEyesMath.S(g.C()),d=KolorEyesMath.S(g.t()),
e=g.r();a.ba(b,d);a.A(e)}}};this.kill=this.f=function(){g=null};this.getPoint=this.ne=function(){return g};this.getJSON=this.md=function(){b.name=d;b.id=e;return b};this.getType=this.Ab=function(){return KolorEyesHotspot.types.zf}};KolorEyesHotspot.TrackSpot=KolorEyesHotspot.bd;KolorEyesHotspot.bd.prototype=new KolorEyesNamedObject;KolorEyesHotspot.bd.prototype.n="Hotspot.DOMSpot";KolorEyesHotspot.bd.prototype.debug=!1;
KolorEyesHotspot.Manager=function(c){function b(){return null}var f=this,e=c,d=[],g=!0,k=!1;this.mb={};this.mb[KolorEyesPlayer.d.T]=KolorEyesUtils.gh;this.mb[KolorEyesPlayer.d.I]=KolorEyesUtils.fh;this.mb[KolorEyesPlayer.d.na]=b;this.mb[KolorEyesPlayer.d.la]=KolorEyesUtils.eh;this.mb[KolorEyesPlayer.d.ka]=KolorEyesUtils.dh;this.mb[KolorEyesPlayer.d.La]=b;this.gb={};this.gb[KolorEyesPlayer.d.T]=KolorEyesUtils.Eg;this.gb[KolorEyesPlayer.d.I]=KolorEyesUtils.Dg;this.gb[KolorEyesPlayer.d.na]=b;this.gb[KolorEyesPlayer.d.la]=
KolorEyesUtils.Cg;this.gb[KolorEyesPlayer.d.ka]=KolorEyesUtils.Bg;this.gb[KolorEyesPlayer.d.La]=b;this.getKolorEyesPlayer=this.q=function(){return e};this.registerHotspot=this.Ag=function(a){d.push(a);e.dispatchEvent(KolorEyesPlayer.a.df,a)};this.drawHotspots=this.If=function(a){if(g)for(var b=0,c=d.length;b<c;b++)d[b].update(a)};this.startRender=this.Ec=function(){e.Qa();for(var a=0,b=d.length;a<b;a++){var c=d[a];"function"===typeof c.show&&c.show()}g=!0};this.stopRender=this.Kd=function(){for(var a=
0,b=d.length;a<b;a++){var c=d[a];"function"===typeof c.Ba&&c.Ba()}g=!1};this.getHotspotList=this.cb=function(){return d};this.getHotspotById=this.Of=function(a){if("string"===typeof a)for(var b=0,c=d.length;b<c;b++)if(d[b].qc()===a)return d[b]};this.createHotspot=this.Ff=function(a){if("undefined"!==typeof a){var b="DOMSpot";"string"===typeof a.type&&"function"===typeof KolorEyesHotspot[a.type]&&(b=a.type);for(var c=a.points,d,g=0,k=c.length;g<k;g++)for(var v=0,x=c[g].length;v<x;v++)d=c[g][v],c[g][v]=
new KolorEyesHotspot.Xb(d.ts,d.yaw,d.pitch,d.visible,d.fov,d.projection);a=new KolorEyesHotspot[b](f,a);a.F();this.Ag(a);e.dispatchEvent(KolorEyesPlayer.a.ff,a);return a}};this.loadHotspotsJSONArray=this.tg=function(a,b){!0===b&&this.$d();for(var c=0,d=a.length;c<d;c++)this.Ff(a[c]);this.Se(0)};this.getHotspotsJSONArray=this.Mh=function(){for(var a=[],b=0,c=d.length;b<c;b++)a.push(d[b].md());return a};this.removeHotspotById=this.Qi=function(a){"string"===typeof a&&this.Fe(this.Of(a).rc())};this.removeHotspot=
this.Pi=function(a){"undefined"!==typeof a&&this.Fe(a.rc())};this.removeHotspotByIndex=this.Fe=function(a){if("number"===typeof a&&"undefined"!==typeof d[a]){var b=KolorEyesUtils.fd(d[a]);d[a].f();d.splice(a,1);e.dispatchEvent(KolorEyesPlayer.a.nf,b)}};this.getVideoCurrentTime=this.fg=function(){return e.Qa()};this.updateAllHotspotsTime=this.Se=function(a){f.b("update all spots time: "+a);a=0;for(var b=d.length;a<b;a++);};this.clearAllHotspots=this.$d=function(){for(var a=0,b=d.length;a<b;a++)d[a].f();
d=[]};this.setEditorMode=this.Vi=function(a){k=a;for(var b=0,c=d.length;b<c;b++)d[b].zc(a)};this.getEditorMode=this.Mf=function(){return k};this.f=function(){f.$d();f.Kd();f=e=null};this.b("Hotspot Manager instance created");e.addEventListener(KolorEyesPlayer.a.ab,function(){var a=g,b=e.G();g=b===KolorEyesPlayer.d.T||b===KolorEyesPlayer.d.I||b===KolorEyesPlayer.d.la||b===KolorEyesPlayer.d.ka;f.b("Render hotspots: "+(g?"yes":"no"));if(!a&&g)for(a=0,b=d.length;a<b;a++){var c=d[a];c.Ab()===KolorEyesHotspot.types.Qc&&
c.show()}else if(a&&!g)for(a=0,b=d.length;a<b;a++)c=d[a],c.Ab()===KolorEyesHotspot.types.Qc&&c.Ba()});e.addEventListener(KolorEyesPlayer.a.dc,function(){f.Se()})};KolorEyesHotspot.Manager.prototype=new KolorEyesNamedObject;KolorEyesHotspot.Manager.prototype.n="Hotspot.Manager";KolorEyesHotspot.Manager.prototype.debug=!1;KolorEyesHotspot.types={};KolorEyesHotspot.types=KolorEyesHotspot.types;KolorEyesHotspot.types.Qc="DOMSpot";KolorEyesHotspot.types.DOM_SPOT=KolorEyesHotspot.types.Qc;
KolorEyesHotspot.types.zf="TrackSpot";KolorEyesHotspot.types.TRACK_SPOT=KolorEyesHotspot.types.zf;KolorEyesIframeServerAPI=function(c){function b(){if(!1!==p.isReady())return J.currentTime=p.getCurrentTime(),J.volume=p.getVolume(),J.totalTime=p.getTotalTime(),J.fovMin=p.getFovMin(),J.fovMax=p.getFovMax(),J.fov=p.getFov(),J.yaw=p.getYaw(),J.pitch=p.getPitch(),J.projection=p.getProjection(),J.isPlaying=p.isPlaying(),J.presetIndex=p.getVideoQuality(),J}function f(a){null!==v&&null!==x&&(a.instanceID=y,v.postMessage(JSON.stringify(a),x))}function e(){b();var a=new KolorEyesMessageObject;a.result=
J;a.callbackName=KolorEyesIframeServerAPI.a.wh;f(a)}function d(){w.b("stopMainLoop");window.clearInterval(E);E=null}function g(){w.b("startMainLoop");E=window.setInterval(e,L)}function k(){for(var b in KolorEyesIframeServerAPI.a)p.addEventListener(KolorEyesIframeServerAPI.a[b],a)}function a(a){var c=new KolorEyesMessageObject;c.result=b();c.callbackName=a.type;c.data=a.data;f(c)}function m(){q();var a=new KolorEyesMessageObject;a.result=M;a.callbackName="playerReadyCallback";f(a)}function n(){q();
var a=new KolorEyesMessageObject;a.result=M;a.callbackName="videoConfigLoadedCallback";f(a)}function q(){M={presetCount:p.getVideoQualityList().length,presetIndex:p.getVideoQuality(),playerCoreType:p.getCoreType()}}var w=this,p=c,v=null,x=null,y="",E=null,L=100,M=null,J={currentTime:0,volume:0,totalTime:0,fovMin:0,fovMax:0,fov:0,yaw:0,pitch:0,projection:"",isPlaying:!1,presetIndex:0};this.connectIframe=this.Ch=function(a,c,d){var e={apiClientVersion:c,apiServerVersion:KolorEyesIframeServerAPI.version,
playerVersion:null,playerReady:p.isReady(),readyData:M,metaDataLoaded:p.isMetaDataLoaded(),updatedValues:b()};"undefined"===typeof c||""===c?console.warn("API version between your web page and the iframe can't be checked"):c!=KolorEyesIframeServerAPI.version&&console.error("API version does not match between your web page ["+c+"] and the Iframe ["+KolorEyesIframeServerAPI.version+"]");"function"!=typeof p.getVersion?console.warn("Unable to check the player version, getVersion is not defined so player should be under 1.0.0.108"):
(e.playerVersion=p.getVersion(),"undefined"===typeof d?console.warn("Unable to check compatibility between API used in your web page and the player instanciated in the iframe"):-1===d.indexOf(e.playerVersion)&&console.error("The API version on your web page ["+c+"] is not compatible with the player version ["+e.playerVersion+"]"),-1===KolorEyesIframeServerAPI.compatibility.indexOf(e.playerVersion)&&console.error("The API version used in the iframe ["+KolorEyesIframeServerAPI.version+"] is not compatible with the player version ["+
e.playerVersion+"]"));if(""!==a)return y=a,g(),e;console.error("Can't connect API without instanceID");return!1};this.setUpdateRate=this.cj=function(a){L=a;d();g()};this.f=function(){for(var b in KolorEyesIframeServerAPI.a)p.removeEventListener(KolorEyesIframeServerAPI.a[b],a);d();w=p=null};(function(){w.b("init");window.onmessage=function(a){w.b("receiveMessage");a=a||window.event;null===x&&a.origin&&(x=a.origin);null===v&&a.source&&(v=a.source);if(a.data){a=JSON.parse(a.data);var b=null,b="player"===
a.targetObj&&"function"===typeof p[a.methodName]?p[a.methodName].apply(null,a.argsArray):"api"===a.targetObj&&"function"===typeof w[a.methodName]?w[a.methodName].apply(null,a.argsArray):"ui"===a.targetObj&&"function"===typeof p.getPlayerUI()[a.methodName]?p.getPlayerUI()[a.methodName].apply(null,a.argsArray):"No method "+a.methodName+" has been found on "+a.targetObj;a.result=b;f(a)}};k();p.addEventListener(KolorEyesPlayer.a.Wd,n);p.addEventListener(KolorEyesPlayer.a.bb,m)})()};
KolorEyesIframeServerAPI.prototype=new KolorEyesNamedObject;KolorEyesIframeServerAPI.prototype.n="KolorEyesIframeServerAPI";KolorEyesIframeServerAPI.prototype.debug=!1;KolorEyesIframeServerAPI.a={};KolorEyesIframeServerAPI.a.vj="onConnected";KolorEyesIframeServerAPI.a.bb="onReady";KolorEyesIframeServerAPI.a.fa="onPlay";KolorEyesIframeServerAPI.a.da="onPause";KolorEyesIframeServerAPI.a.fc="onVolumeChange";KolorEyesIframeServerAPI.a.Ma="onEnded";KolorEyesIframeServerAPI.a.ua="onLoadedMetaData";
KolorEyesIframeServerAPI.a.ab="onProjectionChange";KolorEyesIframeServerAPI.a.dc="onSeek";KolorEyesIframeServerAPI.a.wh="onValuesUpdated";KolorEyesIframeServerAPI.a.Yb="onDisplaySourceChanged";KolorEyesIframeServerAPI.a.ec="onVideoQualityChanged";KolorEyesIframeServerAPI.version="1.1.0.400";KolorEyesIframeServerAPI.compatibility="1.0.0.106 1.0.0.107 1.0.0.108 1.0.0.109 1.0.0.110 1.0.0.111 1.0.0.112 1.0.2.400 1.1.0.400 1.2.0.400 1.3.0.400 1.4.0.400 1.5.0.400 1.6.3.400".split(" ");
KolorEyesMessageObject=function(){this.methodName="";this.argsArray=[];this.result=null;this.instanceID=this.callbackName=""};KolorEyesInputActivity=function(c){function b(){a.w()&&(m.uc=!0,a.dispatchEvent(KolorEyesPlayer.a.sb))}function f(){!0===m.uc&&a.dispatchEvent(KolorEyesPlayer.a.tb);m.uc=!1;clearTimeout(p);p=null;a.w()&&(p=setTimeout(b,5E3))}function e(){!0===a.nd().ng()&&(m.Bf++,clearInterval(w),m.Ce=0,w=setInterval(function(){m.Ce++},1E3))}function d(){if(null===a.pa()||!0!==a.pa().Da())m.bh++,clearInterval(q),m.De=0,q=setInterval(function(){m.De++},1E3)}function g(){!1===a.w()||null!==a.pa()&&!0===a.pa().Da()||
(m.Ef++,m.wd=!1,clearInterval(n),m.xd=0,n=setInterval(function(){m.xd++},1E3))}function k(){!1===a.w()||null!==a.pa()&&!0===a.pa().Da()||(m.wd=!0)}var a=c,m=this,n=null;this.Ef=this.xd=0;var q=null;this.bh=this.De=0;this.wd=!1;var w=null;this.Bf=this.Ce=0;var p=null;this.uc=!0;a.addEventListener(KolorEyesPlayer.a.ub,k);a.addEventListener(KolorEyesPlayer.a.Q,g);a.addEventListener(KolorEyesPlayer.a.cc,d);a.addEventListener(KolorEyesPlayer.a.bc,e);a.addEventListener(KolorEyesPlayer.a.vb,f);this.f=function(){m.uc=
!1;clearTimeout(p);p=null;clearInterval(n);n=null;clearInterval(q);q=null;clearInterval(w);w=null;a.removeEventListener(KolorEyesPlayer.a.ub,k);a.removeEventListener(KolorEyesPlayer.a.Q,g);a.removeEventListener(KolorEyesPlayer.a.cc,d);a.removeEventListener(KolorEyesPlayer.a.bc,e);a.removeEventListener(KolorEyesPlayer.a.vb,f);m=a=null}};KolorEyesKeyboardManager=function(c){function b(a){"left"===a||"right"===a?q.x=0:q.y=0;0===q.x&&0===q.y&&w.Fc()}function f(a){"left"===a?q.x=-400:"right"===a?q.x=400:"down"===a?q.y=n:"up"===a&&(q.y=-n);w.de(q)}function e(a){"left"===a||"right"===a?q.x=0:q.y=0;w.Dc(q)}function d(a){for(var b=0,c=v.length;b<c;b++){var d=v[b];if(-1!=x[d].N.indexOf(a))return k.b("In use key "+d+" rejects new key "+a),!0}return!1}function g(a,b){var c=v.indexOf(a),d=-1!=c;b?d||v.push(a):d&&v.splice(c,1)}var k=this,a=c,
m=!1;c=a.p();var n=400*c.clientHeight/c.clientWidth,q=new KolorEyesMath.g,w=a.me().Ta().j(),p={};this.Jf=function(){m=!0};this.be=function(){for(var a in p)null!==p[a]&&clearInterval(p[a]),delete p[a];v.splice(0,v.length);m=!1};var v=[],x={37:{R:function(a){e("left");a()},J:function(){f("left")},ja:function(){b("left")},N:[39,68],L:!0},65:{R:function(a){e("left");a()},J:function(){f("left")},ja:function(){b("left")},N:[39,68],L:!0},81:{R:function(a){e("left");a()},J:function(){f("left")},ja:function(){b("left")},
N:[39,68],L:!0},38:{R:function(a){e("up");a()},J:function(){f("up")},ja:function(){b("up")},N:[40,83],L:!0},90:{R:function(a){e("up");a()},J:function(){f("up")},ja:function(){b("up")},N:[40,83],L:!0},87:{R:function(a){e("up");a()},J:function(){f("up")},ja:function(){b("up")},N:[40,83],L:!0},39:{R:function(a){e("right");a()},J:function(){f("right")},ja:function(){b("right")},N:[37,65,81],L:!0},68:{R:function(a){e("right");a()},J:function(){f("right")},ja:function(){b("right")},N:[37],L:!0},40:{R:function(a){e("down");
a()},J:function(){f("down")},ja:function(){b("down")},N:[38,87,90],L:!0},83:{R:function(a){e("down");a()},J:function(){f("down")},ja:function(){b("down")},N:[38,87,90],L:!0},107:{J:function(){a.A(a.r()-5)},N:[33,109,34],L:!0},33:{J:function(){a.A(a.r()-5)},N:[107,109,34],L:!0},187:{J:function(){a.A(a.r()-5)},N:[107,109,34],L:!0},109:{J:function(){a.A(a.r()+5)},N:[34,107,33],L:!0},34:{J:function(){a.A(a.r()+5)},N:[109,107,33],L:!0},189:{J:function(){a.A(a.r()+5)},N:[109,107,33],L:!0},32:{R:function(){a.Kc()}},
48:{R:function(){a.Rg()}},13:{R:function(){a.H(KolorEyesPlayer.d.I)},N:[49,51,52,53,54,97,98,99,100,101,102]}};a.addEventListener(KolorEyesPlayer.a.bc,function(a){if(!1!==m){var b=a.data.keyCode;k.b("key pressed: "+b);if(b in x&&-1==v.indexOf(b)&&!d(b))return g(b,!0),b in p||(p[b]=null,a=function(){p[b]=setInterval(function(){x[b].J()},1E3/30);x[b].J();k.b("Key ["+b+"] - call downhold in interval")},x[b].R?x[b].J?(k.b("Key ["+b+"] - call async down handler, schedule downhold in interval on complete"),
x[b].R(a)):(k.b("Key ["+b+"] - call down handler"),x[b].R()):(k.b("Key ["+b+"] - call downhold handler in interval"),a())),!1}});a.addEventListener(KolorEyesPlayer.a.Vd,function(a){!1!==m&&(a=a.data.keyCode,a in x&&(g(a,!1),a in p&&(x[a].ja&&x[a].ja(),null!==p[a]&&clearInterval(p[a]),delete p[a])))});window.onkeydown=function(a){if(!1!==m){a=a||window.event;!1===a.ctrlKey&&(a.preventDefault?a.preventDefault():a.returnValue=!1);for(var b=0,c=KolorEyesPlayer.aa.length;b<c;b++)KolorEyesPlayer.aa[b].dispatchEvent(KolorEyesPlayer.a.bc,
a)}};window.onkeyup=function(a){if(!1!==m){a=a||window.event;a.preventDefault?a.preventDefault():a.returnValue=!1;for(var b=0,c=KolorEyesPlayer.aa.length;b<c;b++)KolorEyesPlayer.aa[b].dispatchEvent(KolorEyesPlayer.a.Vd,a)}};this.getKeyBindings=this.Rh=function(){return x};this.getKeyInUse=this.Th=function(){return v};this.isCameraKeyInUse=this.ng=function(){for(var a=!1,b=0,c=v.length;b<c;b++)if("undefined"!==typeof x[v[b]].L&&!0===x[v[b]].L){a=!0;break}return a};this.f=function(){k.be();k=a=null}};
KolorEyesKeyboardManager.prototype=new KolorEyesNamedObject;KolorEyesKeyboardManager.prototype.n="KeyboardManager";KolorEyesKeyboardManager.prototype.debug=!1;KolorEyesKrPanoView=function(c){var b=this,f=c,e=null,d=f.eb()+"_krSWF",g=null,k=!0,a=null;this.init=this.F=function(){function c(){b.b("loadKrScriptCallback");embedpano(k)}e||(e=document.createElement("div"),e.id=f.Lf()+"_krDiv",e.style.width="100%",e.style.height="100%",b.p().appendChild(e));var k={target:e.id,id:d,swf:KolorEyes.krpanoSWF,xml:KolorEyes.videoXML,html5:"never",passQueryParameters:!0,wmode:"opaque",onerror:function(a){f.b("krPano create error: "+a);var b=document.createElement("div");
b.style.width="400px";b.style.margin="auto";b.style.color="white";var c=document.createElement("p");c.innerHTML=a;a=document.createElement("a");a.innerHTML="Click to get last flash player version";a.href="http://get.adobe.com/flashplayer";a.style.color="orange";b.appendChild(c);b.appendChild(a);e.appendChild(b)},onready:function(c){b.b("onKrpanoCreateReady");g=c;a=g.get("version")},vars:{instanceID:f.eb()}};if("function"===typeof embedpano)b.b("embedpano function is already available, no need to add "+
KolorEyes.krpanoJS),c();else{b.b("embedpano function is unavailable, loading of "+KolorEyes.krpanoJS);var q,w,p;w=!1;q=document.createElement("script");q.type="text/javascript";q.src=KolorEyes.krpanoJS;q.onload=q.onreadystatechange=function(){w||this.readyState&&"complete"!=this.readyState||(w=!0,c())};p=document.getElementsByTagName("script")[0];p.parentNode.insertBefore(q,p)}};this.killKrPano=this.sg=function(a){null!==document.getElementById(d)&&(g.call("plugin[video].closevideo"),g=null,b.b("Call KrPano API removepano"),
removepano(d),function q(b){null===document.getElementById(d)?a&&window.setTimeout(a,0):0<b&&window.setTimeout(function(){q(b-1)},30)}(parseInt(1E3/30)))};this.getKrPanoInstance=this.Tf=function(){return g};this.getVersion=this.Bb=function(){return a};this.getCamera=this.j=function(){return{C:function(){return KolorEyesMath.i(f.C())},t:function(){return KolorEyesMath.i(f.t())},r:function(){return f.r()},G:function(){return KolorEyesPlayer.d.I}}};this.getVisible=this.Aa=function(){return k};this.setVisible=
this.Hd=function(a){k=a};this.getContainer=this.p=function(){return f.ie()};this.f=function(){b.sg(null);b=e=f=null}};KolorEyesKrPanoView.prototype=new KolorEyesNamedObject;KolorEyesKrPanoView.prototype.n="KolorEyesKrPanoView";KolorEyesKrPanoView.prototype.debug=!1;KolorEyesMath={};KolorEyesMath.We=Math.PI/180;KolorEyesMath.wf=180/Math.PI;
KolorEyesMath.g=function(c,b,f){this.x=c||0;this.y=b||0;this.z=f||0;this.toString=this.toString=function(){return"["+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.z.toFixed(3)+"]"};this.length=this.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};this.applyMatrix3=this.Zd=function(b){var c=b.yb();b=c[0];var f=c[1],c=c[2],k=b[1]*this.x+f[1]*this.y+c[1]*this.z,a=b[2]*this.x+f[2]*this.y+c[2]*this.z;this.x=b[0]*this.x+f[0]*this.y+c[0]*this.z;this.y=k;this.z=a};this.rotateYawPitch=
this.Ed=function(b,c){this.Zd(KolorEyesMath.B.c(b,c))};this.rotatePitchYaw=this.Dd=function(b,c){this.Zd(KolorEyesMath.B.e(b,c))};this.toSpherical=this.Ic=function(){var b=this.length();return{Qj:b,Ha:Math.atan2(this.x,this.z),Bd:Math.asin(this.y/b)}}};KolorEyesMath.g.prototype=new KolorEyesNamedObject;KolorEyesMath.g.prototype.n="Math.Vec3";KolorEyesMath.g.prototype.debug=!1;KolorEyesMath.g.c=function(c){return new KolorEyesMath.g(c.x,c.y,c.z)};KolorEyesMath.g.copy=KolorEyesMath.g.c;
KolorEyesMath.g.h=function(c,b){return c.x*b.x+c.y*b.y+c.z*b.z};KolorEyesMath.g.dot=KolorEyesMath.g.h;KolorEyesMath.g.e=function(c,b,f){return new KolorEyesMath.g(c*Math.sin(b)*Math.cos(f),c*Math.sin(f),c*Math.cos(b)*Math.cos(f))};KolorEyesMath.g.makeWithSphericalCoords=KolorEyesMath.g.e;
KolorEyesMath.B=function(c,b,f,e,d,g,k,a,m){var n=[[c,b,f],[e,d,g],[k,a,m]];this.getMatrix=this.yb=function(){return n};this.getTransposed=this.pe=function(){var a=n[0],b=n[1],c=n[2];return new KolorEyesMath.B(a[0],b[0],c[0],a[1],b[1],c[1],a[2],b[2],c[2])};this.getFlattened=this.Ra=function(){var a=n[0],b=n[1],c=n[2];return[a[0],a[1],a[2],b[0],b[1],b[2],c[0],c[1],c[2]]}};KolorEyesMath.B.prototype=new KolorEyesNamedObject;KolorEyesMath.B.prototype.n="Math.Matrix3";KolorEyesMath.B.prototype.debug=!1;
KolorEyesMath.B.s=function(c){return new KolorEyesMath.B(c[0]||0,c[1]||0,c[2]||0,c[3]||0,c[4]||0,c[5]||0,c[6]||0,c[7]||0,c[8]||0)};KolorEyesMath.B.makeWithArray=KolorEyesMath.B.s;KolorEyesMath.B.h=function(){return new KolorEyesMath.B(1,0,0,0,1,0,0,0,1)};KolorEyesMath.B.makeIdentity=KolorEyesMath.B.h;KolorEyesMath.B.c=function(c,b){var f=Math.cos(c),e=Math.sin(c),d=Math.cos(b),g=Math.sin(b);return new KolorEyesMath.B(f,0,e,g*e,d,-g*f,-d*e,g,d*f)};KolorEyesMath.B.makeYawPitchRotation=KolorEyesMath.B.c;
KolorEyesMath.B.e=function(c,b){var f=Math.cos(c),e=Math.sin(c),d=Math.cos(b),g=Math.sin(b);return new KolorEyesMath.B(f,e*g,e*d,0,d,-g,-e,f*g,f*d)};KolorEyesMath.B.makePitchYawRotation=KolorEyesMath.B.e;
KolorEyesMath.Matrix4=function(c,b,f,e,d,g,k,a,m,n,q,w,p,v,x,y){var E=[[c,b,f,e],[d,g,k,a],[m,n,q,w],[p,v,x,y]];this.getMatrix=this.yb=function(){return E};this.getFlattened=this.Ra=function(){var a=E[0],b=E[1],c=E[2],d=E[3];return[a[0],a[1],a[2],a[3],b[0],b[1],b[2],b[3],c[0],c[1],c[2],c[3],d[0],d[1],d[2],d[3]]};this.getTransposed=this.pe=function(){var a=E[0],b=E[1],c=E[2],d=E[3];return new KolorEyesMath.Matrix4(a[0],b[0],c[0],d[0],a[1],b[1],c[1],d[1],a[2],b[2],c[2],d[2],a[3],b[3],c[3],d[3])};this.preMultiplyWithMatrix=
this.Ee=function(a){var b=E[0],c=E[1],d=E[2],e=E[3],f=b[0],g=b[1],k=b[2],b=b[3],m=c[0],n=c[1],l=c[2],c=c[3],q=d[0],p=d[1],w=d[2],d=d[3],v=e[0],x=e[1],y=e[2],e=e[3];a=a.yb();var D=a[0],G=a[1],F=a[2],A=a[3];a=D[0];var S=D[1],ca=D[2],D=D[3],X=G[0],da=G[1],ba=G[2],G=G[3],aa=F[0],ga=F[1],na=F[2],F=F[3],oa=A[0],pa=A[1],qa=A[2],A=A[3];return KolorEyesMath.Matrix4.c([a*f+S*m+ca*q+D*v,a*g+S*n+ca*p+D*x,a*k+S*l+ca*w+D*y,a*b+S*c+ca*d+D*e,X*f+da*m+ba*q+G*v,X*g+da*n+ba*p+G*x,X*k+da*l+ba*w+G*y,X*b+da*c+ba*d+G*e,
aa*f+ga*m+na*q+F*v,aa*g+ga*n+na*p+F*x,aa*k+ga*l+na*w+F*y,aa*b+ga*c+na*d+F*e,oa*f+pa*m+qa*q+A*v,oa*g+pa*n+qa*p+A*x,oa*k+pa*l+qa*w+A*y,oa*b+pa*c+qa*d+A*e])};this.postMultiplyWithMatrix=this.c=function(a){var b=E[0],c=E[1],d=E[2],e=E[3],f=b[0],g=b[1],k=b[2],b=b[3],m=c[0],n=c[1],l=c[2],c=c[3],q=d[0],p=d[1],w=d[2],d=d[3],v=e[0],x=e[1],y=e[2],e=e[3];a=a.yb();var D=a[0],G=a[1],F=a[2],A=a[3];a=D[0];var S=D[1],ca=D[2],D=D[3],X=G[0],da=G[1],ba=G[2],G=G[3],aa=F[0],ga=F[1],na=F[2],F=F[3],oa=A[0],pa=A[1],qa=A[2],
A=A[3];return KolorEyesMath.Matrix4.c([f*a+g*X+k*aa+b*oa,f*S+g*da+k*ga+b*pa,f*ca+g*ba+k*na+b*qa,f*D+g*G+k*F+b*A,m*a+n*X+l*aa+c*oa,m*S+n*da+l*ga+c*pa,m*ca+n*ba+l*na+c*qa,m*D+n*G+l*F+c*A,q*a+p*X+w*aa+d*oa,q*S+p*da+w*ga+d*pa,q*ca+p*ba+w*na+d*qa,q*D+p*G+w*F+d*A,v*a+x*X+y*aa+e*oa,v*S+x*da+y*ga+e*pa,v*ca+x*ba+y*na+e*qa,v*D+x*G+y*F+e*A])}};
KolorEyesMath.Matrix4.c=function(c){return new KolorEyesMath.Matrix4(c[0]||0,c[1]||0,c[2]||0,c[3]||0,c[4]||0,c[5]||0,c[6]||0,c[7]||0,c[8]||0,c[9]||0,c[10]||0,c[11]||0,c[12]||0,c[13]||0,c[14]||0,c[15]||0)};KolorEyesMath.Matrix4.makeWithArray=KolorEyesMath.Matrix4.c;KolorEyesMath.Matrix4.s=function(){return new KolorEyesMath.Matrix4(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)};KolorEyesMath.Matrix4.makeIdentity=KolorEyesMath.Matrix4.s;
KolorEyesMath.Matrix4.h=function(c){c=c.Ra();return new KolorEyesMath.Matrix4(c[0],c[1],c[2],0,c[3],c[4],c[5],0,c[6],c[7],c[8],0,0,0,0,1)};KolorEyesMath.Matrix4.createWithMatrix3=KolorEyesMath.Matrix4.h;KolorEyesMath.Matrix4.D=function(c,b){var f=Math.cos(c),e=Math.sin(c),d=Math.cos(b),g=Math.sin(b);return KolorEyesMath.Matrix4.h(new KolorEyesMath.B(f,0,e,g*e,d,-g*f,-d*e,g,d*f))};KolorEyesMath.Matrix4.makeYawPitchRotation=KolorEyesMath.Matrix4.D;
KolorEyesMath.Matrix4.e=function(c,b,f){var e=Math.cos(c);c=Math.sin(c);var d=Math.cos(b);b=Math.sin(b);var g=Math.cos(f);f=Math.sin(f);return new KolorEyesMath.Matrix4(e*g,-e*f,c,0,b*c*g,-c*b*f+d*g,-e*b,0,-d*c*g,c*d*f+b*g,e*d,0,0,0,0,1)};KolorEyesMath.Matrix4.makeYawPitchRollRotation=KolorEyesMath.Matrix4.e;KolorEyesMath.Oa=function(c,b,f){return Math.min(Math.max(c,b),f)};KolorEyesMath.clampInInterval=KolorEyesMath.Oa;KolorEyesMath.O=function(c,b,f){return c<b?c+f-b:c>f?c-f+b:c};
KolorEyesMath.wrapInInterval=KolorEyesMath.O;KolorEyesMath.Ae=function(c,b,f){return c*(1-f)+b*f};KolorEyesMath.wrapInInterval=KolorEyesMath.O;KolorEyesMath.i=function(c){return c*KolorEyesMath.We};KolorEyesMath.degToRad=KolorEyesMath.i;KolorEyesMath.S=function(c){return c*KolorEyesMath.wf};KolorEyesMath.radToDeg=KolorEyesMath.S;KolorEyesMath.jc=function(c,b,f){this.x=c||0;this.y=b||0;this.z=f||0};KolorEyesMath.jc.c=function(){return new KolorEyesMath.jc(0,0,0)};KolorEyesMath.jc.prototype=new KolorEyesNamedObject;
KolorEyesMath.jc.prototype.n="Math.Quaternion";KolorEyesMath.jc.prototype.debug=!1;KolorEyesPlayer=function(){function c(a){null!==ia&&(ia.f(),ia=null);null!==ja&&(ja.f(),ja=null);null!==Ha&&(Ha.f(),Ha=null);null!==za&&(za.f(),za=null);null!==Ka&&(Ka.f(),Ka=null);null!==Ta&&(Ta.f(),Ta=null);null!==La&&(La.f(),La=null);null!==W&&(W.f(),W=null);null!==Ea&&(Ea.f(),Ea=null);null!==ta&&(ta.f(),ta=null);I.f();Q=ua=Aa=I=null;Ba=[];C.onmouseout=null;C.onmousemove=null;C.onmouseover=null;C.onmousedown=null;C.onmouseup=null;C.onmousewheel=null;C.onfullscreenchange=null;"function"==typeof C.removeEventListener&&
(C.removeEventListener("DOMMouseScroll",Oa,!1),C.removeEventListener("mousewheel",Oa,!1));if(0!=a){for(a=0;a<C.childNodes.length;a++)C.removeChild(C.childNodes[a]);C.innerHTML=""}ra=C=null;KolorEyesPlayer.ej(h);h=null}function b(){ta=new KolorEyesVideoPerfMonitor;ta.register(h.u(),f)}function f(a){var c=a.ratio;h.b("[QUALITY AUTO] - Video perf: "+a.dropped+" / "+a.total+" (ratio:"+100*c+"%)");.3<c&&(null!=ta&&(ta.Pb(),ta=null),a=I.Ni(),h.b("Decrease quality (lower perfs, preset: "+a+")"),h.Ac(a,function(){b()}))}
function e(){Ea=new KolorEyesBandwidthMonitor;h.b("Start bandwidth monitoring");Ea.register(h,d)}function d(a){var b=a.bandwidth,c=a.video;a=h.qe();h.b("[QUALITY AUTO] - Current bandwidth: "+(b.average/1024).toFixed()+"kbps ["+(b.min/1024).toFixed()+":"+(b.max/1024).toFixed()+"], (video bitrate: "+a/1024+" kbps)");var d=c.buffered-c.consumed,c=c.total-c.consumed,f=KolorEyesBandwidthMonitor.af/1E3;b.average<1.1*a&&d<f&&c>f?(g(),b=I.Mi(),h.b("Decrease quality (lower bitrate, preset: "+b+")"),h.Ac(b,
function(){e()})):(b=I.Li(),I.Kf()>1.2*I.Dh(b)&&(h.b("Increase quality (higher bitrate, preset: "+b+")"),h.Ac(b,function(){e()})))}function g(){h.b("Stop bandwidth monitoring");null!=Ea&&(Ea.Pb(),Ea=null)}function k(a){isNaN(a)&&(a=0);return a*I.ya()}function a(a){h.b("killKR");Ua=!1;h.pause();da();ra[0].f();c(a)}function m(a,b,c,d){!1!==d&&(Va=a,Wa=b,Ma=c||"px");c=c||Ma;C.style.width=a+c;C.style.height=b+c;h.xb()}function n(){ha("isPlaying");return!0===Fa?!z.get("plugin[video].ispaused"):!1}function q(a){ha("isProjectionAvailable");
switch(a){case KolorEyesPlayer.d.T:return!0;case KolorEyesPlayer.d.I:return!0;case KolorEyesPlayer.d.na:return!0;case KolorEyesPlayer.d.la:return!0;case KolorEyesPlayer.d.ka:return!0;case KolorEyesPlayer.d.La:return!1}}function w(a,b){ha("setProjection");Xa=a;switch(a){case KolorEyesPlayer.d.T:z.call("projection_source()");break;case KolorEyesPlayer.d.I:z.call("projection_rectilinear()");break;case KolorEyesPlayer.d.na:z.call("projection_panini()");break;case KolorEyesPlayer.d.la:z.call("projection_littleplanet()");
break;case KolorEyesPlayer.d.ka:z.call("projection_fisheye()")}W&&W.Ec();!1!==b&&h.dispatchEvent(KolorEyesPlayer.a.ab,a)}function p(){ha("getLoaded");return k(parseFloat(z.get("plugin[video].loadedbytes")))}function v(){ha("getTotalToLoad");return k(parseFloat(z.get("plugin[video].totalbytes")))}function x(){ha("getTotalTime");return k(parseFloat(z.get("plugin[video].totaltime")))}function y(){ha("getCurrentTime");return k(parseFloat(z.get("plugin[video].time")))}function E(a){h.w();h.Qa();z.call("plugin[video].seek("+
parseInt(a/I.ya())+")")}function L(a){z.set("view.fov",a)}function M(){return parseFloat(z.get("view.fovmax"))}function J(){return parseFloat(z.get("view.fovmin"))}function K(){return parseFloat(z.get("view.fov"))}function O(a){return z.set("control.mousespeed",a)}function N(){return parseFloat(z.get("control.mousespeed"))}function P(a,b){z.set("view.hlookat",a);z.set("view.vlookat",b)}function t(a){z.set("view.vlookat",a)}function u(){return parseFloat(z.get("view.vlookat"))}function r(a){z.set("view.hlookat",
a)}function l(){return parseFloat(z.get("view.hlookat"))}function U(){ha("getVolume");return parseFloat(z.get("plugin[video].volume"))}function T(a){ha("setVolume");1<a&&(a=1);0>a&&(a=0);z.set("plugin[video].volume",a);h.dispatchEvent(KolorEyesPlayer.a.fc)}function Y(){h.b("togglePlaybackKR");ha("togglePlayback");var a=z.get("plugin[video].ispaused");z.call("plugin[video].togglepause()");(function Yb(b){var c=h.w();a&&c?h.dispatchEvent(KolorEyesPlayer.a.fa):a||c?0<b&&window.setTimeout(function(){Yb(b-
1)},100):h.dispatchEvent(KolorEyesPlayer.a.da)})(10)}function B(){ha("stop");h.b("stopKR");z.call("plugin[video].stop()");(function Pa(a){h.w()?0<a&&window.setTimeout(function(){Pa(a-1)},30):h.dispatchEvent(KolorEyesPlayer.a.da)})(1E3/30)}function H(){ha("pause");h.b("pauseKR");z.call("plugin[video].pause()");(function Pa(a){h.w()?0<a&&window.setTimeout(function(){Pa(a-1)},30):h.dispatchEvent(KolorEyesPlayer.a.da)})(1E3/30)}function R(a){function b(){h.removeEventListener(KolorEyesPlayer.a.ma,b);
h.play()}h.b("playAtKR");h.addEventListener(KolorEyesPlayer.a.ma,b);E(a)}function D(){h.b("playKR");ha("play");z.call("plugin[video].play()");(function Pa(a){h.w()?h.dispatchEvent(KolorEyesPlayer.a.fa):0<a&&window.setTimeout(function(){Pa(a-1)},30)})(1E3/30)}function G(a,b){if(0!==h.dg(a).length&&a!==I.ya()){var c=I.ig(a);h.b("New stream: "+c);var d={volume:h.ra(),framerate:I.pc(),speed:a};A(c,d,function(c){b&&b(c);$a(c,a)})}}function F(a,b){if(a!==I.kd()&&!1!==I.Wa(a)){var c=I.jg(a);h.b("Use file: "+
c);var d={volume:h.ra(),speed:1};A(c,d,function(c){c&&I.Fg(a);b&&b();ab(c,a)})}}function A(a,b,c){if(Na)h.b("Cannot change playback rate (one still in progress)");else{var d=h.w(),e=b.speed,f=parseFloat(z.get("plugin[video].time"));h.b("setVideoSourceKR "+I.od()+" -> "+e+", jump from "+f+" to "+k(f)+"wasPlaying : "+d);I.kb(e);var g=function(){h.b("New video metadata received !");h.removeEventListener(KolorEyesPlayer.a.ua,g);h.Nb(b.volume);ba();Na=!1;d&&h.play();.1>f&&null!==ja&&ja.Mg();c&&c(!0)};
h.addEventListener(KolorEyesPlayer.a.ua,g);bb=!1;Na=!0;null!==ja&&ja.gd();da();S(a)}}function S(a){h.b("loadVideoKR "+a);!0===Fa?("1.17"===ra[0].Bb().substr(0,4)||"1.18"===ra[0].Bb().substr(0,4)?z.call("plugin[video].playvideo("+a+")"):"1.16"===ra[0].Bb().substr(0,4)&&z.set("plugin[video].videourl",a),ba()):setTimeout(function(){S(a)},200)}function ca(){h.dispatchEvent(KolorEyesPlayer.a.ma);h.dispatchEvent(KolorEyesPlayer.a.$a)}function X(){ob();ba()}function da(){"safari"===KolorEyes.env.browserName?
window.clearTimeout(Qa):Qa=window.cancelAnimFrame(X);Qa=null}function ba(){"safari"===KolorEyes.env.browserName?Qa=window.setTimeout(X,1E3):Qa=window.requestAnimFrame(X)}function aa(){h.b("onCoreReadyKR");a:{try{ha("getKrPanoInstance");z=ra[0].Tf();break a}catch(a){console.error("getKrPanoInstance exception: "+a)}z=null}z.Ta=function(){};Fa=!0;h.dispatchEvent(KolorEyesPlayer.a.bb)}function ga(){ea=C;if(!1===Fa){h.wg=ca;h.Oj=aa;h.onCoreReady=aa;h.kb=G;h.setVideoPlaybackRate=G;h.Ac=F;h.setVideoQuality=
F;h.play=D;h.play=D;h.xg=R;h.playAt=R;h.pause=H;h.pause=H;h.Kc=Y;h.togglePlayback=Y;h.stop=B;h.stop=B;h.Nb=T;h.setVolume=T;h.ra=U;h.getVolume=U;h.Mb=E;h.setCurrentTime=E;h.Qa=y;h.getCurrentTime=y;h.C=l;h.getYaw=l;h.Me=r;h.setYaw=r;h.t=u;h.getPitch=u;h.jb=t;h.setPitch=t;h.ba=P;h.lookAt=P;h.pd=N;h.getVelocity=N;h.Gd=O;h.setVelocity=O;h.r=K;h.getFov=K;h.oc=J;h.getFovMin=J;h.ld=M;h.getFovMax=M;h.A=L;h.setFov=L;h.eg=v;h.getTotalToLoad=v;h.Uf=p;h.getLoaded=p;h.za=x;h.getTotalTime=x;h.H=w;h.setProjection=
w;h.fb=q;h.isProjectionAvailable=q;h.w=n;h.isPlaying=n;h.resizeTo=m;h.resizeTo=m;h.f=a;h.kill=a;if(!ra[0]){var b=new KolorEyesKrPanoView(h);ra.push(b)}ra[0].F()}}function na(a){h.b("kill");Ua=!1;h.pause();z.f();z=null;c(a)}function oa(a,b,c,d){!1!==d&&(Va=a,Wa=b,Ma=c||"px");c=c||Ma;C.style.width=a+c;C.style.height=b+c;h.xb()}function pa(){return z.w()}function qa(a){switch(a){case KolorEyesPlayer.d.T:return!1;case KolorEyesPlayer.d.I:return!0;case KolorEyesPlayer.d.na:return!1;case KolorEyesPlayer.d.la:return!0;
case KolorEyesPlayer.d.ka:return!0;case KolorEyesPlayer.d.La:return!1}}function lb(a,b,c){var d=KolorEyesCoreProjection.m.va;180>h.r()&&(d=KolorEyesCoreProjection.m.Na);Xa=a;h.dispatchEvent(KolorEyesPlayer.a.rf);z.Ta().H(d,function(){Xa=a;W&&W.Ec();!1!==c&&h.dispatchEvent(KolorEyesPlayer.a.ab)},b)}function mb(a){z.j().Jg(a)}function nb(a,b,c,d){h.oa()===KolorEyesPlayer.Z.Ka&&(a=79);0<b?(c=c||KolorEyesCoreEasing.k.LINEAR,Ra&&Ra.cancel(),Ra=new KolorEyesCoreEasing,Ra.ga(z.j().r,z.Ta().A,a,b,c,function(){Ra=
null;d&&d();h.dispatchEvent(KolorEyesPlayer.a.wj)})):z.Ta().A(a)}function pb(){return z.j().ld()}function qb(){return z.j().oc()}function rb(){return z.j().r()}function sb(a){return z.j().Gd(a)}function tb(){return z.j().pd()}function ub(a,b){return z.j().ba(KolorEyesMath.i(a),KolorEyesMath.i(b))}function vb(a){return z.j().ba(z.j().C(),KolorEyesMath.i(a))}function wb(){return KolorEyesMath.S(z.j().t())}function xb(a){return z.j().ba(KolorEyesMath.i(a),z.j().t())}function yb(){return KolorEyesMath.S(z.j().C())}
function zb(){return k(Ab)}function Bb(){return k(z.u().duration)}function Cb(){return k(z.u().duration)}function Db(){return k(z.u().currentTime)}function Eb(a){function b(){z.u().removeEventListener("seeked",b,!1);c&&z.u().play();null!==W&&W.Ec()}a=a/I.ya();var c=z.w();z.u().pause();z.u().addEventListener("seeked",b,!1);null!==W&&W.Kd();z.u().currentTime=a;h.dispatchEvent(KolorEyesPlayer.a.ma)}function Fb(){return z.u().volume}function Gb(a){1<a&&(a=1);0>a&&(a=0);z.u().volume=a;h.dispatchEvent(KolorEyesPlayer.a.fc)}
function Hb(){z.Qg();!0===z.w()?h.dispatchEvent(KolorEyesPlayer.a.fa):h.dispatchEvent(KolorEyesPlayer.a.da)}function Ib(){z.pause();h.Mb(0);h.dispatchEvent(KolorEyesPlayer.a.da)}function Jb(){z.pause();h.dispatchEvent(KolorEyesPlayer.a.da)}function Kb(){z.play();h.dispatchEvent(KolorEyesPlayer.a.fa)}function Lb(a,b){if(a!==I.kd()&&!1!==I.Wa(a)){var c=I.jg(a);h.b("Use file: "+c);var d={volume:h.ra(),framerate:I.pc(),speed:1},e=I.Ua()[a];h.dispatchEvent(KolorEyesPlayer.a.$c,e);Mb(c,d,function(c){c&&
(I.Fg(a),Q.playbackRate=I.od()/I.ya());b&&b(c);ab(c,a)})}}function Nb(a,b){if(a!==I.od())if(h.b("Set playback rate: "+a),I.Ne(a)){var c=I.ig(a);h.b("New stream: "+c);var d={volume:h.ra(),framerate:I.pc(),speed:I.zb(a)};Mb(c,d,function(c){c&&(I.kb(a),Q.playbackRate=a/I.ya());b&&b(c);h.b("Video quality change "+(c?"succeeded":"failed"));$a(c,a)})}else Q.playbackRate=a/I.ya(),h.b("New playback rate "+Q.playbackRate),I.kb(a),$a(!0,a)}function Mb(a,b,c){Na&&(c&&c(!1),z.dd("Aborted, another source is selected"));
Na=!0;Aa=document.createElement("video");for(prop in b)Aa.dataset[prop]=b[prop];Aa.style.display="none";Aa.setAttribute("crossorigin","anonymous");Aa.setAttribute("width",Z.clientWidth);Aa.style.position="absolute";Aa.style.top=(Q.clientHeight-Z.clientHeight)/2*-1+"px";b=document.createElement("source");b.src=a;b.tj=I.le();null!==W&&W.Kd();z.nc(Aa,b,function(a){a&&(Q=z.u(),ia&&ia.F(),h.xb());null!==ja&&ja.Ob();c&&c(a);null!==W&&W.Ec();Na=!1})}function Zb(){h.dispatchEvent(KolorEyesPlayer.a.ma);h.dispatchEvent(KolorEyesPlayer.a.$a)}
function $b(){!1===Fa&&(h.wg=Zb,h.kb=Nb,h.setVideoPlaybackRate=Nb,h.Ac=Lb,h.setVideoQuality=Lb,h.play=Kb,h.play=Kb,h.pause=Jb,h.pause=Jb,h.Kc=Hb,h.togglePlayback=Hb,h.stop=Ib,h.stop=Ib,h.Nb=Gb,h.setVolume=Gb,h.ra=Fb,h.getVolume=Fb,h.Mb=Eb,h.setCurrentTime=Eb,h.Qa=Db,h.getCurrentTime=Db,h.eg=Bb,h.getTotalToLoad=Bb,h.Uf=zb,h.getLoaded=zb,h.za=Cb,h.getTotalTime=Cb,h.oc=qb,h.getFovMin=qb,h.ld=pb,h.getFovMax=pb,h.r=rb,h.getFov=rb,h.A=nb,h.setFov=nb,h.Vj=mb,h.setCameraSmoothness=mb,h.C=yb,h.getYaw=yb,h.Me=
xb,h.setYaw=xb,h.t=wb,h.getPitch=wb,h.jb=vb,h.setPitch=vb,h.ba=ub,h.lookAt=ub,h.pd=tb,h.getVelocity=tb,h.Gd=sb,h.setVelocity=sb,h.H=lb,h.setProjection=lb,h.fb=qa,h.isProjectionAvailable=qa,h.w=pa,h.isPlaying=pa,h.resizeTo=oa,h.resizeTo=oa,h.f=na,h.kill=na,ua=document.createElement("canvas"),Q=document.createElement("video"),sa=document.createElement("canvas"),ea=document.createElement("div"),ea.className="canvasContainer",ea.style.width=C.clientWidth+"px",ea.style.height=C.clientHeight+"px",ea.style.overflow=
"hidden",ea.appendChild(ua),Z=document.createElement("div"),Z.className="videoContainer",Z.style.width=C.clientWidth+"px",Z.style.height=C.clientHeight/3+"px",Z.style.position="relative",Z.style.overflow="hidden",Z.appendChild(Q),Z.appendChild(sa),C.appendChild(ea),C.appendChild(Z),ua.setAttribute("width",ea.clientWidth),ua.setAttribute("height",ea.clientHeight),ua.style.verticalAlign="bottom",ua.className="kolorEyesCanvas",Q.setAttribute("crossorigin","anonymous"),Q.setAttribute("width",Z.clientWidth),
Q.style.position="absolute",Q.style.top=(Q.clientHeight-Z.clientHeight)/2*-1+"px",Q.dataset.framerate=I.pc(),Q.dataset.speed=1,sa.setAttribute("width",Q.clientWidth),sa.setAttribute("height",Q.clientHeight),sa.style.position="absolute",sa.style.top=Q.style.top,sa.style.pointerEvents="none",z=new KolorEyesCore(h),z.onProgress=function(a){0<a.target.buffered.length&&(Ab=a.target.buffered.end(a.target.buffered.length-1))},z.onEnded=function(){h.zd()},z.onRender=function(){ob()},z.onLoadedMetaData=h.Ad,
z.F(),ra.push(z.Ta()),!0===KolorEyes.env.isMobile&&h.ee(),Fa=!0,h.dispatchEvent(KolorEyesPlayer.a.bb))}function Ob(a){h.dispatchEvent(KolorEyesPlayer.a.tf,{success:!0,mode:a})}function $a(a,b){h.dispatchEvent(KolorEyesPlayer.a.uf,{success:a,speed:b})}function ab(a,b){var c={success:a,index:b,name:I.Ua()[b].name};h.dispatchEvent(KolorEyesPlayer.a.ec,c)}function ha(a){!0!==Fa&&h.b("KolorEyesPlayer."+a+" :: Core is not ready, you sould wait for ON_READY event")}function Pb(){var a="kr";if(!0===KolorEyes.env.webGL){var b=
document.createElement("video");b.canPlayType&&(a=0<b.canPlayType(I.le()).length?"ke":"kr")}return a}function ob(){if(!1!==Ua){h.wg();h.b("checkPlayerSize");if(C.clientWidth!==Qb||C.clientHeight!==Rb)Qb=C.clientWidth,Rb=C.clientHeight,h.xb();null!==W&&W.If(h.Qa());null!==ia&&!0===Ia&&ia.yc()}}function Oa(a){h.b("global mouse wheel");a=a||window.event;a.preventDefault&&a.preventDefault();h.dispatchEvent(KolorEyesPlayer.a.cc,a)}function ac(a){var b=a||window.event;b.stopPropagation?b.stopPropagation():
b.returnValue=!1;for(var b=0,c=KolorEyesPlayer.aa.length;b<c;b++)KolorEyesPlayer.aa[b].dispatchEvent(KolorEyesPlayer.a.Q,a)}function bc(a){var b=a||window.event;b.stopPropagation?b.stopPropagation():b.returnValue=!1;h.dispatchEvent(KolorEyesPlayer.a.ub,a)}function cc(a){for(var b=a.relatedTarget||a.toElement;null!==b&&"undefined"!==typeof b&&KolorEyesUtils.og(b.tagName)&&"body"!==b.tagName.toLowerCase();){if(b==C)return;b=b.parentNode}C.onmouseout=null;C.onmousemove=null;C.onmouseover=Sb;cb=!1;za&&
za.be();!0===Ja&&null!==ja&&h.w();db={x:0,y:0};h.dispatchEvent(KolorEyesPlayer.a.Zc,a)}function Sb(){C.onmouseover=null;C.onmouseout=cc;"kr"!=ka&&(C.onmousemove=dc);cb=!0;window.focus();za&&za.Jf();h.dispatchEvent(KolorEyesPlayer.a.qf)}function dc(a){db=KolorEyesUtils.xa(a);if(Tb!=a.pageX||Ub!=a.pageY)Tb=a.pageX,Ub=a.pageY,h.dispatchEvent(KolorEyesPlayer.a.vb,a)}function ec(){!1===h.xe()?(h.resizeTo(Va,Wa,Ma),h.dispatchEvent(KolorEyesPlayer.a.Vc)):(h.resizeTo(100,100,"%",!1),h.dispatchEvent(KolorEyesPlayer.a.Uc))}
var h=this,Ya="kep_0",eb=!1,fb=!0,la="",C=null,ka="",Ga="auto",z=null,Sa=!1,W=null,Ja=!1,ja=null,gb=!1,Za=null,hb=!1,Ta=null,Ha=null,ia=null,Ia=!1,za=null,Ka=null,Xa,Fa=!1,Qa=null,Ba=[],Va=0,Wa=0,Ma="px",Qb=0,Rb=0,bb=!1,xa=null,ya=null,Ra=null,Ab=0,Z=null,Q=null,Aa=null,sa=null,ea=null,ua=null,Na=!1,ra=[],Tb=0,Ub=0,cb=!1,db={x:0,y:0},ib=KolorEyesPlayer.qualityMode.MANUAL,Ea=null,ta=null,I=null,La=null,Ca=null,Da=null,Ua=!0,va={autoInit:!0,containerID:"",coreChoiceMode:"auto",videoQuality:"auto",playerUI:!0,
posterURL:null,hotspotManager:!1,hostingSuggest:!1,iframeAPI:!1,remote:!1,remoteURL:null},fa=KolorEyesUtils.fd(va);(function(a){if(1>a.length)return console.error("KolorEyesPlayer constructor needs at least one single arguments : its container ID or container DOM Element"),!1;if(1<=a.length&&("string"===typeof a[0]||KolorEyesUtils.ve(a[0])))return"undefined"!=typeof a[0]?la=a[0]:la=va.containerID,"undefined"!=typeof a[1]?Ja=a[1]:Ja=va.playerUI,"undefined"!=typeof a[2]?Sa=a[2]:Sa=va.hotspotManager,
!0;if(1===a.length&&"object"===typeof a[0])return fa=a[0],"undefined"!=typeof fa.autoInit?fb=fa.autoInit:fb=va.autoInit,"undefined"!=typeof fa.containerID?la=fa.containerID:la=va.containerID,"undefined"!=typeof fa.coreChoiceMode?Ga=fa.coreChoiceMode:Ga=va.coreChoiceMode,"undefined"!=typeof fa.playerUI?Ja=fa.playerUI:Ja=va.playerUI,"undefined"!=typeof fa.hotspotManager?Sa=fa.hotspotManager:Sa=va.hotspotManager,"undefined"!=typeof fa.hostingSuggest?gb=fa.hostingSuggest:gb=va.hostingSuggest,"undefined"!=
typeof fa.iframeAPI?hb=fa.iframeAPI:hb=va.iframeAPI,!0})(arguments);this.getConfig=this.Pa=function(a){return"undefined"!=typeof a?fa[a]:fa};this.init=this.F=function(){if(!0!==eb){h.b("init");Ya=KolorEyesPlayer.Wh();h.b("instanceID "+Ya);if("string"===typeof la){if(C=document.getElementById(la),null===C)throw'ERROR @ KolorEyesPlayer : The containerID "'+la+'" does not correspond to a DOM Element';}else KolorEyesUtils.ve(la)&&(C=la,"undefined"===typeof C.id||""===C.id?(la=Ya,C.id=la):la=C.id);if(null===
C||"undefined"===typeof la)throw"ERROR @ KolorEyesPlayer : The containerID, or DOM Element argument doesn't exist, can't instantiate KolorEyesPlayer";C.style.backgroundColor="#000";C.style.overflow="hidden";C.style.position="relative";var a=/[0-9]*/.exec(C.style.height)[0],b=/[^0-9]*$/.exec(C.style.width)[0];Va=/[0-9]*/.exec(C.style.width)[0]||C.clientWidth;Wa=a||C.clientHeight;Ma=b||"px";C.onfullscreenchange=document.onmozfullscreenchange=C.onwebkitfullscreenchange=ec;KolorEyesPlayer.Oi(h);!0===
hb&&(h.b("_initIframeAPI true = instanciate API"),Ta=new KolorEyesIframeServerAPI(h));!1===("msie"===KolorEyes.env.browserName&&9>KolorEyes.env.browserMajor)&&(C.onmouseover=Sb);C.onmousedown=bc;C.onmouseup=ac;"undefined"!=typeof C.addEventListener?"firefox"===KolorEyes.env.browserName?C.addEventListener("DOMMouseScroll",Oa,!1):C.addEventListener("mousewheel",Oa,!1):C.onmousewheel=Oa;eb=!0}};this.sd=function(){return Ua};this.setVideoQualityMode=this.Lg=function(a){"ke"===h.hd()&&(ib=a,a==KolorEyesPlayer.Fa.Ve?
(e(),b()):a==KolorEyesPlayer.Fa.Sc&&(g(),null!=ta&&(ta.Pb(),ta=null)),Ob(ib))};this.getVideoQualityMode=this.ii=function(){return ib};this.getVideoQualityList=this.Ua=function(){return I.Ua()};this.getVideoQuality=this.hg=function(){return I.kd()};this.getVideoPlaybackRate=this.hi=function(){return I.od()};this.getSupportedPlaybackRates=this.dg=function(a){function b(a){return 1>a||16<a?!1:"ke"==ka?!0:-1!==c.indexOf(a)}var c=I.oe();if("number"===typeof a)return b(a)?[a]:[];if("object"===typeof a){for(var d=
[],e=0,f=a.length;e<f;e++)b(a[e])&&d.push(a[e]);return d}return c};this.fitContentToContainer=this.xb=function(){h.b("fitContentToContainer");null!==ea&&"kr"!==ka&&(ea.style.width=C.clientWidth+"px",!0===Ia?(ea.style.height=C.clientHeight/3*2+"px",Q.style.display="block"):ea.style.height=C.clientHeight+"px",null!==ua&&(ua.setAttribute("width",ea.clientWidth),ua.setAttribute("height",ea.clientHeight)),null!==Z&&(Z.style.width=C.clientWidth+"px",Z.style.height=C.clientHeight/3+"px"),null!==Za&&Za.Yd(),
null!==Q&&(Q.setAttribute("width",Z.clientWidth),Q.style.top=(Q.clientHeight-Z.clientHeight)/2*-1+"px"),null!==sa&&(sa.setAttribute("width",Q.clientWidth),sa.setAttribute("height",Q.clientHeight),sa.style.top=Q.style.top))};this.isFullScreen=this.xe=function(){if("undefined"!==typeof document.fullScreen)return document.fullScreen;if("undefined"!==typeof document.mozFullScreen)return document.mozFullScreen;if("undefined"!==typeof document.webkitIsFullScreen)return document.webkitIsFullScreen};this.toggleFullScreen=
this.Jc=function(){if(!1===h.xe()){var a=C;a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&("safari"===KolorEyes.env.browserName?a.webkitRequestFullScreen():a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT))}else document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()};this.isShowingSource=this.qg=function(){return Ia};
this.toggleShowSource=this.Rg=function(){null!==ia&&h.Hg(!Ia)};this.setShowSource=this.Hg=function(a){Ia=a;null!==ia&&(ia.Hd(Ia),h.xb(),h.dispatchEvent(KolorEyesPlayer.a.Yb,Ia))};this.isFocused=this.Da=function(){return cb};this.getLocalMousePosition=this.Uh=function(){return db};this.loadVideo=this.wi=function(a,b,c){function d(){h.b("ready handler");h.removeEventListener(KolorEyesPlayer.a.bb,d);!0===gb&&null===Za&&(Za=new KolorEyesHostingSuggestUI(h));!0===Ja&&null===ja&&(!0===KolorEyes.env.isMobile?
h.Le(new KolorEyesPlayerUIMobile(h)):h.Le(new KolorEyesPlayerUI(h)),h.Ig(new KolorEyesSkinManager(h)));!0===Sa&&null===W&&(W=new KolorEyesHotspot.Manager(h,null),h.dispatchEvent(KolorEyesPlayer.a.kf));za=new KolorEyesKeyboardManager(h);if("ke"===ka){for(;Q.hasChildNodes();)Q.removeChild(Q.lastChild);var a=document.createElement("source");a.src=e;a.type=I.le();Q.appendChild(a);Q.load();null===ia&&(ia=new KolorEyesCoreSourceView(h),ia.F(),ra.push(ia))}else"kr"===ka&&S(e);Ka=new KolorEyesContextMenu(h);
b&&b();ab(!0,I.kd());Ob(KolorEyesPlayer.Fa.Sc)}if(!1===eb)return console.error("You can't load a video before player initialization, call the init function yourself, or set autoInit to true in your configuration"),!1;I=new KolorEyesVideo.Oc(h);var e=I.load(a);h.addEventListener(KolorEyesPlayer.a.bb,d);"undefined"!=typeof c&&(Ga=c);ka="ke"===Ga||"kr"===Ga?Ga:Pb();"ke"===ka?$b():"kr"===ka&&ga();La=new KolorEyesInputActivity(h)};this.loadHotspots=this.vi=function(a){ha("loadHotspots");if(null===W)throw"ERROR @ KolorEyesPlayer:loadHotspots  Cant load hotspots, hotspotManager is null !";
W.tg(a)};this.loadSkin=this.vd=function(a){if(null===Ha)throw"ERROR @ KolorEyesPlayer:loadSkin  Cant load skin, _skinManager is null !";Ha.vd(a)};this.loadContextMenu=this.ui=function(a){null!=Ka&&Ka.vg(a)};this.getCoreType=this.hd=function(){if("auto"!=Ga)return Ga;""===ka&&(ka=Pb());return ka};this.getPlayerCore=this.me=function(){return z};this.getViews=this.Cb=function(){return ra};this.getInstanceId=this.eb=function(){return Ya};this.isReady=this.ze=function(){return Fa};this.isMetaDataLoaded=
this.qi=function(){return bb};this.getContainerId=this.Lf=function(){return la};this.getContainer=this.p=function(){return C};this.getVideoContainer=this.sc=function(){return Z};this.getVideo=this.u=function(){return Q};this.getVideoBitrate=this.qe=function(){return I.Kf()};this.getVideoFramerate=this.gg=function(){return I.pc()};this.getVideoCanvas=this.qa=function(){return sa};this.getCanvasContainer=this.ie=function(){return ea};this.getCanvas=this.ea=function(){return ua};this.getHotspotManager=
this.Lh=function(){return W};this.getPlayerUI=this.pa=function(){return ja};this.setPlayerUI=this.Le=function(a){ja=a};this.getSkinManager=this.ei=function(){return Ha};this.setSkinManager=this.Ig=function(a){Ha=a};this.getKeyboardManager=this.nd=function(){return za};this.getInputActivity=this.ke=function(){return La};this.getGyro=this.Nf=function(){if(null!=Ca)return Ca};this.enableGyro=this.fe=function(){null===Ca&&(Ca=new KolorEyesGyro(h));Ca.enable()};this.disableGyro=this.Hf=function(){null!==
Ca&&Ca.disable()};this.toggleGyro=this.Pg=function(){!0===h.ye()?h.Hf():h.fe()};this.isGyroEnabled=this.ye=function(){return null===Ca?!1:Ca.isEnabled()};this.getGesture=this.Kh=function(){if(null!=Da)return Da};this.enableGesture=this.ee=function(){null===Da&&(Da=new KolorEyesGesture(h));Da.enable()};this.disableGesture=this.Gf=function(){null!==Da&&Da.disable()};this.toggleGesture=this.dj=function(){!0===h.pg()?h.Gf():h.ee()};this.isGestureEnabled=this.pg=function(){return null===Da?!1:Da.isEnabled()};
this.onEnded=this.zd=function(){h.Mb(0);h.dispatchEvent(KolorEyesPlayer.a.Ma)};this.onLoadedMetaData=this.Ad=function(){h.b("onLoadedMetaData handler");bb=!0;h.dispatchEvent(KolorEyesPlayer.a.ua)};this.getProjection=this.G=function(){return Xa};this.playAt=this.xg=function(a){h.Mb(a);h.play()};this.stepCamera=this.Re=function(a,b,c,d,e){var f=h.C(),g=h.t();switch(a){case KolorEyesPlayer.Y.cd:ya&&ya.cancel();ya=new KolorEyesCoreEasing;ya.ga(h.t,h.jb,g-b,c,d,function(){ya=null;e&&e()});break;case KolorEyesPlayer.Y.Wb:ya&&
ya.cancel();ya=new KolorEyesCoreEasing;ya.ga(h.t,h.jb,g+b,c,d,function(){ya=null;e&&e()});break;case KolorEyesPlayer.Y.Ya:xa&&xa.cancel();xa=new KolorEyesCoreEasing;xa.ga(h.C,h.Me,f-b,c,d,function(){xa=null;e&&e()});break;case KolorEyesPlayer.Y.kc:xa&&xa.cancel(),xa=new KolorEyesCoreEasing,xa.ga(h.C,h.Me,f+b,c,d,function(){xa=null;e&&e()})}};this.setTitle=this.Ga=function(a){!1!==Ja&&null!==ja&&h.pa().Ga(a)};this.setDisplayDevice=this.ta=function(a){if("kr"==ka)h.b("Display device not supported with KrPano core player");
else return a===KolorEyesPlayer.Z.Ka&&h.A(79),z.ta(a)};this.getDisplayDevice=this.oa=function(){return"kr"==ka?(h.b("Display device not supported with KrPano core player"),null):z.oa()};this.toggleDisplayDevice=this.Og=function(){"kr"==ka?h.b("Display device not supported with KrPano core player"):h.oa()===KolorEyesPlayer.Z.Ka?h.ta(KolorEyesPlayer.Z.xf):h.ta(KolorEyesPlayer.Z.Ka)};this.isIdle=this.oi=function(){return La.uc};this.dispatchEvent=this.dispatchEvent=function(a,b){if(Ba[a])for(var c={player:h,
type:a,data:b||null},d=Ba[a],e=d.length;e--;)if("function"===typeof d[e])d[e](c);else console.warn("A listener callback is undefined for "+a+" event type")};this.addEventListener=this.addEventListener=function(a,b){Ba[a]=Ba[a]||[];Ba[a]&&Ba[a].push(b)};this.removeEventListener=this.removeEventListener=function(a,b){if(Ba[a])for(var c=Ba[a],d=c.length-1;0<=d;--d)if(c[d]===b)return c.splice(d,1),!0;return!1};this.getVersion=this.Bb=function(){return KolorEyes.version};!0===fb&&h.F()};
KolorEyesPlayer.prototype=new KolorEyesNamedObject;KolorEyesPlayer.prototype.n="Player";KolorEyesPlayer.prototype.debug=!1;KolorEyesPlayer.Fa={};KolorEyesPlayer.qualityMode=KolorEyesPlayer.Fa;KolorEyesPlayer.Fa.Ve=0;KolorEyesPlayer.qualityMode.AUTO=KolorEyesPlayer.Fa.Ve;KolorEyesPlayer.Fa.Sc=1;KolorEyesPlayer.qualityMode.MANUAL=KolorEyesPlayer.Fa.Sc;KolorEyesPlayer.c={};KolorEyesPlayer.stats=KolorEyesPlayer.c;KolorEyesPlayer.c.nh=.3;KolorEyesPlayer.stats.MAX_DROPPED_FRAMES_RATIO=KolorEyesPlayer.c.nh;
KolorEyesPlayer.c.mh=4;KolorEyesPlayer.stats.FRAME_DURATION=KolorEyesPlayer.c.mh;KolorEyesPlayer.a={};KolorEyesPlayer.events=KolorEyesPlayer.a;KolorEyesPlayer.a.bb="onReady";KolorEyesPlayer.events.ON_READY=KolorEyesPlayer.a.bb;KolorEyesPlayer.a.fa="onPlay";KolorEyesPlayer.events.ON_PLAY=KolorEyesPlayer.a.fa;KolorEyesPlayer.a.da="onPause";KolorEyesPlayer.events.ON_PAUSE=KolorEyesPlayer.a.da;KolorEyesPlayer.a.fc="onVolumeChange";KolorEyesPlayer.events.ON_VOLUME_CHANGE=KolorEyesPlayer.a.fc;
KolorEyesPlayer.a.Ma="onEnded";KolorEyesPlayer.events.ON_ENDED=KolorEyesPlayer.a.Ma;KolorEyesPlayer.a.ma="onTimeUpdate";KolorEyesPlayer.events.ON_TIME_UPDATE=KolorEyesPlayer.a.ma;KolorEyesPlayer.a.ua="onLoadedMetaData";KolorEyesPlayer.events.ON_LOADED_META_DATA=KolorEyesPlayer.a.ua;KolorEyesPlayer.a.sf="onVideoError";KolorEyesPlayer.events.ON_VIDEO_ERROR=KolorEyesPlayer.a.sf;KolorEyesPlayer.a.$a="onProgress";KolorEyesPlayer.events.ON_PROGRESS=KolorEyesPlayer.a.$a;KolorEyesPlayer.a.rf="onProjectionChangeRequest";
KolorEyesPlayer.events.ON_PROJECTION_CHANGE_REQUEST=KolorEyesPlayer.a.rf;KolorEyesPlayer.a.ab="onProjectionChange";KolorEyesPlayer.events.ON_PROJECTION_CHANGE=KolorEyesPlayer.a.ab;KolorEyesPlayer.a.th="onFovChange";KolorEyesPlayer.events.ON_FOV_CHANGED=KolorEyesPlayer.a.th;KolorEyesPlayer.a.dc="onSeek";KolorEyesPlayer.events.ON_SEEK=KolorEyesPlayer.a.dc;KolorEyesPlayer.a.Uc="onFullScreenEnter";KolorEyesPlayer.events.ON_FULLSCREEN_ENTER=KolorEyesPlayer.a.Uc;KolorEyesPlayer.a.Vc="onFullScreenExit";
KolorEyesPlayer.events.ON_FULLSCREEN_EXIT=KolorEyesPlayer.a.Vc;KolorEyesPlayer.a.xh="onVideoParamsLoaded";KolorEyesPlayer.events.ON_VIDEO_PARAMS_LOADED=KolorEyesPlayer.a.xh;KolorEyesPlayer.a.kf="onHotspotManagerReady";KolorEyesPlayer.events.ON_HOTSPOT_MANAGER_READY=KolorEyesPlayer.a.kf;KolorEyesPlayer.a.df="onHotspotAdded";KolorEyesPlayer.events.ON_HOTSPOT_ADDED=KolorEyesPlayer.a.df;KolorEyesPlayer.a.nf="onHotspotRemoved";KolorEyesPlayer.events.ON_HOTSPOT_REMOVED=KolorEyesPlayer.a.nf;
KolorEyesPlayer.a.ff="onHotspotCreated";KolorEyesPlayer.events.ON_HOTSPOT_CREATED=KolorEyesPlayer.a.ff;KolorEyesPlayer.a.rb="onHotspotEdited";KolorEyesPlayer.events.ON_HOTSPOT_EDITED=KolorEyesPlayer.a.rb;KolorEyesPlayer.a.of="onHotspotSelected";KolorEyesPlayer.events.ON_HOTSPOT_SELECTED=KolorEyesPlayer.a.of;KolorEyesPlayer.a.Ud="onHotspotRenamed";KolorEyesPlayer.events.ON_HOTSPOT_RENAMED=KolorEyesPlayer.a.Ud;KolorEyesPlayer.a.gf="onHotspotDragged";KolorEyesPlayer.events.ON_HOTSPOT_DRAGGED=KolorEyesPlayer.a.gf;
KolorEyesPlayer.a.pf="onHotspotShow";KolorEyesPlayer.events.ON_HOTSPOT_SHOW=KolorEyesPlayer.a.pf;KolorEyesPlayer.a.hf="onHotspotHide";KolorEyesPlayer.events.ON_HOTSPOT_HIDE=KolorEyesPlayer.a.hf;KolorEyesPlayer.a.ef="onHotspotClick";KolorEyesPlayer.events.ON_HOTSPOT_CLICK=KolorEyesPlayer.a.ef;KolorEyesPlayer.a.mf="onHotspotOver";KolorEyesPlayer.events.ON_HOTSPOT_OVER=KolorEyesPlayer.a.mf;KolorEyesPlayer.a.lf="onHotspotOut";KolorEyesPlayer.events.ON_HOTSPOT_OUT=KolorEyesPlayer.a.lf;
KolorEyesPlayer.a.jf="onHotspotHitKF";KolorEyesPlayer.events.ON_HOTSPOT_HIT_KF=KolorEyesPlayer.a.jf;KolorEyesPlayer.a.qf="onMouseOver";KolorEyesPlayer.events.ON_MOUSE_OVER=KolorEyesPlayer.a.qf;KolorEyesPlayer.a.Zc="onMouseOut";KolorEyesPlayer.events.ON_MOUSE_OUT=KolorEyesPlayer.a.Zc;KolorEyesPlayer.a.ub="onMouseDown";KolorEyesPlayer.events.ON_MOUSE_DOWN=KolorEyesPlayer.a.ub;KolorEyesPlayer.a.Q="onMouseUp";KolorEyesPlayer.events.ON_MOUSE_UP=KolorEyesPlayer.a.Q;KolorEyesPlayer.a.vb="onMouseMove";
KolorEyesPlayer.events.ON_MOUSE_MOVE=KolorEyesPlayer.a.vb;KolorEyesPlayer.a.cc="onMouseWheel";KolorEyesPlayer.events.ON_MOUSE_WHEEL=KolorEyesPlayer.a.cc;KolorEyesPlayer.a.bc="onKeyDown";KolorEyesPlayer.events.ON_KEY_DOWN=KolorEyesPlayer.a.bc;KolorEyesPlayer.a.Vd="onKeyUp";KolorEyesPlayer.events.ON_KEY_UP=KolorEyesPlayer.a.Vd;KolorEyesPlayer.a.Yc="onGyroEnabled";KolorEyesPlayer.events.ON_GYRO_ENABLED=KolorEyesPlayer.a.Yc;KolorEyesPlayer.a.Xc="onGyroDisabled";
KolorEyesPlayer.events.ON_GYRO_DISABLED=KolorEyesPlayer.a.Xc;KolorEyesPlayer.a.Tc="onDisplayDeviceChanged";KolorEyesPlayer.events.ON_DISPLAY_DEVICE_CHANGED=KolorEyesPlayer.a.Tc;KolorEyesPlayer.a.Yb="onDisplaySourceChanged";KolorEyesPlayer.events.ON_DISPLAY_SOURCE_CHANGED=KolorEyesPlayer.a.Yb;KolorEyesPlayer.a.Wd="onVideoConfigLoaded";KolorEyesPlayer.events.ON_VIDEO_CONFIG_LOADED=KolorEyesPlayer.a.Wd;KolorEyesPlayer.a.tf="onVideoQualityModeChanged";
KolorEyesPlayer.events.ON_VIDEO_QUALITY_MODE_CHANGED=KolorEyesPlayer.a.tf;KolorEyesPlayer.a.$c="onVideoQualityRequest";KolorEyesPlayer.events.ON_VIDEO_QUALITY_REQUEST=KolorEyesPlayer.a.$c;KolorEyesPlayer.a.ec="onVideoQualityChanged";KolorEyesPlayer.events.ON_VIDEO_QUALITY_CHANGED=KolorEyesPlayer.a.ec;KolorEyesPlayer.a.uf="onVideoSpeedChanged";KolorEyesPlayer.events.ON_VIDEO_SPEED_CHANGED=KolorEyesPlayer.a.uf;KolorEyesPlayer.a.sb="onIdleEnter";KolorEyesPlayer.events.ON_IDLE_ENTER=KolorEyesPlayer.a.sb;
KolorEyesPlayer.a.tb="onIdleExit";KolorEyesPlayer.events.ON_IDLE_EXIT=KolorEyesPlayer.a.tb;KolorEyesPlayer.a.cf="onGestureEnabled";KolorEyesPlayer.events.ON_GESTURE_ENABLED=KolorEyesPlayer.a.cf;KolorEyesPlayer.a.bf="onGestureDisabled";KolorEyesPlayer.events.ON_GESTURE_DISABLED=KolorEyesPlayer.a.bf;KolorEyesPlayer.a.qb="onGestureTap";KolorEyesPlayer.events.ON_GESTURE_TAP=KolorEyesPlayer.a.qb;KolorEyesPlayer.a.qb="onGestureTap";KolorEyesPlayer.events.ON_GESTURE_TAP=KolorEyesPlayer.a.qb;
KolorEyesPlayer.a.Wc="onGestureDoubleTap";KolorEyesPlayer.events.ON_GESTURE_DOUBLE_TAP=KolorEyesPlayer.a.Wc;KolorEyesPlayer.a.ac="onGesturePinchStart";KolorEyesPlayer.events.ON_GESTURE_PINCH_START=KolorEyesPlayer.a.ac;KolorEyesPlayer.a.$b="onGesturePinchMove";KolorEyesPlayer.events.ON_GESTURE_PINCH_MOVE=KolorEyesPlayer.a.$b;KolorEyesPlayer.a.Zb="onGesturePinchEnd";KolorEyesPlayer.events.ON_GESTURE_PINCH_END=KolorEyesPlayer.a.Zb;KolorEyesPlayer.a.vh="onGesturePanStart";
KolorEyesPlayer.events.ON_GESTURE_PINCH_START=KolorEyesPlayer.a.ac;KolorEyesPlayer.a.Td="onGesturePanMove";KolorEyesPlayer.events.ON_GESTURE_PINCH_MOVE=KolorEyesPlayer.a.$b;KolorEyesPlayer.a.uh="onGesturePanEnd";KolorEyesPlayer.events.ON_GESTURE_PINCH_END=KolorEyesPlayer.a.Zb;KolorEyesPlayer.d={};KolorEyesPlayer.projections=KolorEyesPlayer.d;KolorEyesPlayer.d.T="spherical";KolorEyesPlayer.projections.SPHERICAL=KolorEyesPlayer.d.T;KolorEyesPlayer.d.I="planar";KolorEyesPlayer.projections.PLANAR=KolorEyesPlayer.d.I;
KolorEyesPlayer.d.na="panini";KolorEyesPlayer.projections.PANINI=KolorEyesPlayer.d.na;KolorEyesPlayer.d.la="littlePlanet";KolorEyesPlayer.projections.LITTLE_PLANET=KolorEyesPlayer.d.la;KolorEyesPlayer.d.ka="fisheye";KolorEyesPlayer.projections.FISHEYE=KolorEyesPlayer.d.ka;KolorEyesPlayer.d.La="mirrorBall";KolorEyesPlayer.projections.MIRROR_BALL=KolorEyesPlayer.d.La;KolorEyesPlayer.Y={};KolorEyesPlayer.directions=KolorEyesPlayer.Y;KolorEyesPlayer.Y.cd="up";KolorEyesPlayer.directions.UP=KolorEyesPlayer.Y.cd;
KolorEyesPlayer.Y.kc="right";KolorEyesPlayer.directions.RIGHT=KolorEyesPlayer.Y.kc;KolorEyesPlayer.Y.Wb="down";KolorEyesPlayer.directions.DOWN=KolorEyesPlayer.Y.Wb;KolorEyesPlayer.Y.Ya="left";KolorEyesPlayer.directions.LEFT=KolorEyesPlayer.Y.Ya;KolorEyesPlayer.Z={};KolorEyesPlayer.displayDevice=KolorEyesPlayer.Z;KolorEyesPlayer.Z.xf="screen";KolorEyesPlayer.displayDevice.SCREEN=KolorEyesPlayer.Z.xf;KolorEyesPlayer.Z.Ka="hmd";KolorEyesPlayer.displayDevice.HMD=KolorEyesPlayer.Z.Ka;
KolorEyesPlayer.aa=[];KolorEyesPlayer.lg=0;KolorEyesPlayer.Wh=function(){return"kep_"+KolorEyesPlayer.lg};KolorEyesPlayer.Oi=function(c){null!==c.eb()&&(KolorEyesPlayer.aa.push(c),KolorEyesPlayer.lg++)};KolorEyesPlayer.ej=function(c){null!==c.eb()&&(c=KolorEyesPlayer.Pf(c.eb()),-1<c&&c<KolorEyesPlayer.aa.length&&KolorEyesPlayer.aa.splice(c,1))};KolorEyesPlayer.Pf=function(c){for(var b=-1,f=0,e=KolorEyesPlayer.aa.length;f<e;f++)if(KolorEyesPlayer.aa[f].eb()===c){b=f;break}return b};
KolorEyesPlayer.Qh=function(c){var b=null;c=KolorEyesPlayer.Pf(c);-1<c&&c<KolorEyesPlayer.aa.length&&(b=KolorEyesPlayer.aa[c]);return b};window.callKolorEyesPlayerFunction=function(c,b){KolorEyesPlayer.Qh(c)[b].apply(null,[].slice.call(arguments,2))};KolorEyesPlayerUI=function(c){function b(){l.ia=document.createElement("a");l.ia.className="fullScreenEnterBtn";l.appendChild(l.ia);l.ia.onclick=function(){!0!==R&&!1!==G.fullscreen&&u.Jc()};u.addEventListener(KolorEyesPlayer.a.Uc,function(){l.ia.className="fullScreenExitBtn"});u.addEventListener(KolorEyesPlayer.a.Vc,function(){l.ia.className="fullScreenEnterBtn"})}function f(a,b){for(var c=0,d,e=0,f=a.length;e<f;e++)d=a[e],d.name===b?(d.className="selected",c=e):d.className="";for(var g=a[0].parentNode,
e=0,k,f=0;f<=c;f++)d=a[f],k=window.getComputedStyle(d),e+=d.offsetWidth+parseFloat(k.marginLeft)+parseFloat(k.marginRight);e-=(d.offsetWidth+parseFloat(k.marginLeft)+parseFloat(k.marginRight))/2;(new KolorEyesCoreEasing).ga(function(){return parseFloat(g.style.paddingLeft||0)},function(a){g.style.paddingLeft=a+"px"},l.clientWidth/2-e,.5,KolorEyesCoreEasing.k.LINEAR,null)}function e(a){f(F,a);"undefined"!=typeof l.s&&(l.s.label.innerHTML=a)}function d(a){Y=!1;a.data.success&&(e(a.data.name),l.s.Jd.style.display=
"none")}function g(a){Y=!0;e(a.data.name);l.s.Jd.style.display="block"}function k(){var a=document.createElement("span");a.className="separatorUI";l.appendChild(a)}function a(){t.Bc();r.style.cursor="default"}function m(a,b){if("undefined"===typeof b||null===b)for(var c in G)G[c]=a;else if("string"===typeof b)void 0!==typeof G[b]&&(G[b]=a);else if("object"===typeof b)for(c in b)void 0!==typeof G[b[c]]&&(G[b[c]]=a)}function n(){return parseFloat(l.style.bottom||0)}function q(a){l.style.bottom=a+"px"}
function w(){T=!1}function p(b){1!=T&&(KolorEyesUtils.xa(b.data).y>u.p().clientHeight-130?a():1==u.w()&&!1===Y&&(t.Db(),r.style.cursor="none"))}function v(){u.ea().className="cursorIdle"}function x(){!1===H&&"safari"!==KolorEyes.env.browserName&&("undefined"!=typeof U.wc&&(U.wc.style.display="none"),"undefined"!=typeof l.U&&(l.U.style.display="none"))}function y(){}function E(){u.w()&&(t.Db(),r.style.cursor="none")}function L(){!0===u.qg()?f(A,"showSource"):f(A)}function M(){l.P.className="playBtn";
a()}function J(){l.P.className="pauseBtn";t.tc()}function K(){var a=u.Uf();if(!isNaN(a)){var b=u.eg();isNaN(b)||0===b||(l.h.hb.style.width=String(100*a/b)+"%")}}function O(){t.b("on onTimeUpdate UI");var a=u.Qa();if(!isNaN(a)){var b=u.za();if(!isNaN(b)&&0!==b){var c=KolorEyesUtils.Kb(a),d=KolorEyesUtils.M(c.Fb)+":"+KolorEyesUtils.M(c.Lb);0<c.Ca&&(d=KolorEyesUtils.M(c.Ca)+":"+d);l.D.currentTime.innerHTML=d;l.h.ib.style.width=String(100*a/b)+"%"}}}function N(){a();t.Cc()}function P(){t.b("onLoadedMetaData");
var a=KolorEyesUtils.Kb(u.za()),b=KolorEyesUtils.M(a.Fb)+":"+KolorEyesUtils.M(a.Lb);0<a.Ca&&(b=KolorEyesUtils.M(a.Ca)+":"+b);"undefined"!=typeof l.s&&(l.s.className="qualityBtn");l.D.totalTime.innerHTML=b;t.Ob()}var t=this,u=c,r=null,l=null,U=null,T=!1,Y=!1,B=1,H=!1,R=!0,D=null,G={splashScreen:!0,logo:!0,seek:!0,play:!0,volume:!0,fullscreen:!0,projection:!0,quality:!0,remote:!0},F=[],A=[];this.getBottomUI=this.he=function(){return l};this.setTitle=this.Ga=function(a){r.l.Qe.innerHTML=a};this.setAuthor=
this.Ui=function(a){r.l.Pe.innerHTML=a};this.showBottomUI=this.Bc=function(){T=!0;(new KolorEyesCoreEasing).ga(n,q,0,.1,KolorEyesCoreEasing.k.LINEAR,w)};this.hideBottomUI=this.Db=function(){T=!0;(new KolorEyesCoreEasing).ga(n,q,-60,.1,KolorEyesCoreEasing.k.LINEAR,w);"undefined"!=typeof U.wc&&(U.wc.style.display="none");"undefined"!=typeof l.U&&(l.U.style.display="none")};this.enableUI=this.ge=function(a){t.b("enableUI");m(!0,a)};this.disableUI=this.ce=function(a){t.b("disableUI");m(!1,a)};this.freezeUI=
this.gd=function(){R=!0};this.unfreezeUI=this.Ob=function(){R=!1};this.showUI=this.Id=function(){l.style.display="block"};this.isFocused=this.Da=function(){return H};this.hideUI=this.rd=function(){l.style.display="none"};this.hideLogo=this.ki=function(){r.ti.style.display="none"};this.showLogo=this.Mg=function(){r.ti.style.display="block"};this.showSplash=this.Cc=function(){r.l.style.display="block"};this.hideSplash=this.tc=function(){r.l.style.display="none"};this.f=function(){u.removeEventListener(KolorEyesPlayer.a.ua,
P);u.removeEventListener(KolorEyesPlayer.a.Ma,N);u.removeEventListener(KolorEyesPlayer.a.ma,O);u.removeEventListener(KolorEyesPlayer.a.$a,K);u.removeEventListener(KolorEyesPlayer.a.fa,J);u.removeEventListener(KolorEyesPlayer.a.da,M);u.removeEventListener(KolorEyesPlayer.a.ec,d);u.removeEventListener(KolorEyesPlayer.a.$c,g);u.removeEventListener(KolorEyesPlayer.a.Yb,L);u.removeEventListener(KolorEyesPlayer.a.sb,E);u.removeEventListener(KolorEyesPlayer.a.tb,y);u.removeEventListener(KolorEyesPlayer.a.ub,
x);u.removeEventListener(KolorEyesPlayer.a.Q,v);u.removeEventListener(KolorEyesPlayer.a.vb,p);null!==D&&(D.f(),D=null);t=u=l=r=null};t.b("KolorEyesPlayerUI init");r=u.p();l=document.createElement("div");l.id="playerBottomUI";U=document.createElement("div");U.id="playerMenuContainer";l.appendChild(U);(function(){function b(){l.onmouseover=null;l.onmouseout=c;H=!0;a()}function c(){l.onmouseout=null;l.onmouseover=b;H=!1}l.h=document.createElement("div");l.h.className="seekBarContainer";l.h.style.width=
"100%";l.appendChild(l.h);l.h.hb=document.createElement("div");l.h.hb.className="seekBarBuffer";l.h.appendChild(l.h.hb);l.h.ib=document.createElement("div");l.h.ib.className="seekBarTime";l.h.appendChild(l.h.ib);l.h.onclick=function(a){if(!0!==R&&!1!==G.seek){a=100*KolorEyesUtils.xa(a||window.event).x/r.clientWidth;var b=a*u.za()/100;"kr"===u.hd()&&a>parseInt(l.h.hb.style.width)||(t.b("seek click "+b),u.Mb(b),u.dispatchEvent(KolorEyesPlayer.a.dc))}};l.onmouseover=b})();u.ea().className="cursorIdle";
(function(){l.P=document.createElement("a");l.P.className="playBtn";l.appendChild(l.P);l.P.onclick=function(){!0!==R&&!1!==G.play&&u.Kc()}})();(function(){function a(b){t.b("volume mouse wheel");if(!0!==R&&!1!==G.volume){t.b("volumeWheelHandler");var c=u.ra(),d=0;b=b||window.event;b.wheelDelta?(d=b.wheelDelta/120,window.opera&&(d=-d)):b.detail&&(d=-b.detail/3);d&&0<d?c+=.1:d&&0>d&&(c-=.1);0>c?c=0:1<c&&(c=1);u.Nb(c)}}function b(){t.b("volume mouse up");l.c.K.onmousemove=null;u.removeEventListener(KolorEyesPlayer.a.Q,
b)}function c(a){t.b("volume mouse down");!0!==R&&!1!==G.volume&&(a=a||window.event,l.c.K.onmousedown=c,u.addEventListener(KolorEyesPlayer.a.Q,b),d(a),l.c.K.onmousemove=d)}function d(a){a=a||window.event;a.stopPropagation?a.stopPropagation():a.returnValue=!1;var b=a.currentTarget||a.srcElement;if("volumeBarContainer"===b.className||"volumeBar"===b.className)a=KolorEyesUtils.xa(a).x/l.c.K.clientWidth,.95<a?a=1:.05>a&&(a=0),u.Nb(a)}function e(){"undefined"==typeof l.c.ha&&(l.c.ha=0);l.c.ha+=.2;var a=
l.c.clientWidth,a=80*(1-Math.pow(l.c.ha,2))+35;35>a?(l.c.style.width="35px",l.c.ha=0,l.c.interval=window.clearInterval(l.c.interval)):l.c.style.width=a+"px"}function f(){"undefined"==typeof l.c.ha&&(l.c.ha=0);l.c.ha+=.2;var a=l.c.clientWidth,a=70*Math.pow(l.c.ha,2)+35;105<a?(l.c.style.width="105px",l.c.ha=0,l.c.interval=window.clearInterval(l.c.interval)):l.c.style.width=a+"px"}l.c=document.createElement("div");l.c.className="volumeContainer";l.appendChild(l.c);l.c.Od=document.createElement("a");
l.c.Od.className="volumeTwoBtn";l.c.appendChild(l.c.Od);l.c.K=document.createElement("div");l.c.K.className="volumeBarContainer";l.c.appendChild(l.c.K);l.c.K.lb=document.createElement("div");l.c.K.lb.className="volumeBar";l.c.K.appendChild(l.c.K.lb);l.c.K.lb.$e=document.createElement("div");l.c.K.lb.$e.className="volumePicker";l.c.K.lb.appendChild(l.c.K.lb.$e);u.addEventListener(KolorEyesPlayer.a.fc,function(){var a=u.ra(),b=l.c.K.clientWidth*a;.95<a?b=l.c.K.clientWidth:.05>a&&(b=0);l.c.K.lb.style.width=
b+"px";a=u.ra();l.c.Od.className=0==a?"volumeMuteBtn":0<a&&.5>=a?"volumeOneBtn":"volumeTwoBtn"});l.c.onmouseover=function(a){a=a||window.event;for(a=a.fromElement||a.relatedTarget;a&&a.parentNode&&a.parentNode!=window;){if(a.parentNode==this||a==this)return a.preventDefault&&a.preventDefault(),!1;a=a.parentNode}l.c.interval=window.clearInterval(l.c.interval);l.c.interval=window.setInterval(f,1E3/30)};l.c.onmouseout=function(a){a=a||window.event;for(a=a.toElement||a.relatedTarget;a&&a.parentNode&&
a.parentNode!=window;){if(a.parentNode==this||a==this)return a.preventDefault&&a.preventDefault(),!1;a=a.parentNode}l.c.interval=window.clearInterval(l.c.interval);l.c.interval=window.setInterval(e,1E3/30)};l.c.Od.onclick=function(){t.b("volume mouse click");!0!==R&&!1!==G.volume&&(0===u.ra()?u.Nb(B):(B=u.ra(),u.Nb(0)))};l.c.K.onmousedown=c;"firefox"===KolorEyes.env.browserName?l.c.addEventListener("DOMMouseScroll",a,!1):l.c.onmousewheel=a})();(function(){l.D=document.createElement("div");l.D.className=
"timeContainer";l.D.currentTime=document.createElement("span");l.D.currentTime.innerHTML="00:00";l.D.currentTime.className="currentTime";l.D.Ye=document.createElement("span");l.D.Ye.innerHTML="/";l.D.totalTime=document.createElement("span");l.D.totalTime.className="totalTime";l.appendChild(l.D);l.D.appendChild(l.D.currentTime);l.D.appendChild(l.D.Ye);l.D.appendChild(l.D.totalTime);var a=KolorEyesUtils.Kb(u.za());l.D.totalTime.innerHTML=KolorEyesUtils.M(a.Ca)+":"+KolorEyesUtils.M(a.Fb)+":"+KolorEyesUtils.M(a.Lb)})();
"msie"!==KolorEyes.env.browserName&&b();k();(function(){function a(){if(!0!==R&&!1!==G.quality){var b=l.U.style.display;""==b||"none"==b?("undefined"!=typeof U.wc&&(U.wc.style.display="none"),l.U.style.display="block"):l.U.style.display="none"}}var b=u.Ua(),c=b.length;if(1<c){l.s=document.createElement("div");l.s.className="qualityBtn";l.appendChild(l.s);l.s.Jd=document.createElement("div");l.s.Jd.className="qualitySpinner";l.s.appendChild(l.s.Jd);l.s.label=document.createElement("a");l.s.label.className=
"qualityLabel";l.s.appendChild(l.s.label);l.s.onclick=a;l.U=document.createElement("ul");l.U.className="menu";U.appendChild(l.U);for(var d=0;d<c;d++)liPreset=document.createElement("li"),liPreset.innerHTML=b[d].name,liPreset.name=b[d].name,liPreset.yg=d,liPreset.onclick=function(){!0!==Y&&u.hg()!==this.yg&&(u.Lg(KolorEyesPlayer.Fa.Sc),u.Ac(this.yg))},l.U.appendChild(liPreset),F.push(liPreset)}})();k();(function(){r.l=document.createElement("div");r.l.className="kolorEyesSplashScreen";r.appendChild(r.l);
r.l.onclick=function(){!0!==R&&!1!==G.splashScreen&&u.play()};var a=u.Pa("posterURL");"undefined"!=typeof a&&null!==a&&(r.l.poster=document.createElement("div"),r.l.poster.className="splashPoster",r.l.appendChild(r.l.poster),"chromeApp"===KolorEyes.env.context?function(a){var b=KolorEyesHostingAPI.sa();b.responseType="blob";b.onload=function(){var a=window.URL.createObjectURL(b.response);r.l.poster.style.backgroundImage="url("+a+")"};b.open("GET",a,!0);b.send()}(a):r.l.poster.style.backgroundImage=
"url("+u.Pa("posterURL")+")");r.l.Qe=document.createElement("p");r.l.Qe.className="splashTitle";r.l.appendChild(r.l.Qe);r.l.Pe=document.createElement("p");r.l.Pe.className="splashAuthor";r.l.appendChild(r.l.Pe)})();r.appendChild(l);u.addEventListener(KolorEyesPlayer.a.ua,P);u.addEventListener(KolorEyesPlayer.a.Ma,N);u.addEventListener(KolorEyesPlayer.a.ma,O);u.addEventListener(KolorEyesPlayer.a.$a,K);u.addEventListener(KolorEyesPlayer.a.fa,J);u.addEventListener(KolorEyesPlayer.a.da,M);u.addEventListener(KolorEyesPlayer.a.ec,
d);u.addEventListener(KolorEyesPlayer.a.$c,g);u.addEventListener(KolorEyesPlayer.a.Yb,L);u.addEventListener(KolorEyesPlayer.a.sb,E);u.addEventListener(KolorEyesPlayer.a.tb,y);u.addEventListener(KolorEyesPlayer.a.ub,x);u.addEventListener(KolorEyesPlayer.a.Q,v);u.addEventListener(KolorEyesPlayer.a.vb,p)};KolorEyesPlayerUI.prototype=new KolorEyesNamedObject;KolorEyesPlayerUI.prototype.n="PlayerUI";KolorEyesPlayerUI.prototype.debug=!1;KolorEyesPlayerUIMobile=function(c){function b(){var a=l.P.clientWidth,b=parseInt(window.getComputedStyle(l.P)["margin-left"]),c=parseInt(window.getComputedStyle(l.P)["margin-right"]),d=l.Ea.clientWidth,e=parseInt(window.getComputedStyle(l.Ea)["margin-left"]),f=parseInt(window.getComputedStyle(l.Ea)["margin-right"]);return t.p().clientWidth-2*(a+b+c+d+e+f)}function f(){P.Ng();P.Bc();u.style.cursor="default"}function e(a,b){if("undefined"===typeof b||null===b)for(var c in H)H[c]=a;else if("string"===
typeof b)void 0!==typeof H[b]&&(H[b]=a);else if("object"===typeof b)for(c in b)void 0!==typeof H[b[c]]&&(H[b[c]]=a)}function d(){l.h.style.width=b()+"px"}function g(a){var b=t.C()+10*a.data.velocityX;a=t.t()+10*a.data.velocityY;t.ba(b,a)}function k(){B=null}function a(a){t.A(1*B/a.data.scale)}function m(){B=t.r()}function n(){t.Jc()}function q(){!0===Y?P.rd():P.Id()}function w(){r.xc.className="gyroBtn-off"}function p(){r.xc.className="gyroBtn-on"}function v(a){a.data===KolorEyesPlayer.Z.Ka?(r.Gc.className=
"hmdBtn-on",r.e.style.display="none",r.Sb.style.display="none",t.fe()):(r.Gc.className="hmdBtn-off",r.Sb.style.display="block")}function x(){f()}function y(){t.w()&&(P.Db(),u.style.cursor="none")}function E(){for(var a=t.G(),b=0,c=R.length;b<c;b++)li=R[b],li.className=li.name===a?"selected":""}function L(){l.P.className="playBtn";f()}function M(){l.P.className="pauseBtn";P.tc()}function J(){}function K(){P.b("on onTimeUpdate UI");var a=t.Qa();if(!isNaN(a)){var b=t.za();if(!isNaN(b)&&0!==b){var c=
KolorEyesUtils.Kb(a),d=KolorEyesUtils.M(c.Fb)+":"+KolorEyesUtils.M(c.Lb);0<c.Ca&&(d=KolorEyesUtils.M(c.Ca)+":"+d);l.Ea.innerHTML=d;l.h.ib.style.width=String(100*a/b)+"%"}}}function O(){f();P.Cc()}function N(){P.b("onLoadedMetaData");var a=KolorEyesUtils.Kb(t.za()),b=KolorEyesUtils.M(a.Fb)+":"+KolorEyesUtils.M(a.Lb);0<a.Ca&&(b=KolorEyesUtils.M(a.Ca)+":"+b);"undefined"!=typeof l.s&&(l.s.className="qualityBtn qualityBtnReady");l.Jb.innerHTML=b;P.Ob()}var P=this,t=c,u=null,r=null,l=null,U=0,T=!0,Y=!0,
B=null,H={splashScreen:!0,logo:!0,seek:!0,play:!0,volume:!0,fullscreen:!0,projection:!0,quality:!0},R=[];this.getBottomUI=this.he=function(){return l};this.setTitle=this.Ga=function(a){r.Ze.innerHTML=a};this.showTopUI=this.Ng=function(){r.style.top="0px"};this.hideTopUI=this.li=function(){};this.showBottomUI=this.Bc=function(){l.style.bottom="0px"};this.hideBottomUI=this.Db=function(){"undefined"!=typeof l.e&&(l.e.style.display="none");"undefined"!=typeof l.U&&(l.U.style.display="none")};this.enableUI=
this.ge=function(a){P.b("enableUI");e(!0,a)};this.disableUI=this.ce=function(a){P.b("disableUI");e(!1,a)};this.freezeUI=this.gd=function(){T=!0};this.unfreezeUI=this.Ob=function(){T=!1};this.showUI=this.Id=function(){r.style.display="block";l.style.display="block";Y=!0};this.isFocused=this.Da=function(){return!1};this.hideUI=this.rd=function(){r.style.display="none";l.style.display="none";Y=!1};this.showSplash=this.Cc=function(){u.l.style.display="block"};this.hideSplash=this.tc=function(){u.l.style.display=
"none"};this.f=function(){t.removeEventListener(KolorEyesPlayer.a.ua,N);t.removeEventListener(KolorEyesPlayer.a.Ma,O);t.removeEventListener(KolorEyesPlayer.a.ma,K);t.removeEventListener(KolorEyesPlayer.a.$a,J);t.removeEventListener(KolorEyesPlayer.a.fa,M);t.removeEventListener(KolorEyesPlayer.a.da,L);t.removeEventListener(KolorEyesPlayer.a.ab,E);t.removeEventListener(KolorEyesPlayer.a.sb,y);t.removeEventListener(KolorEyesPlayer.a.tb,x);t.removeEventListener(KolorEyesPlayer.a.Tc,v);t.removeEventListener(KolorEyesPlayer.a.Yc,
p);t.removeEventListener(KolorEyesPlayer.a.Xc,w);t.removeEventListener(KolorEyesPlayer.a.qb,q);t.removeEventListener(KolorEyesPlayer.a.Wc,n);t.removeEventListener(KolorEyesPlayer.a.ac,m);t.removeEventListener(KolorEyesPlayer.a.$b,a);t.removeEventListener(KolorEyesPlayer.a.Zb,k);t.removeEventListener(KolorEyesPlayer.a.Td,g);window.removeEventListener("deviceorientation",d,!1);P=t=l=r=u=null};P.b("KolorEyesPlayerUI init");u=t.p();r=document.createElement("div");r.id="playerTopUIMobile";r.Ze=document.createElement("p");
r.appendChild(r.Ze);l=document.createElement("div");l.id="playerBottomUIMobile";u.appendChild(r);u.appendChild(l);(function(){l.P=document.createElement("a");l.P.className="playBtn";l.appendChild(l.P);l.P.onclick=function(){!0!==T&&!1!==H.play&&t.Kc()}})();l.Ea=document.createElement("div");l.Ea.className="timeCurrent";l.Ea.innerHTML="00:00";l.appendChild(l.Ea);U=l.Ea.clientWidth;l.Ea.style.width=U+"px";(function(){l.h=document.createElement("div");l.h.className="seekBarContainer";l.h.style.width=
b()+"px";l.appendChild(l.h);l.h.hb=document.createElement("div");l.h.hb.className="seekBarBuffer";l.h.appendChild(l.h.hb);l.h.ib=document.createElement("div");l.h.ib.className="seekBarTime";l.h.appendChild(l.h.ib);l.h.onclick=function(a){!0!==T&&!1!==H.seek&&(a=100*KolorEyesUtils.xa(a||window.event).x/l.h.clientWidth*t.za()/100,P.b("seek click "+a),t.Mb(a),t.dispatchEvent(KolorEyesPlayer.a.dc))}})();(function(){l.Jb=document.createElement("div");l.Jb.className="timeTotal";l.Jb.innerHTML="00:00";l.appendChild(l.Jb);
l.Jb.style.width=U+"px";var a=KolorEyesUtils.Kb(t.za());l.Jb.innerHTML=KolorEyesUtils.M(a.Fb)+":"+KolorEyesUtils.M(a.Lb)})();(function(){l.ia=document.createElement("a");l.ia.className="fullscreen-enter";l.appendChild(l.ia);l.ia.onclick=function(){!0!==T&&!1!==H.fullscreen&&t.Jc()};t.addEventListener(KolorEyesPlayer.a.Uc,function(){l.ia.className="fullscreen-exit"});t.addEventListener(KolorEyesPlayer.a.Vc,function(){l.ia.className="fullscreen-enter"})})();(function(){function a(){if(!0!==T&&!1!==
H.projection){var b=r.e.style.display;r.e.style.display=""==b||"none"==b?"block":"none"}}r.Sb=document.createElement("a");r.Sb.className="projectionBtn";r.appendChild(r.Sb);r.Sb.onclick=a;r.e=document.createElement("ul");r.e.className="menu";r.appendChild(r.e);!0===t.fb(KolorEyesPlayer.d.T)&&(r.e.Vb=document.createElement("li"),r.e.Vb.innerHTML="Source",r.e.Vb.name=KolorEyesPlayer.d.T,r.e.Vb.onclick=function(){t.H(KolorEyesPlayer.d.T);a()},r.e.appendChild(r.e.Vb),R.push(r.e.Vb));!0===t.fb(KolorEyesPlayer.d.I)&&
(r.e.Rb=document.createElement("li"),r.e.Rb.innerHTML="Rectilinear",r.e.Rb.name=KolorEyesPlayer.d.I,r.e.Rb.onclick=function(){t.H(KolorEyesPlayer.d.I);a()},r.e.appendChild(r.e.Rb),R.push(r.e.Rb));!0===t.fb(KolorEyesPlayer.d.na)&&(r.e.Qb=document.createElement("li"),r.e.Qb.innerHTML="Panini",r.e.Qb.name=KolorEyesPlayer.d.na,r.e.Qb.onclick=function(){t.H(KolorEyesPlayer.d.na);a()},r.e.appendChild(r.e.Qb),R.push(r.e.Qb));!0===t.fb(KolorEyesPlayer.d.la)&&(r.e.Lc=document.createElement("li"),r.e.Lc.innerHTML=
"Little Planet",r.e.Lc.name=KolorEyesPlayer.d.la,r.e.Lc.onclick=function(){t.H(KolorEyesPlayer.d.la);a()},r.e.appendChild(r.e.Lc),R.push(r.e.Lc));!0===t.fb(KolorEyesPlayer.d.ka)&&(r.e.vc=document.createElement("li"),r.e.vc.innerHTML="Fisheye",r.e.vc.name=KolorEyesPlayer.d.ka,r.e.vc.onclick=function(){t.H(KolorEyesPlayer.d.ka);a()},r.e.appendChild(r.e.vc),R.push(r.e.vc));!0===t.fb(KolorEyesPlayer.d.La)&&(r.e.Mc=document.createElement("li"),r.e.Mc.innerHTML="Mirror Ball",r.e.Mc.name=KolorEyesPlayer.d.La,
r.e.Mc.onclick=function(){t.H(KolorEyesPlayer.d.La);a()},r.e.appendChild(r.e.Mc),R.push(r.e.Mc))})();(function(){r.Gc=document.createElement("a");r.Gc.className="hmdBtn-off";r.appendChild(r.Gc);r.Gc.onclick=function(){t.Og()}})();(function(){r.xc=document.createElement("a");r.xc.className="gyroBtn-off";r.appendChild(r.xc);r.xc.onclick=function(){t.Pg()}})();(function(){u.l=document.createElement("div");u.l.className="kolorEyesSplashScreen";u.appendChild(u.l);u.l.onclick=function(){!0!==T&&!1!==H.splashScreen&&
(t.Jc(),t.play())};null!==t.Pa("posterURL")&&(u.l.poster=document.createElement("div"),u.l.poster.className="splashPoster",u.l.appendChild(u.l.poster),u.l.poster.style.backgroundImage="url("+t.Pa("posterURL")+")");u.l.Xe=document.createElement("div");u.l.Xe.className="splashLogo";u.l.appendChild(u.l.Xe)})();t.addEventListener(KolorEyesPlayer.a.ua,N);t.addEventListener(KolorEyesPlayer.a.Ma,O);t.addEventListener(KolorEyesPlayer.a.ma,K);t.addEventListener(KolorEyesPlayer.a.$a,J);t.addEventListener(KolorEyesPlayer.a.fa,
M);t.addEventListener(KolorEyesPlayer.a.da,L);t.addEventListener(KolorEyesPlayer.a.ab,E);t.addEventListener(KolorEyesPlayer.a.sb,y);t.addEventListener(KolorEyesPlayer.a.tb,x);t.addEventListener(KolorEyesPlayer.a.Tc,v);t.addEventListener(KolorEyesPlayer.a.Yc,p);t.addEventListener(KolorEyesPlayer.a.Xc,w);t.addEventListener(KolorEyesPlayer.a.qb,q);t.addEventListener(KolorEyesPlayer.a.Wc,n);t.addEventListener(KolorEyesPlayer.a.ac,m);t.addEventListener(KolorEyesPlayer.a.$b,a);t.addEventListener(KolorEyesPlayer.a.Zb,
k);t.addEventListener(KolorEyesPlayer.a.Td,g);window.addEventListener("deviceorientation",d,!1)};KolorEyesPlayerUIMobile.prototype=new KolorEyesNamedObject;KolorEyesPlayerUIMobile.prototype.n="PlayerUI";KolorEyesPlayerUIMobile.prototype.debug=!1;KolorEyesRemote=function(c,b,f,e){function d(a){K+=5*a.factorX;O+=5*a.factorY;-90>O?O=-90:90<O&&(O=90);180<K?K-=360:-180>K&&(K+=360);v.ba(K,O)}function g(a){v.A(v.r()+a.factor)}function k(){J==M.length-1?J=0:J++;v.H(M[J])}function a(){for(var a=v.G(),b=0,c=M.length;b<c;b++)M[b]==a&&(J=b);K=v.C();O=v.t()}function m(){L.emit(KolorEyesRemote.a.yh,{rsid:E,psid:y,isPlaying:v.w()})}function n(){v.Kc()}function q(a){E=a.rsid;m();"function"==typeof f&&f()}function w(){if(null===L||!1===L.c)throw"socket is disconnected";
y=L.id;x=e+"/?id="+y;"function"===typeof b&&b()}function p(){if("undefined"===typeof io)throw"IO is not defined";L=io.connect(e);L.on(KolorEyesRemote.a.hh,w);L.on(KolorEyesRemote.a.zh,q);L.on(KolorEyesRemote.a.lh,n);L.on(KolorEyesRemote.a.kh,k);L.on(KolorEyesRemote.a.ih,g);L.on(KolorEyesRemote.a.jh,d);v.addEventListener("onPlay",m);v.addEventListener("onPause",m);v.addEventListener("onProjectionChange",a)}var v=c,x=null,y=null,E=null,L=null,M="spherical planar panini littlePlanet fisheye mirrorBall".split(" "),
J=0,K=0,O=0;this.kill=this.f=function(){v.removeEventListener("onPlay",m);v.removeEventListener("onPause",m);v.removeEventListener("onProjectionChange",a);L.disconnect();v=L=null};this.isConnected=this.e=function(){return null!=L&&!0===L.c};this.getRemoteClientURL=this.c=function(){return x};"undefined"===typeof io?function(){var a=document.createElement("script");a.onload=p;a.type="text/javascript";a.src=e+"/socket.io/socket.io.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,
b)}():p()};KolorEyesRemote.a={hh:"anyConnection",yh:"playbackChanged",zh:"remoteConnection",lh:"doTogglePlayback",kh:"doSwitchProjection",jh:"doJoystick",ih:"doChangeFov"};KolorEyesSkinManager=function(c){function b(b){var c=a.p();"undefined"!==typeof b&&(c=c.querySelector(b));return c}function f(a,b,c,d){var f="";k.wa(b)&&(f+="background-color: "+e(n[b],n[c])+";");k.wa(d)&&(f+="color: "+n[d]+";");if(""!=f)a:if(b=f,null!==m){for(i=0;i<m.length;i++)if(m[i].selectorText.toLowerCase()===a.toLowerCase()){m[i].style.cssText=b;break a}console.warn("Can't override CSS, selector ["+a+"] doesn't exists! ")}}function e(a,b){var c=KolorEyesColor.ji(a);return"rgba("+c.V+", "+c.$+
", "+c.X+", "+(b||1)+")"}function d(a,c,d,e){e=b(e);if(k.wa(a))for(var f in KolorEyesSkinManager.fonts)KolorEyesSkinManager.fonts[f].id===n[a]&&(e.style.fontFamily=KolorEyesSkinManager.fonts[f].value);k.wa(c)&&(e.style.fontSize=n[c]+"px");k.wa(d)&&(e.style.color=n[d])}function g(a,c,d){if(k.wa(a)){var f="#000000",f="msie"===KolorEyes.env.browserName&&9>KolorEyes.env.browserMajor?n[a]:e(n[a],n[c]);b(d).style.backgroundColor=f}}var k=this,a=c,m=null,n={};this.loadSkin=this.vd=function(b){n=b;a:if(document.styleSheets&&
0!=document.getElementsByTagName("head").length){if(0<document.styleSheets.length)for(i=0;i<document.styleSheets.length;i++)if(m=document.styleSheets[i].cssRules||document.styleSheets[i].rules,null!==m&&"#kolorEyesStyleSheet"===m[0].selectorText)break a;throw"KolorEyes.css is missing !";}k.wa("splash")&&(a.p().querySelector("div.kolorEyesPlayerLogo").style.backgroundImage="url("+n.splash+")");if(k.wa("buttons")){b=a.p().querySelectorAll("div.playerBottomUI a");for(var c=0,e=b.length;c<e;c++)b[c].style.backgroundImage=
"url("+n.buttons+")"}g("backgroundColor","backgroundAlpha");g("topColor","topAlpha","div.playerTopUI");g("bottomColor","bottomAlpha","div.playerBottomUI");g("seekTimeColor","seekTimeAlpha","div.seekBarTime");g("seekBufferColor","seekBufferAlpha","div.seekBarBuffer");g("seekContainerColor","seekContainerAlpha","div.seekBarContainer");g("volumeAmountColor","volumeAmountAlpha","div.volumeBar");g("volumeContainerColor","volumeContainerAlpha","div.volumeBarContainer");g("projContainerColor","projContainerAlpha",
"ul.menu");d("projFontFamily","projFontSize","projFontColor","ul.menu");f("div.playerBottomUI ul.menu li:hover","projHoverColor","projHoverAlpha","projFontHoverColor");f("div.playerBottomUI ul.menu li.selected","selectedProjColor","selectedProjAlpha","selectedProjFontColor");f("div.playerBottomUI ul.menu li.selected:hover","selectedProjHoverColor","selectedProjHoverAlpha","selectedProjFontHoverColor");d("titleFont","titleSize","titleColor","div.playerTopUI p")};this.getData=this.c=function(){return n};
this.dataExists=this.wa=function(a){return"undefined"!==typeof n[a]&&null!==n[a]&&""!==n[a]};this.f=function(){k=n=m=a=null}};
KolorEyesSkinManager.fonts={ij:{id:"arial",name:"Arial",value:"Arial,'DejaVu Sans','Liberation Sans',Freesans,sans-serif"},kj:{id:"arialNarrow",name:"Arial Narrow",value:"'Arial Narrow','Nimbus Sans L',sans-serif"},jj:{id:"arialBlack",name:"Arial Black",value:"'Arial Black',Gadget,sans-serif"},lj:{id:"bookman",name:"Bookman",value:"'Bookman Old Style',Bookman,'URW Bookman L','Palatino Linotype',serif"},mj:{id:"centuryGothic",name:"Century Gothic",value:"'Century Gothic',futura,'URW Gothic L',Verdana,sans-serif"},
nj:{id:"comicSansMs",name:"Comic Sans MS",value:"'Comic Sans MS',cursive"},oj:{id:"console",name:"Console",value:"Consolas,'Lucida Console','DejaVu Sans Mono',monospace"},pj:{id:"courier",name:"Courier",value:"'Courier New',Courier,'Nimbus Mono L',monospace"},qj:{id:"georgia",name:"Georgia",value:"Constantia,Georgia,'Nimbus Roman No9 L',serif"},rj:{id:"helvetica",name:"Helvetica",value:"Helvetica,Arial,'DejaVu Sans','Liberation Sans',Freesans,sans-serif"},sj:{id:"imapct",name:"Impact",value:"Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif"},
uj:{id:"lucidaSans",name:"Lucida Sans",value:"'Lucida Sans Unicode','Lucida Grande','Lucida Sans','DejaVu Sans Condensed',sans-serif"},yj:{id:"palatino",name:"Palatino",value:"Cambria,'Palatino Linotype','Book Antiqua','URW Palladio L',serif"},Bj:{id:"tahoma",name:"Thaoma",value:"'Tahoma',sans-serif"},Cj:{id:"timesNewRoman",name:"Times New Roman",value:"Cambria,'Times New Roman','Nimbus Roman No9 L','Freeserif',Times,serif"},Dj:{id:"trebuchet",name:"Trebuchet",value:"'Trebuchet MS',sans-serif"},Ej:{id:"verdana",
name:"Verdana",value:"Verdana, sans-serif"}};KolorEyesBandwidthMonitor=function(){function c(){a.b("Video canplaythrough");e()}function b(){a.b("Video paused");e()}function f(){a.b("Video playing");d()}function e(){a.b("Stop monitoring");window.clearInterval(n);n=null;k()}function d(){x||(a.b("Start monitoring"),n=window.setInterval(g,a.Sd))}function g(){var b;b=m.u();if(0!=b.buffered.length){var c=b.buffered.end(b.buffered.length-1),d=b.duration;b={played:b.currentTime,current:c,total:d,Pj:c/d}}else b=void 0;if(.99<b.percent)x=!0,a.b("Buffering ended"),
e();else{c=b.current;d=(b.current-(q.length?q[q.length-1].seconds:0))*m.qe()/(a.Sd/1E3);q.length==a.sh&&q.shift();q.push({bps:d,seconds:c});d>p&&(p=d);d<w&&(w=d);for(var c=q.length,f=d=0;f<c;f++)d+=q[f].bps;v=d/c;y({video:{buffered:b.current,consumed:b.played,total:b.total},bandwidth:{average:v,min:w,max:p}})}}function k(){if(null!=q)for(;0<q.length;)q.shift();q=[];w=Number.MAX_VALUE;v=p=0}var a=this,m=null,n=null,q=null,w=-1,p=-1,v=-1,x=!1,y=null;this.register=function(e,g){m=e;y=g;x=!1;k();var n=
m.u();a.b("Register bandwidth monitoring for video "+n.firstChild.src);n.addEventListener("play",f,!1);n.addEventListener("pause",b,!1);n.addEventListener("canplaythrough",c,!1);m.w()&&d()};this.Pb=function(){a.b("Unregister bandwidth monitoring for video ");e();var d=m.u();d.removeEventListener("play",f,!1);d.removeEventListener("pause",b,!1);d.removeEventListener("canplaythrough",c,!1);m=null;x=!1};this.f=function(){a.Pb();a=m=null}};KolorEyesBandwidthMonitor.prototype=new KolorEyesNamedObject;
KolorEyesBandwidthMonitor.prototype.n="Bandwidth Monitor";KolorEyesBandwidthMonitor.prototype.debug=!1;KolorEyesBandwidthMonitor.prototype.Sd=500;KolorEyesBandwidthMonitor.prototype.af=4E3;KolorEyesBandwidthMonitor.prototype.sh=KolorEyesBandwidthMonitor.prototype.af/KolorEyesBandwidthMonitor.prototype.Sd;
KolorEyesVideoPerfMonitor=function(){function c(b){g.b("Video timeupdate");a(d(b.target))}function b(a){var b=a.Kj();a=b.Hj;b=b.Wj;return{dropped:a,total:b,ratio:a/b}}function f(a){var b=a.xi-a.Nj;a=a.xi;return{dropped:b,total:a,ratio:b/a}}function e(a){var b=a.webkitDroppedFrameCount;a=a.webkitDecodedFrameCount+b;return{dropped:b,total:a,ratio:b/a}}function d(){return null}var g=this,k=null,a=null;this.register=function(g,n){a=n;k=g;"undefined"!==typeof g.getVideoPlaybackQuality?d=b:"undefined"!==
typeof g.mozParsedFrames?d=f:"undefined"!==typeof g.webkitDecodedFrameCount&&(d=e);g.addEventListener("timeupdate",c,!1)};this.Pb=function(){k.removeEventListener("timeupdate",c,!1);k=a=null};this.f=function(){g.Pb();g=null}};KolorEyesVideoPerfMonitor.prototype=new KolorEyesNamedObject;KolorEyesVideoPerfMonitor.prototype.n="Video Performance Monitor";KolorEyesVideoPerfMonitor.prototype.debug=!1;KolorEyesUtils={og:function(c){return"undefined"!==typeof c}};KolorEyesUtils.isDefined=KolorEyesUtils.og;KolorEyesUtils.ve=function(c){return"object"===typeof c&&"undefined"!==typeof c.nodeName&&"undefined"!==typeof c.tagName};KolorEyesUtils.isDOM=KolorEyesUtils.ve;
KolorEyesUtils.xa=function(c){var b=c.currentTarget||c.srcElement,f=b.currentStyle||window.getComputedStyle(b,null),e=parseInt(f.borderLeftWidth,10);!0===isNaN(e)&&(e=0);f=parseInt(f.borderTopWidth,10);!0===isNaN(f)&&(f=0);b=b.getBoundingClientRect();return{x:c.clientX-e-b.left,y:c.clientY-f-b.top}};KolorEyesUtils.getMouseEventOffset=KolorEyesUtils.xa;
KolorEyesUtils.fd=function(c){if(null==c||"object"!=typeof c)return c;if(c instanceof Date){var b=new Date;b.setTime(c.getTime());return b}if(c instanceof Array){for(var b=[],f=0,e=c.length;f<e;f++)b[f]=KolorEyesUtils.fd(c[f]);return b}if(c instanceof Object){b={};for(f in c)c.hasOwnProperty(f)&&(b[f]=KolorEyesUtils.fd(c[f]));return b}throw Error("Unable to copy pObject! Its type isn't supported.");};
KolorEyesUtils.Oe=function(c,b){c=c.split(".");var f=c.length;b.sort(function(b,d){for(var g=0;g<f;)b=b[c[g]],d=d[c[g]],g++;return b<d?-1:b>d?1:0});return b};KolorEyesUtils.sortArrayByProp=KolorEyesUtils.Oe;KolorEyesUtils.M=function(c){for(c=String(c);2>c.length;)c="0"+c;return c};KolorEyesUtils.Kb=function(c){var b={input:c};if("number"!==typeof c||isNaN(c))return"00:00:00";b.Ca=parseInt(b.input/3600)%24;b.Fb=parseInt(b.input/60)%60;b.Lb=parseInt(b.input%60);return b};
KolorEyesUtils.Eg=function(c,b,f,e,d,g){g=KolorEyesMath.i(g)/f;return{Nc:KolorEyesMath.O(KolorEyesMath.i(e)+(c.x-b/2)*g,-Math.PI,Math.PI),pitch:KolorEyesMath.i(d)+(c.y-f/2)*g}};KolorEyesUtils.screenToWorldSpherical=KolorEyesUtils.Eg;KolorEyesUtils.gh=function(c,b,f,e,d,g,k){k=e/KolorEyesMath.i(k);return new KolorEyesMath.g(f/2+KolorEyesMath.O(c-KolorEyesMath.i(d),-Math.PI,Math.PI)*k,e/2+(b-KolorEyesMath.i(g))*k,0)};KolorEyesUtils.worldToScreenSpherical=KolorEyesUtils.gh;
KolorEyesUtils.Dg=function(c,b,f,e,d,g){g=Math.tan(KolorEyesMath.i(g)/2);c=new KolorEyesMath.g(g*(2*c.x/f-b/f),g*(2*(1-c.y/f)-1),-1);c.Ed(KolorEyesMath.i(e),KolorEyesMath.i(d));e=c.Ic();return{Nc:KolorEyesMath.O(Math.PI-e.Ha,-Math.PI,Math.PI),pitch:-e.Bd}};KolorEyesUtils.screenToWorldRectilinear=KolorEyesUtils.Dg;
KolorEyesUtils.fh=function(c,b,f,e,d,g,k){c=KolorEyesMath.O(Math.PI-c,-Math.PI,Math.PI);c=KolorEyesMath.g.e(1,c,-b);c.Dd(-KolorEyesMath.i(d),-KolorEyesMath.i(g));d=c.Ic();d.Ha=KolorEyesMath.O(Math.PI-d.Ha,-Math.PI,Math.PI);if(d.Ha<=-Math.PI/2||d.Ha>=Math.PI/2)return null;d=new KolorEyesMath.g(Math.tan(d.Ha),Math.tan(d.Bd)/Math.cos(d.Ha),-1);k=Math.tan(KolorEyesMath.i(k/2));return new KolorEyesMath.g(e*(d.x/k+f/e)/2,e-e*(d.y/k+1)/2,0)};KolorEyesUtils.worldToScreenRectilinear=KolorEyesUtils.fh;
KolorEyesUtils.Cg=function(c,b,f,e,d,g){g=Math.tan(KolorEyesMath.i(g)/2);c=new KolorEyesMath.g(g*(2*c.x/f-b/f),g*(2*(1-c.y/f)-1),0);b=KolorEyesMath.g.h(c,c);f=2.5/(b+1.5625);c=new KolorEyesMath.g(f*c.x,f*c.y,(b-1.5625)/(b+1.5625));c.Ed(KolorEyesMath.i(e),KolorEyesMath.i(d));e=c.Ic();return{Nc:KolorEyesMath.O(Math.PI-e.Ha,-Math.PI,Math.PI),pitch:-e.Bd}};KolorEyesUtils.screenToWorldLittlePlanet=KolorEyesUtils.Cg;
KolorEyesUtils.eh=function(c,b,f,e,d,g,k){c=KolorEyesMath.O(Math.PI-c,-Math.PI,Math.PI);c=KolorEyesMath.g.e(1,c,-b);c.Dd(-KolorEyesMath.i(d),-KolorEyesMath.i(g));d=new KolorEyesMath.g(1.25*c.x/(1-c.z),1.25*c.y/(1-c.z),-.25);k=Math.tan(KolorEyesMath.i(k/2));return new KolorEyesMath.g(e*(d.x/k+f/e)/2,e-e*(d.y/k+1)/2,0)};KolorEyesUtils.worldToScreenLittlePlanet=KolorEyesUtils.eh;
KolorEyesUtils.Bg=function(c,b,f,e,d,g){g=KolorEyesMath.i(g);c=new KolorEyesMath.g(2*c.x/f-b/f,2*(1-c.y/f)-1,-1);b=Math.sqrt(c.x*c.x+c.y*c.y);if(b*g>2*Math.PI)return{Nc:NaN,pitch:NaN};g=b*g/2;b=Math.sin(g)/b;g=new KolorEyesMath.g(c.x*b,c.y*b,-Math.cos(g));g.Ed(KolorEyesMath.i(e),KolorEyesMath.i(d));e=g.Ic();return{Nc:KolorEyesMath.O(Math.PI-e.Ha,-Math.PI,Math.PI),pitch:-e.Bd}};KolorEyesUtils.screenToWorldFisheye=KolorEyesUtils.Bg;
KolorEyesUtils.dh=function(c,b,f,e,d,g,k){c=KolorEyesMath.O(Math.PI-c,-Math.PI,Math.PI);c=KolorEyesMath.g.e(1,c,-b);c.Dd(-KolorEyesMath.i(d),-KolorEyesMath.i(g));d=Math.acos(-c.z);k=2*d/KolorEyesMath.i(k);k=new KolorEyesMath.g(c.x*k/Math.sin(d),c.y*k/Math.sin(d),0);return new KolorEyesMath.g(e*(k.x+f/e)/2,e-e*(k.y+1)/2,0)};KolorEyesUtils.worldToScreenFisheye=KolorEyesUtils.dh;KolorEyesVideo={ad:function(c){function b(){if("undefined"==typeof k)return 0;var a=0,b;for(b in k)a++;return 0==a?0:k[g].length}var f=this,e=c,d=[1],g=1;this.ya=function(){return g};this.oe=function(){return d};this.zb=function(a){for(var b=0,c=d.length;b<c&&d[b]<=a;)++b;return d[Math.max(0,b-1)]};this.fj=function(a){g=f.zb(a)};this.Ne=function(a){return f.zb(a)!==g};var k={};this.Wa=function(a){return 0<=a&&a<b()};this.Bh=function(){if(b()){for(var a=0,c=d.length;a<c;a++)for(var e=k[a];0<e.length;)e.shift();
k={}}};this.Xd=function(a){null!==a&&a.length||_clearPresets();for(var b=0,c=a.length;b<c;b++){var e=a[b],g=e.speed||1;-1===d.indexOf(g)&&(d.push(g),d.sort());k[g]||(f.b("Create preset table for rate "+g),k[g]=[]);f.b("Add preset with rate "+g);k[g].push(e)}};this.Ua=function(){for(var a=[],b=k[g],c=0,d=b.length;c<d;c++)a.push({index:c,name:b[c].displayName});return a};this.$h=function(a){return f.Wa(a)?k[g][a].name:""};this.Wf=function(a){return f.Wa(a)?k[g][a].bitrate:0};this.Zh=function(a){return f.Wa(a)?
k[g][a].framerate:0};this.Xf=function(a){return f.Wa(a)?k[g][a].url:null};this.Yh=function(a,b){var c=f.zb(a);return 0===c?null:k[c][b].url};this.Gh=function(){if(1==b())return 0;var a=k[g];a.sort(function(a,b){return a.height>b.height});if("safari"===KolorEyes.env.browserName&&"kr"===e.Vf().hd())return 0;for(var c=e.Vf().p().clientHeight,d=[],f=0,w=b();f<w;f++)a[f].height>=c&&d.push(f);if(0==d.length)return a.length-1;for(var c=a[d[0]].height,p=[],f=0,w=d.length;f<w;f++)a[d[f]].height===c&&p.push(d[f]);
return 720>=c?p[p.length-1]:p[0]};this.ci=function(a){if(1==b())return a;for(var c=k[g],d=c[a].framerate,e=c[a].height,f=a;0<f;f--){var p=c[f];if(p.framerate<d||p.height<e)return f}return a};this.ai=function(a){if(1==b())return a;for(var c=k[g],d=c[a].bitrate,e=a,f=b();e<f;e++)if(c[e].bitrate>d)return e;return a};this.bi=function(a){if(1==b())return a;for(var c=k[g],d=c[a].bitrate,e=a;0<e;e--)if(c[e].bitrate<d)return e;return a};this.f=function(){f=e=null}}};KolorEyesVideo.ad.prototype=new KolorEyesNamedObject;
KolorEyesVideo.ad.prototype.n="Video.PresetManager";KolorEyesVideo.ad.prototype.debug=!1;
KolorEyesVideo.Oc=function(c){var b=this,f=new KolorEyesVideo.ad(b),e=c,d=null,g=null;this.Vf=function(){return e};this.kd=function(){return g.preset};this.Fg=function(b){g.preset=b};this.Wa=function(b){return f.Wa(b)};this.le=function(){return d.mimeType};this.Kf=function(){return 1024*f.Wf(g.preset)};this.Dh=function(b){return 1024*f.Wf(b)};this.pc=function(){return f.Zh(g.preset)};this.Ne=function(b){return f.Ne(b)};this.ya=function(){return f.ya()};this.oe=function(){return f.oe()};this.zb=function(b){return f.zb(b)};
this.od=function(){return g.playbackRate};this.kb=function(b){g.playbackRate=b;f.fj(b)};this.jg=function(b){return f.Xf(b)};this.ig=function(b){return f.Yh(b,g.preset)};this.Ua=function(){return f.Ua()};this.Ni=function(){return f.ci(g.preset)};this.Mi=function(){return f.bi(g.preset)};this.Li=function(){return f.ai(g.preset)};this.load=function(c){f.Bh();d={};g={url:"",playbackRate:1,preset:-1};if("string"===typeof c){var a=c,m=c.indexOf("?")+1;0<m&&(a=c.substring(0,m-1));c=a.substr(a.lastIndexOf(".")+
1);a=[{url:a,name:"",displayName:"",description:"",framerate:25,bitrate:8E3,width:1920,height:1080}];f.Xd(a);d={extension:c,mimeType:"video/"+c,presets:a}}else if("object"===typeof c)if(d=c,"undefined"===typeof d.extension&&(d.extension="mp4"),"undefined"===typeof d.mimeType&&(d.mimeType="video/mp4"),"undefined"!=typeof d.presets&&0<d.presets.length)f.Xd(d.presets);else if("undefined"!=typeof d.source||"undefined"!=typeof d.url)a=[{url:d.source||d.url,name:"",displayName:"",description:"",framerate:25,
bitrate:0,width:0,height:0}],f.Xd(a);a=0;a="undefined"===typeof e.Pa().videoQuality||"auto"===e.Pa().videoQuality?f.Gh():e.Pa().videoQuality;c=f.Xf(a);g.preset=a;g.url=c;b.b("default preset: "+a+", "+f.$h(a));e.dispatchEvent(KolorEyesPlayer.a.Wd);return c};this.f=function(){f.f();b=e=f=null}};KolorEyesVideo.Oc.prototype=new KolorEyesNamedObject;KolorEyesVideo.Oc.prototype.n="Video.ConfigurationManager";KolorEyesVideo.Oc.prototype.debug=!1;
